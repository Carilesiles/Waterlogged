#base robot_standard.pop
#base robot_giant.pop
#base robot_gatebot.pop

WaveSchedule 
{
    //Standard KVs
	StartingCurrency				1300
	CanBotsAttackWhileInSpawnRoom 	No
	RespawnWaveTimeBlue 			1
	FixedRespawnWaveTimeBlue 		1
	AddSentryBusterWhenDamageDealtExceeds 0

	//Reverse KVs
	ReverseWinConditions 1
	AllowJoinTeamBlueMax 6
	AllowJoinTeamBlue 1
	HumansMustJoinTeam Blue
	SetCreditTeam 3
	SniperAllowHeadshots 1
	SendBotsToSpectatorImmediately 1
	//FlagCarrierMovementPenalty 1
	BluHumanFlagCapture 0			 
	BluHumanFlagPickup 0

	//Team/Player KVs
    FastEntityNameLookup 1
    NoReanimators 1
    MaxSpectators 1
    RobotLimit 24
    NoRomevisionCosmetics 1
    BluHumanInfiniteAmmo 0
    BluHumanInfiniteCloak 0
    BluPlayersAreRobots 1
    PlayerRobotsUsePlayerAnimation 1
	BotsRandomCrit 0
    MaxSpeedLimit 3500
	BotHumansHaveEyeGlow 0
	MedigunShieldDamage 1
	RemoveBluVelocityLimit 1

	//Visual/Audio KVs
    TextPrintTime 0
    SniperHideLasers 1
    NoMvMDeathTune 1
    WaveStartCountdown 3
	FixSetCustomModelInput 1
	DisableSound "Announcer.MVM_Bomb_Alert_Near_Hatch"  
    DisableSound "Announcer.MVM_Spy_Alert"                  	 
    PrecacheSound "mvm/mvm_used_powerup.wav"

	ExtraSpawnPoint 
	{
		Name "spawnbot_extra"  
		StartDisabled 1 
		TeamNum 2
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"
	}
	ExtraSpawnPoint 
	{
		Name "summon_chief"   
		TeamNum 3
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"

		StartDisabled 1
	}
	ExtraSpawnPoint 
	{
		Name "summon_chief2"   
		TeamNum 3
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"

		StartDisabled 1
	}
	ExtraSpawnPoint 
	{
		Name "summon_chief3"   
		TeamNum 3
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"

		StartDisabled 1
	}
    ExtraSpawnPoint
    {
        Name "spawnbot_balcony_drain_extra"
        TeamNum 2
        X "-3488"
        Y "-376"
        Z "463"
    }
    ExtraSpawnPoint 
    {
        Name "spawnbot_balcony_extra"
        TeamNum 2
        X "-3736"
        Y "-424"
        Z "463"
    }
    ExtraSpawnPoint //setpos -1164.731567 5462.979980 -379.968689;
	{
		Name "spawnbot_boss"   
		TeamNum 2
		X "-1164"  
		Y "5462"
		Z "-379"
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_arena_1" 
		TeamNum 2
		X "-2808"  
		Y "5895"
		Z "-145"
		StartDisabled 1  
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_arena_2"   
		TeamNum 2
		X "667"  
		Y "4136"
		Z "-145"
		StartDisabled 1  
	}
	
    Templates
    {
        T_TFBot_Giant_Soldier_Extended_Battalion_Fake
		{
            SpawnTemplate Shapeshift_PrespawnDisguise
			Class Spy

            //UseCustomModel "models/bots/soldier_boss/bot_soldier_boss.mdl" 

			Name "Giant Battalion Soldier"
			ClassIcon soldier_backup_giant
			Skill Expert
			Health 15000
			Scale 1.9
			WeaponRestrictions PrimaryOnly
			Attributes HoldFireUntilFullReload
			Attributes MiniBoss
			Attributes SpawnWithFullCharge
			Attributes UseBossHealthBar

            Action FetchFlag

            Item TF_WEAPON_ROCKETLAUNCHER
			Item "The Battalion's Backup"

			CharacterAttributes
			{
                "voice pitch scale" 0
                //"cannot disguise" 1

				"move speed bonus"	0.5
				"damage force reduction" 0.4
				"airblast vulnerability multiplier" 0.4
				"override footstep sound set" 3
				"increase buff duration"	999.0
			}
		}

        T_TFBot_Sergeant_Shapeshift
        {
			SpawnTemplate Yakuza_Title_Card_Shapeshift
			SpawnTemplate Shapeshift_Logic
            SpawnTemplate Shapeshift_Spawn

            //no fucking clues what slot the invis watch is 
            // StripItemSlot 3 
            // StripItemSlot 4
            // StripItemSlot 5
            // StripItemSlot 6

            Class Spy
			Name "Sergeant Shapeshift"
			Skill Expert
			Health 15000

            Action Mobber

			WeaponRestrictions PrimaryOnly

			Attributes MiniBoss
			Attributes UseBossHealthBar
			
			Scale 1.9 

			CharacterAttributes
			{
                "cannot disguise" 1
				"cancel falling damage" 1

				"move speed bonus"	0.5
				"damage force reduction" 0.4
				"airblast vulnerability multiplier" 0.4
			}

			ItemAttributes
			{
				ItemName TF_WEAPON_REVOLVER

				"damage bonus" 1.25
			}

			AddCond 
			{
				Index 4
				Duration 0.4
			}

			EventChangeAttributes
			{
				Default 
				{
					Attributes MiniBoss
				}

				Soldier
				{
					Attributes MiniBoss
					Attributes HoldFireUntilFullReload
					Item "Full Metal Drill Hat"

					Item "Upgradeable TF_WEAPON_ROCKETLAUNCHER"

					ItemAttributes
					{
						ItemName "Upgradeable TF_WEAPON_ROCKETLAUNCHER"
						"clip size upgrade atomic" 10.0
						"Projectile speed decreased" 0.45
						"faster reload rate" 0.4
						"fire rate bonus" 0.3
						"projectile spread angle penalty" 2
					}
				}

				Demo 
				{
					Attributes MiniBoss

					Attributes AlwaysFireWeapon

					Item "Prince Tavish's Crown"

                    Item "The Loose Cannon"
                    Item "The Chargin' Targe"
			        Item "The Eyelander"

                    //ExtAttr AlwaysFireWeaponAlt

                    WeaponSwitch 
                    {
                        Delay 3
                        Cooldown 3
                        Repeats 1
                        Type "Melee" 
				    }

					AddCond
					{
						Index 17 
						Delay 3.2
					}
                    // FireWeapon 
                    // {
                    //     Delay 3.1
                    //     Cooldown 3.1
                    //     Type "Secondary" 
				    // }

                    ItemAttributes
                    {
                        ItemName "The Loose Cannon"
                        "grenade launcher mortar mode" 0
                        "faster reload rate" -1
                        "fire rate bonus" 3
                        "Projectile speed increased" 0.8
                        "projectile spread angle penalty" 5
                        "damage bonus" 1.75
                        "damage causes airblast" 1
                        "blast radius increased" 1.2
                        "use large smoke explosion" 1
                    }

                    ItemAttributes
                    {
                        ItemName "The Eyelander"
						"switch from wep deploy time decreased" 0.01
						"single wep deploy time decreased" 0.01
                        "critboost on kill" 5 //carries over to the next transformation. little bit of trolling
                        //"charge recharge rate increased" 100
                        "Attack not cancel charge" 1
                        "max health additive penalty" 0
                    }
				}

                Heavy 
                {
                    Item "The U-clank-a"
                    Item "Deflector"
                    WeaponRestrictions PrimaryOnly
                    MaxVisionRange 1200
                    Attributes MiniBoss

                    ItemAttributes
                    {
                        ItemName "Deflector"
						"minigun spinup time increased" 2 //removed briefly after spawn, is there to telegraph 
                        "damage bonus"	1.25
                        "attack projectiles" 2
                    }
                }
			}

           AddCond { Name "TF_COND_REPROGRAMMED" } 
        }

        T_TFBot_Sergeant_Shapeshift_Supreme
        {
			SpawnTemplate Yakuza_Title_Card_Shapeshift_Supreme
			SpawnTemplate Shapeshift_Supreme_Logic
			SpawnTemplate Necromancer_Position

            Class Spy
			Name "Sergeant Shapeshift Supreme"
			Skill Expert
			Health 35000

            Action Mobber

			WeaponRestrictions PrimaryOnly

			Attributes MiniBoss
			Attributes UseBossHealthBar
			
			Scale 1.9 
			Tag bot_shapeshift

			CharacterAttributes
			{
                "cannot disguise" 1
				"cancel falling damage" 1

				"move speed bonus"	0.5
				"damage force reduction" 0.4
				"airblast vulnerability multiplier" 0.4
			}

			ItemAttributes
			{
				ItemName TF_WEAPON_REVOLVER

				"damage bonus" 1.5
			}

			AddCond 
			{
				Index 4
				Duration 0.4
			}
			FireInput [$SIGSEGV] 
			{
				Target "midphase_start_relay" //Entity name to use
				Action "Trigger" //Input to fire
				Delay 0 //Delay before firing the input
				Cooldown 1 //Cooldown between firing the input
				Repeats 1 //How many times should the input be fired
				IfHealthBelow 15000
			}
			FireInput [$SIGSEGV] 
			{
				Target "midphase_start_relay" //Entity name to use
				Action "Trigger" //Input to fire
				Delay 0 //Delay before firing the input
				Cooldown 1 //Cooldown between firing the input
				Repeats 1 //How many times should the input be fired
				IfHealthBelow 25000
			}
			EventChangeAttributes
			{
				Default 
				{
					Attributes MiniBoss
				}

				Return
				{
					Attributes MiniBoss
					FireInput [$SIGSEGV] 
					{
						Target "midphase_end_relay" //Entity name to use
						Action "Trigger" //Input to fire
						Delay 0 //Delay before firing the input
						Cooldown 1 //Cooldown between firing the input
						Repeats 0 //How many times should the input be fired
					}
					ChangeAttributes [$SIGSEGV]  
					{
						Delay 1
						Cooldown 1
						Repeats 1
						Name "Default"
					}
				}

                Scout 
                {
                    Attributes MiniBoss

                    Item "Upgradeable TF_WEAPON_BAT"
                    Item "Hero's Tail"
                    Item "The Eye-Catcher"
                    Item "Dead of Night"

                    WeaponRestrictions MeleeOnly

                    ItemColor 
                    {
                        ItemName "Hero's Tail"
                        Red 0
                        Green 0
                        Blue 0
                    }
                }

				Soldier
				{
					Attributes MiniBoss
					Attributes HoldFireUntilFullReload
					Item "Tyrant's Helm"

					Item "Upgradeable TF_WEAPON_ROCKETLAUNCHER"

					ItemAttributes
					{
						ItemName "Upgradeable TF_WEAPON_ROCKETLAUNCHER"
                        //"damage bonus" 1.5
                        "faster reload rate" 0.1
                        "fire rate bonus" 0.3
                        "clip size upgrade atomic" 10.0
                        "Projectile speed increased" 0.9//1.3
					}
				}

				Demo 
				{
					Attributes MiniBoss

					Attributes AlwaysFireWeapon
                    Attributes HoldFireUntilFullReload

					Item "Rimmed Raincatcher"

                    Item "Upgradeable TF_WEAPON_GRENADELAUNCHER"

                    ItemAttributes
                    {
                        ItemName "Upgradeable TF_WEAPON_GRENADELAUNCHER"
                        "fire rate bonus" 0.2
                        "faster reload rate" 0.3
                        "clip size bonus" 6.0
                        "Projectile speed increased" 1.2
                    }
				}

                //burst shotgun
                Heavy 
                {
					Attributes MiniBoss
					Attributes HoldFireUntilFullReload

                    Item "Security Shades" 
					Item "Upgradeable TF_WEAPON_SHOTGUN_PRIMARY"

                    ItemAttributes
                    {
                        ItemName "Upgradeable TF_WEAPON_SHOTGUN_PRIMARY"
                        "fire rate bonus" 0.5
                        "bullets per shot bonus" 10
                        "clip size penalty" 0.5
                        "damage penalty" 0.5
                        "faster reload rate" 0.45
                    }
                }

				//necromancer medic
				Medic 
				{
					Item "Spine-Chilling Skull"
      				//Item "Zombie Medic"
					//Item "Berliner's Bucket Helm"
					//Item "Upgradeable TF_WEAPON_BONESAW"

					Item "The Crusader's Crossbow"

					// ItemModel 
					// {
					// 	ItemName "Berliner's Bucket Helm"
					// 	Model "models/player/items/medic/medic_zombie.mdl"
					// }

					//UseHumanAnimations 1
					
					ItemAttributes
                    {
                        ItemName "The Crusader's Crossbow"
                        "mark for death" 1
                    }

					WeaponRestrictions PrimaryOnly

					// Taunt
					// {
					// 	Delay 0.5
					// 	Repeats 1
					// 	Name "Taunt: Second Rate Sorcery" 
					// }
				}

				//explosive tip
				Sniper 
				{
					WeaponRestrictions PrimaryOnly

					Item "Corona Australis"
      				Item "The Fortified Compound"

					Attributes SuppressFire

					//Attributes AlwaysFireWeapon

					FireWeapon 
					{
						Delay 0.8
						Cooldown 0.8

						Type "Primary" 
					}

					AimAt Body

					ShootTemplate
					{
						Name Explosive_Tip_Bot
						Speed 0
						AttachToProjectile 1 
						Classname "tf_weapon_compound_bow"
					}

					ItemAttributes
                    {
                        ItemName "The Fortified Compound"
                        "faster reload rate" 0.001
						"sniper no headshots" 1
						"damage bonus" 0.75
                    }
				}
			}

           AddCond { Name "TF_COND_REPROGRAMMED" } 
        }
    }
    PointTemplates
    {
		general_logic
		{
			NoFixup 1
			logic_relay
			{
				"targetname" "wave1_init_relay"
				"OnTrigger" "reset_wave_relay,AddOutput,OnTrigger clearbuildings_trigger:Enable::0:-1"
				"OnTrigger" "reset_wave_relay,AddOutput,OnTrigger clearbuildings_trigger:Disable::0.1:-1"
				"OnTrigger" "barrier_gate2_relay_disable,AddOutput,OnTrigger barrier_gate2_right*:Disable::0:-1"
				"OnTrigger" "spawnbot_scaffold,Disable"
                "OnTrigger" "spawnbot_balcony,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Disable"
                "OnTrigger" "spawnbot_balcony_drain,Disable"
                "OnTrigger" "spawnbot_balcony_drain_extra,Disable"
                "OnTrigger" "spawnbot_garage,Disable"
                "OnTrigger" "spawnbot_hatch,Disable"
                "OnTrigger" "barrier_factory_relay_enable,Trigger"
                "OnTrigger" "barrier_gate1_relay_disable,Disable"
                "OnTrigger" "gate1_door_trigger,Disable"
                "OnTrigger" "gate2_door_trigger,Disable"
                "OnTrigger" "capturezone_blue,Disable"

				"OnTrigger" "intel,AddOutput,OnReturn wave1_bombloss_relay:Trigger::0:-1"
				"OnTrigger" "gate1_relay,AddOutput,OnTrigger wave1_gate1_relay:Trigger::0:-1"
				"OnTrigger" "gate2_relay,AddOutput,OnTrigger wave1_gate2_relay:Trigger::0:-1"
                "OnTrigger" "reset_wave_relay,AddOutput,OnTrigger gate1_alarm_door_reset_relay:Enable::0:-1"
                "OnTrigger" "reset_wave_relay,AddOutput,OnTrigger gate2_alarm_door_reset_relay:Enable::0:-1"
			}
			trigger_hurt
			{
				"targetname" "clearbuildings_trigger"
				"origin" "-4878 1552 952"
				"mins" "-7150 -4880 -2376"
				"maxs" "7150 4880 2376"
				"StartDisabled" "1"
				"spawnflags" "64"
				"nodmgforce" "0"
				"filtername" "filter_buildings"
				"damagetype" "0"
				"damagemodel" "0"
				"damagecap" "20"
				"damage" "2000"
			}
            game_round_win
            {
                "targetname" "red_win"
                "TeamNum" "2"
                "switch_teams" "0"
                "force_map_reset" "1"
            }
			filter_activator_class
			{
				"targetname" "filter_dispenser"
				"filterclass" "obj_dispenser"
				"negated" "0"
			}
			filter_activator_class
			{
				"targetname" "filter_sentry"
				"filterclass" "obj_sentrygun"
				"negated" "0"
			}
			filter_activator_class
			{
				"targetname" "filter_tele"
				"filterclass" "obj_teleporter"
				"negated" "0"
			}
			filter_multi
			{
				"targetname" "filter_buildings"
				"filtertype" "1"
				"filter01" "filter_sentry"
				"filter02" "filter_dispenser"
				"filter03" "filter_tele"
			}
			filter_multi
			{
				"targetname" "filter_bot_small_red"
				"filtertype" "0"
				"filter01" "filter_giant_exclude"
				"filter02" "filter_sentrybuster_exclude"
				"filter03" "filter_redteam"
			}
			prop_dynamic
			{
				"disableshadows" "1"
				"model" "models/props_mvm/hatch_shield.mdl"
				"solid" "0"
				"targetname" "hatchshield"
				"startdisabled" "1"
				"origin" "-1132 1686 84"
			}
			func_forcefield
			{
				"targetname" "hatchshield_collision"
				"origin" "-1132 1686 80"
				"mins" "-120 -120 -60"
				"maxs" "120 120 60"
				"TeamNum" "2"
				"startdisabled" "1"
			}
			trigger_add_tf_player_condition
			{
				"targetname" "bot_stun_reprogram"
				"condition" "71"
				"duration" "22"
				"filtername" "filter_bot_small_red"
				"origin" "-4878 1552 952"
				"mins" "-7150 -4880 -2376"
				"maxs" "7150 4880 2376"
				"spawnflags" "3"
				"StartDisabled" "1"
			}
		}
		wave1_logic
        {
            NoFixup 1
			logic_relay
			{
				"targetname" "wave1_loss_relay"
				"OnTrigger" "red_win,RoundWin"
			}
			logic_relay
			{
				"targetname" "wave1_bombloss_relay"
				"OnTrigger" "red_win,RoundWin,,1"
			}
			logic_relay
			{
				"targetname" "wave1_endsequence_relay"
				"OnTrigger" "wave1_bombloss_relay,CancelPending"
				"OnTrigger" "wave1_bombloss_relay,Disable"
				"OnTrigger" "intel,$SetKey$ReturnTime,9999"
				"OnTrigger" "intel,SetReturnTime,9999"
				"OnTrigger" "hatchshield,Enable,,3"
				"OnTrigger" "hatchshield,SetAnimation,enable,3"
				"OnTrigger" "hatchshield_collision,Enable"
				"OnTrigger" "player,$PlaySoundToSelf,player/spy_uncloak_feigndeath.wav,3"
				"OnTrigger" "player,$PlaySoundToSelf,vo/mvm/norm/spy_mvm_laughlong01.mp3,2"
				"OnTrigger" "bots_win,RoundWin,,8"
			}
			training_annotation
			{
				"targetname" "gate1_upgrade_sign"
				"origin" "-6418.695801 2833.543213 516.350342"
				"display_text" "Come one come all! Get your upgrades here!"
				"lifetime"     "22"
			}
			training_annotation
			{
				"targetname" "gate2_upgrade_sign"
				"origin" "-4982.911621 -2107.001953 1184.875854"
				"display_text" "Hey fellas I'm back, come get your upgrades!"
				"lifetime"     "22"
			}
			training_annotation
			{
				"targetname" "gate2_upgrade_sign2"
				"origin" " -4071.288574 -1997.408813 505.022308"
				"display_text" "You can get to the shop through this nifty little vent here."
				"lifetime"     "18"
			}
			logic_auto
			{
				"OnMapSpawn" "spawnbot_scaffold,Disable"
                "OnMapSpawn" "spawnbot_balcony,Disable"
                "OnMapSpawn" "spawnbot_balcony_extra,Disable"
                "OnMapSpawn" "spawnbot_balcony_drain,Disable"
                "OnMapSpawn" "spawnbot_balcony_drain_extra,Disable"
                "OnMapSpawn" "spawnbot_garage,Disable"
                "OnMapSpawn" "spawnbot_hatch,Disable"
                "OnMapSpawn" "barrier_factory_relay_enable,Trigger"
                "OnMapSpawn" "barrier_gate1_relay_disable,Disable"
                "OnMapSpawn" "gate1_door_trigger,Disable"
                "OnMapSpawn" "gate2_door_trigger,Disable"
                "OnMapSpawn" "capturezone_blue,Disable"

				"OnMapSpawn" "gate1_relay,AddOutput,OnTrigger wave1_gate1_relay:Trigger::0:-1"
				"OnMapSpawn" "gate2_relay,AddOutput,OnTrigger wave1_gate2_relay:Trigger::0:-1"
                "OnMapSpawn" "reset_wave_relay,AddOutput,OnTrigger gate1_alarm_door_reset_relay:Enable::0:-1"
                "OnMapSpawn" "reset_wave_relay,AddOutput,OnTrigger gate2_alarm_door_reset_relay:Enable::0:-1"
			}
            logic_relay
            {
                //"OnMapSpawn" "pop_interface,Kill"
                "OnSpawn" "spawnbot_scaffold,Disable"
                "OnSpawn" "spawnbot_balcony,Disable"
                "OnSpawn" "spawnbot_balcony_extra,Disable"
                "OnSpawn" "spawnbot_balcony_drain,Disable"
                "OnSpawn" "spawnbot_balcony_drain_extra,Disable"
                "OnSpawn" "spawnbot_garage,Disable"
                "OnSpawn" "spawnbot_hatch,Disable"
                "OnSpawn" "barrier_factory_relay_enable,Trigger"
                "OnSpawn" "barrier_gate1_relay_disable,Disable"
                "OnSpawn" "gate1_door_trigger,Disable"
                "OnSpawn" "gate2_door_trigger,Disable"
                "OnSpawn" "capturezone_blue,Disable"

                "OnSpawn" "gate1_relay,AddOutput,OnTrigger wave1_gate1_relay:Trigger::0:-1"
				"OnSpawn" "gate2_relay,AddOutput,OnTrigger wave1_gate2_relay:Trigger::0:-1"
                "OnSpawn" "reset_wave_relay,AddOutput,OnTrigger gate1_alarm_door_reset_relay:Enable::0:-1"
                "OnSpawn" "reset_wave_relay,AddOutput,OnTrigger gate2_alarm_door_reset_relay:Enable::0:-1"
            }
			prop_dynamic
			{
				"angles" "0 0 0"
				"disableshadows" "1"
				"model" "models/props_gameplay/cap_circle_256.mdl"
				"skin" "0"
				"solid" "0"
				"targetname" "bombfella_hologram_1"
				"origin" "-7035 1375 136"
			}
			prop_dynamic
			{
				"angles" "0 0 0"
				"disableshadows" "1"
				"model" "models/props_gameplay/cap_circle_256.mdl"
				"skin" "0"
				"solid" "0"
				"targetname" "bombfella_hologram_2"
				"origin" "-4465 -490 136"
			}
			prop_dynamic
			{
				"angles" "0 0 0"
				"disableshadows" "1"
				"model" "models/props_gameplay/cap_circle_256.mdl"
				"skin" "0"
				"solid" "0"
				"targetname" "bombfella_hologram_3"
				"origin" "-1233 549 8"
			}
			logic_relay
			{
				"targetname" "wave1_gate1_relay"
				"OnTrigger" "bot_stun_reprogram,Enable"
				"OnTrigger" "bot_stun_reprogram,Disable,,0.1"
				"OnTrigger" "spawnbot_scaffold,Disable"
                "OnTrigger" "spawnbot_balcony,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Enable,22"
                "OnTrigger" "spawnbot_balcony_drain_extra,Enable,,27"
                "OnTrigger" "gate2_door_trigger,Disable,,24"
                "OnTrigger" "player,$ChangeAttributes,GateOne_Capped,1"
				"OnTrigger" "gate1_alarm_door_reset_relay,Disable"
				"OnTrigger" "gate1_upgrade_sign,Show"
				"OnTrigger" "teleport_spawn_gate1,Enable"
			}
			logic_relay
			{
				"targetname" "wave1_gate2_relay"
				"OnTrigger" "bot_stun_reprogram,Enable"
				"OnTrigger" "bot_stun_reprogram,Disable,,0.1"
				"OnTrigger" "player,$ChangeAttributes,GateTwo_Capped,1"
                "OnTrigger" "spawnbot_balcony_drain,Disable,,21"
                "OnTrigger" "spawnbot_hatch,Enable,,21"
                "OnTrigger" "spawnbot_garage,Enable,,21"
				"OnTrigger" "gate2_alarm_door_reset_relay,Disable"
				"OnTrigger" "gate2_upgrade_sign,Show"
				"OnTrigger" "gate2_upgrade_sign2,Show,,2"
				"OnTrigger" "teleport_gate1,Enable"
				"OnTrigger" "teleport_gate1,Enable,,22"
				"OnTrigger" "teleport_gate1,Enable,,50"
			}
            filter_tf_bot_has_tag
            {
	            "require_all_tags" "1"
	            "tags" "bomb_fella"
	            "targetname" "filter_fella"
            }
            logic_relay
            {
                "targetname" "subwaveone_complete_relay"
                "OnTrigger" "player,$ChangeAttributes,SubwaveOne_Complete"
                "OnTrigger" "barrier_factory_relay_disable,Trigger"
                "OnTrigger" "spawnbot_factory*,Disable"
                "OnTrigger" "spawnbot_scaffold,Enable"
                "OnTrigger" "spawnbot_balcony,Enable"
            }
            logic_relay
            {
                "targetname" "subwavetwo_complete_relay"
                "OnTrigger" "player,$ChangeAttributes,SubwaveTwo_Complete"
                "OnTrigger" "barrier_gate1_relay_disable,Trigger,,3"
                "OnTrigger" "barrier_gate1*,Disable,,3"
                "OnTrigger" "spawnbot_balcony_drain_extra,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Disable"
                "OnTrigger" "spawnbot_balcony_drain,Enable"
            }
            logic_relay
            {
                "targetname" "subwavethree_complete_relay"
                "OnTrigger" "player,$ChangeAttributes,SubwaveThree_Complete"
                //"OnTrigger" "capturezone_blue,Enable"
                "OnTrigger" "spawnbot_hatch,Disable"
                "OnTrigger" "spawnbot_garage,Disable"
            }
            math_counter
            {
                "targetname" "subwaveone_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "subwaveone_complete_relay,Trigger"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "gateone_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "gate1_door_trigger,Enable"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "subwavetwo_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "subwavetwo_complete_relay,Trigger"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "gatetwo_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "gate2_door_trigger,Enable"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "subwavethree_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "subwavethree_complete_relay,Trigger"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            logic_relay
            {
                "targetname" "canteen_relay"
                "OnTrigger" "!activator,SetHealth,15000,0,-1"
                "OnTrigger" "player,$PlaySoundToSelf,=35|mvm/mvm_used_powerup.wav,0,-1"
            }
            trigger_multiple
            {
                "targetname" "trigger_that_does_nothing"
                "origin" "-3175.55 -1999.91 197"
                "mins" "-489 -212 -37"
                "maxs" "489 212 37"
            }
            trigger_teleport
            {
                "mins" "-296 -120 -152"
                "maxs" "296 120 152"
                "origin" "-6744 2504 624"
				"target" "spawnbot"
				"spawnflags" "1"
				"filtername" "filter_blueteam"
            }
        }
        points_gdetonator
        {
            OnParentKilledOutput
            {
                Target "subwaveone_counter"
                Action Add
                Param "20"
            }
        }
        points_gsteelfist
        {
            OnParentKilledOutput
            {
                Target "gateone_counter"
                Action Add
                Param "100"
            }
        }
        points_gsoldier
        {
            OnParentKilledOutput
            {
                Target "subwavetwo_counter"
                Action Add
                Param "50"
            }
        }
        points_gpyro
        {
            OnParentKilledOutput
            {
                Target "gatetwo_counter"
                Action Add
                Param "50"
            }
        }
        points_steelfist
        {
            OnParentKilledOutput
            {
                Target "gatetwo_counter"
                Action Add
                Param "5"
            }
        }
        points_common_one
        {
            OnParentKilledOutput
            {
                Target "subwaveone_counter"
                Action Add
                Param "1"
            }
        }
        points_common_gateone
        {
            OnParentKilledOutput
            {
                Target "gateone_counter"
                Action Add
                Param "1"
            }
        }
        points_common_two
        {
            OnParentKilledOutput
            {
                Target "subwavetwo_counter"
                Action Add
                Param "1"
            }
        }
        points_common_gatetwo
        {
            OnParentKilledOutput
            {
                Target "gatetwo_counter"
                Action Add
                Param "1"
            }
        }
        points_common_three
        {
            OnParentKilledOutput
            {
                Target "subwavethree_counter"
                Action Add
                Param "1"
            }
        }
        wave2_logic
        {
            NoFixup 1
            logic_relay
            {
                "OnSpawn" "blu_init_teleport_boss,Enable"
				"OnSpawn" "bossroom_door,Open"
            }
            logic_relay
            {
                "targetname" "wave_start_boss_relay"
                "OnTrigger" "bossroom_door,Open"
            }
            game_round_win
            {
                "targetname" "red_win"
                "TeamNum" "2"
                "switch_teams" "0"
                "force_map_reset" "1"
            }
            trigger_teleport
            {
                "mins" "-296 -120 -152"
                "maxs" "296 120 152"
                "origin" "-6744 2504 624"
				"target" "spawnbot"
				"spawnflags" "1"
				"filtername" "filter_blueteam"
            }
			prop_dynamic
			{
				"angles" "0 315 0"
				"disableshadows" "1"
				"model" "models/props_mvm/robot_spawnpoint.mdl"
				"skin" "3"
				"solid" "0"
				"targetname" "spawn_hologram_1"
				"origin" "-2808 5895 -192"
			}
			prop_dynamic
			{
				"angles" "0 135 0"
				"disableshadows" "1"
				"model" "models/props_mvm/robot_spawnpoint.mdl"
				"skin" "3"
				"solid" "0"
				"targetname" "spawn_hologram_2"
				"origin" "667.24 4135.62 -191.955"
			}
			logic_relay
			{
				"targetname" "midphase_start_relay"
				"OnTrigger" "necromancer_summon_case*,Disable"
				"OnTrigger" "shapeshift_loop,cancelpending"
				"OnTrigger" "!activator,$AddCond,4,0,-1"
				"OnTrigger" "teleport_shapeshift,Enable"
				"OnTrigger" "spawn_hologram*,AddOutput,skin 0"
				"OnTrigger" "spawn_hologram*,AddOutput,skin 3,2"
				"OnTrigger" "spawnbot_arena*,Enable,,1"
				"OnTrigger" "spawnbot_arena*,Disable,,3"
				"OnTrigger" "player,$PlaySoundToSelf,StopSound,mvm/mvm_tele_activate.wav"
			}
			logic_relay
			{
				"targetname" "midphase_end_relay"
				"OnTrigger" "shapeshift_loop,trigger"
				"OnTrigger" "necromancer_summon_case*,Enable,0.1"
				"OnTrigger" "!activator,$RemoveCond,4,0,-1"
				"Ontrigger" "teleport_shapeshift,Disable"
				"OnTrigger" "teleport_shapeshift_back,Enable"
				"OnTrigger" "teleport_shapeshift_back,Disable,,0.1"
				"OnTrigger" "spawn_hologram*,AddOutput,skin 3"
				"OnTrigger" "player,$PlaySoundToSelf,ambient/machines/teleport1.wav"
			}
			logic_relay
			{
				"targetname" "bip"
				"OnTrigger" "player,$ChangeAttributes,Return" 
				//"OnTrigger" "player,$DisplayTextCenter,return"
			}
			info_target
			{
				"targetname" "tele_destination_shapeshift"
				"origin" "1008 -312 108"
			}
			trigger_teleport
            {
	            "filtername" "filter_shapeshift"
	            "origin" "-352 2736 112"
                "mins" "-2192 -3664 -656"
                "maxs" "2192 3664 656"
	            "spawnflags" "1"
	            "StartDisabled" "1"
				"landmark" "!activator"
	            "target" "tele_destination_shapeshift"
	            "targetname" "teleport_shapeshift"
            }
			trigger_teleport
            {
	            "filtername" "filter_shapeshift"
	            "origin" "-352 2736 112"
                "mins" "-2192 -3664 -656"
                "maxs" "2192 3664 656"
	            "spawnflags" "1"
	            "StartDisabled" "1"
	            "target" "spawnbot_boss"
	            "targetname" "teleport_shapeshift_back"
            }
			filter_tf_bot_has_tag
			{
				"targetname" "filter_shapeshift"
				"tags" "bot_shapeshift"
			}
			ambient_generic
			{
                "targetname" "startmidphasefx"
                "origin" "0 0 0"
                "volstart" "10"
                "spawnflags" "17"
                "radius" "999999"
                "preset" "0"
                "pitchstart" "125"
                "pitch" "125"
                "message" "#mvm/mvm_tele_activate.wav"
                "lfotype" "0"
                "lforate" "0"
                "lfomodvol" "0"
                "lfomodpitch" "0"
                "health" "7.5"
                "fadeoutsecs" "0"
                "fadeinsecs" "0"
                "cspinup" "0"
			}
			ambient_generic
			{
                "targetname" "endmidphasefx"
                "origin" "0 0 0"
                "volstart" "10"
                "spawnflags" "17"
                "radius" "999999"
                "preset" "0"
                "pitchstart" "125"
                "pitch" "125"
                "message" "#ambient/machines/teleport1.wav"
                "lfotype" "0"
                "lforate" "0"
                "lfomodvol" "0"
                "lfomodpitch" "0"
                "health" "7.5"
                "fadeoutsecs" "0"
                "fadeinsecs" "0"
                "cspinup" "0"
			}
        }
        Shapeshift_PrespawnDisguise
        {
            NoFixup 1 
            KeepAlive 1

            OnSpawnOutput
			{
				Target "apply_soldier_disguise_initial"
				Action "Trigger"
				Delay 0
			}

            //placeholder
            //OnSpawnOutput
			//{
			//	Target "disguise_stop"
			//	Action "Trigger"
			//	Delay 8
			//}

            logic_relay
            {
                "targetname" "apply_soldier_disguise_initial"

                "OnTrigger" "!activator,$WeaponStripSlot,0,0,-1" 
                "OnTrigger" "!activator,$GiveItem,Rocket Launcher,0.1,-1" 
				//"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.1,-1" 
                "OnTrigger" "!activator,SetCustomModel,models/bots/soldier_boss/bot_soldier_boss.mdl,0,-1" 

                "OnTrigger" "!self,Kill,,1,-1" 
            }

            logic_relay
            {
                "targetname" "disguise_stop"

                "OnTrigger" "!activator,$AddCond,4,0,-1"
                "OnTrigger" "!activator,$Suicide,,0.7,-1"

                "OnTrigger" "!self,Kill,,2,-1"

				"OnTrigger" "spawnbot_extra,Enable,,0.7,-1"
            }

            info_target
            {
                "targetname" "shapeshift_spawn_target"
                "origin" "0 0 0"
            }
        }

        Shapeshift_Spawn
        {
            OnSpawnOutput
			{
				Target "!activator"
				Action "$TeleportToEntity"
                Param "shapeshift_spawn_target"
				Delay 0
			}

            OnSpawnOutput
			{
				Target "!activator"
				Action "$PlaySound"
                Param "vo\mvm\norm\spy_mvm_specialcompleted07.mp3"
				Delay 0.1
			}

            OnSpawnOutput
			{
				Target "shapeshift_spawn_target"
				Action "Kill"
				Delay 1
			}
        }

        Shapeshift_Logic 
        {
			OnSpawnOutput
			{
				Target "shapeshift_start"
				Action "Trigger"
				Delay 3
			}

            OnParentKilledOutput
			{
				Target "!activator"
				Action "$SetProp$m_bUseBossHealthBar"
                Param "0"
				Delay 0
			}

							
		    logic_relay
            {
				"targetname" "shapeshift_start"
				"spawnflags" "2"

				"OnTrigger" "!activator,$WeaponStripSlot,0,0.51,-1" 
				"OnTrigger" "shapeshift_loop,Trigger,,0,-1"
			}
            logic_relay
            {
                "targetname" "shapeshift_global"
				"spawnflags" "2"

                "OnTrigger" "!activator,$AddCond,4,0,-1"
            }

			logic_relay 
			{
				"targetname" "shapeshift_loop"
				"spawnflags" "2"

                "OnTrigger" "shapeshift_global,Trigger,,0,-1"
				"OnTrigger" "soldier_shapeshift,Trigger,,0.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,5,-1"
				"OnTrigger" "demo_automic_shapeshift,Trigger,,5.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,10,-1"
				"OnTrigger" "heavy_shapeshift,Trigger,,10.5,-1"

				"OnTrigger" "!self,Trigger,,16,-1"
			}

            logic_relay 
            {
                "targetname" "scout_shapeshift"
				"spawnflags" "2"

                "OnTrigger" "shapeshift_global,Trigger,,0,-1"
                "OnTrigger" "!activator,$WeaponStripSlot,0,0,-1" 
				"OnTrigger" "!activator,$GiveItem,TF_WEAPON_SCATTERGUN,0.1,-1" 
				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 
				"OnTrigger" "!activator,SetCustomModel,models/bots/scout/bot_scout.mdl,0.11,-1" 

				"OnTrigger" "!activator,$AddCond,4,0.7,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.75,-1"
            }

			logic_relay 
            {
                "targetname" "soldier_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveItem,The U-clank-a,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Soldier,0,-1"

				"OnTrigger" "!activator,$AddCond,40,0.1,-1"
				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 
				
				"OnTrigger" "!activator,SetCustomModel,models/bots/soldier_boss/bot_soldier_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,soldier_sergeant_crits,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "demo_automic_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveCond,40,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Demo,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Full Metal Drill Hat,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/demo_boss/bot_demo_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,demo_bomber,0.4,-1"
				//"OnTrigger" "!activator,$SetProp$m_bUseBossHealthBar,0,3,-1"
				//"OnTrigger" "!activator,$SetProp$m_bUseBossHealthBar,1,0.45,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "heavy_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Heavy,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Prince Tavish's Crown,0,-1"
				"OnTrigger" "!activator,$RemoveItem,The Chargin' Targe,0,-1"
				"OnTrigger" "!activator,$RemoveItem,The Eyelander,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/heavy_boss/bot_heavy_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,heavy_deflector,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"

				"OnTrigger" "!activator,$RemoveItemAttribute,minigun spinup time increased|0,2,-1" 
            }
        }
        Yakuza_Title_Card_Shapeshift
		{
			OnSpawnOutput
			{
				Target "upper_text"
				Action "Display"
				Delay 0
			}

			OnSpawnOutput
			{
				Target "middle_text"
				Action "Display"
				Delay 0.2
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "upper_text"
				"message" "TWO-SIDED MENACE, EXPERIMENTAL UNIT"
				"x" "-1"
				"y" "0.4"
				"spawnflags" "1"
				"effect" "2"
				"channel" "2"
				"color" "255 255 255"
				"fxtime" "0.2"
				"fadeout" "1"
				//"fadein" "0"
				"holdtime" "5"
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "middle_text"
				"message" "SERGEANT SHAPESHIFT"
				"x" "-1"
				"y" "0.45"
				"channel" "0"
				"spawnflags" "1"
				"color" "255 255 255"
				"fadein" "0.2"
				"fadeout" "1"
				"holdtime" "4.8"
			}
		}

        Yakuza_Title_Card_Shapeshift_Supreme
		{
			OnSpawnOutput
			{
				Target "upper_text"
				Action "Display"
				Delay 0
			}

			OnSpawnOutput
			{
				Target "middle_text"
				Action "Display"
				Delay 0.2
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "upper_text"
				"message" "ROBOT OF MANY TALENTS, EXPERIMENTAL UNIT"
				"x" "-1"
				"y" "0.4"
				"spawnflags" "1"
				"effect" "2"
				"channel" "2"
				"color" "255 255 255"
				"fxtime" "0.2"
				"fadeout" "1"
				//"fadein" "0"
				"holdtime" "5"
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "middle_text"
				"message" "SERGEANT SHAPESHIFT SUPREME"
				"x" "-1"
				"y" "0.45"
				"channel" "0"
				"spawnflags" "1"
				"color" "255 255 255"
				"fadein" "0.2"
				"fadeout" "1"
				"holdtime" "4.8"
			}
		}
		Shapeshift_Supreme_Logic 
        {
			OnSpawnOutput
			{
				Target "shapeshift_start"
				Action "Trigger"
				Delay 3
			}

            OnParentKilledOutput
			{
				Target "!activator"
				Action "$SetProp$m_bUseBossHealthBar"
                Param "0"
				Delay 0
			}
			//OnSpawnOutput
			//{
			//	Target "!activator"
			//	Action "AddOutput"
			//	Param "targetname shapeshift"
			//}
			//OnParentKilledOutput
			//{
			//	Target "!activator"
			//	Action "AddOutput"
			//	Param "targetname "
			//}

			info_particle_system
			{
				"targetname" "spell_effect"
				"effect_name" "spell_cast_wheel_red"
				"flag_as_weather" "0"
				"start_active" "0"

				"OnUser1" "!self,Start,,0,-1"
				"OnUser1" "!self,Stop,,0.5,-1"
			}

			logic_relay 
			{
				"targetname" "necromancer_summon"

				"OnTrigger" "necromancer_summon_case,PickRandomShuffle"

				"OnTrigger" "spell_effect,FireUser1,,0,-1"
			}
			logic_case
			{
                "targetname" "necromancer_summon_case"
                "OnCase01" "summon_chief,Enable,,0,-1"
                "OnCase01" "summon_chief,Disable,,0.1,-1"
                "OnCase02" "summon_chief2,Enable,,0,-1"
                "OnCase02" "summon_chief2,Disable,,0.1,-1"
                "OnCase03" "summon_chief3,Enable,,0,-1"
                "OnCase03" "summon_chief3,Disable,,0.1,-1"
            }			
		    logic_relay
            {
				"targetname" "shapeshift_start"
				"spawnflags" "2"

				"OnTrigger" "!activator,$WeaponStripSlot,0,0.51,-1" 
				"OnTrigger" "shapeshift_loop,Trigger,,0,-1"
			}
            logic_relay
            {
                "targetname" "shapeshift_global"
				"spawnflags" "2"

                "OnTrigger" "!activator,$AddCond,4,0,-1"
            }

			logic_relay 
			{
				"targetname" "shapeshift_loop"
				"spawnflags" "2"

                "OnTrigger" "shapeshift_global,Trigger,,0,-1"
				"OnTrigger" "soldier_shapeshift,Trigger,,0.5,-1"//"soldier_shapeshift,Trigger,,0.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,5,-1"
				"OnTrigger" "demo_automic_shapeshift,Trigger,,5.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,10,-1"
				"OnTrigger" "heavy_shapeshift,Trigger,,10.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,15,-1"
				"OnTrigger" "medic_shapeshift,Trigger,,15.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,20,-1"
				"OnTrigger" "sniper_shapeshift,Trigger,,20.5,-1"

                "OnTrigger" "shapeshift_global,Trigger,,25,-1"
				"OnTrigger" "scout_shapeshift,Trigger,,25.5,-1"

				"OnTrigger" "!self,Trigger,,30,-1"
			}

            logic_relay 
            {
                "targetname" "scout_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveItem,Corona Australis,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Scout,0,-1"
                "OnTrigger" "!activator,$PlaySequence,layer_taunt_the_boston_breakdance,0.2,-1"

				"OnTrigger" "!activator,$AddCond,40,0.1,-1"
				"OnTrigger" "!activator,$WeaponSwitchSlot,2,0.11,-1" 
				
				"OnTrigger" "!activator,SetCustomModel,models/player/scout.mdl,0.11,-1" 
                //"OnTrigger" "!activator,SetCustomModel,models/bots/scout/bot_scout.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,scout_bat,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }
			logic_relay 
            {
                "targetname" "soldier_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveItem,Hero's Tail,0,-1"
                "OnTrigger" "!activator,$RemoveItem,The Eye-Catcher,0,-1"
                "OnTrigger" "!activator,$RemoveItem,Dead of Night,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Soldier,0,-1"

				"OnTrigger" "!activator,$AddCond,40,0.1,-1"
				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 
				
				"OnTrigger" "!activator,SetCustomModel,models/bots/soldier_boss/bot_soldier_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,soldier_sergeant_crits,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "demo_automic_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveCond,40,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Demo,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Tyrant's Helm,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/demo_boss/bot_demo_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,demo_giant,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "heavy_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Heavy,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Rimmed Raincatcher,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/heavy_boss/bot_heavy_boss.mdl,0.1,-1" 
				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,heavy_shotgun_burst_lite,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "medic_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Medic,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Security Shades,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/medic/bot_medic.mdl,0.1,-1" 
				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,medic_boost_giant,0.4,-1"

				//"OnTrigger" "!activator,$PlaySequence,secondrate_socery_medic,1,-1"

				"OnTrigger" "necromancer_summon,Trigger,,2,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "sniper_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Sniper,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Spine-Chilling Skull,0,-1"
				//"OnTrigger" "!activator,$RemoveItem,Zombie Medic,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/sniper/bot_sniper.mdl,0.1,-1" 
				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,sniper_bow_atomic,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }
        }
		Necromancer_Position 
        {
			NoFixup 1

			info_target 
			{
				"targetname" "necromancer_target"

				"Origin" "0 0 0"
			}
		}

		Necromancer_Summoned 
		{
			OnSpawnOutput
			{
				Target "!activator"
				Action "$TeleportToEntity"
				Param "necromancer_target"
				Delay 0
			}
		}
      	Explosive_Tip_Bot
		{
			KeepAlive 1

			OnSpawnOutput 
			{
				Target "tip_explosion"
				Action "$InheritOwner"
				Param "!activator"
				Delay 0.1
			}

			OnSpawnOutput 
			{
				Target "@c@!activator"
				Action "FireUser1"
				Delay 0
			}

			OnSpawnOutput 
			{
				Target "explosive_tip_relay"
				Action "FireUser1"
				Delay 0
			}

			OnSpawnOutput 
			{
				Target "explosive_tip_relay"
				Action "FireUser1"
				Delay 0
			}

			logic_relay
			{
				"targetname" "explosive_tip_relay"

				"OnUser1" "!self,Kill,,5,-1"
			}

			info_target
			{
				"targetname" "detonate_position"

				"OnUser1" "!self,Kill,,5,-1"
			}

			tf_point_weapon_mimic
			{
				"targetname" "tip_explosion"

				"spawnflags" "1"
				"angles" "0 0 0"
				"origin" "-1 0 -3"
				"teamnum" "2"
				"Crits" "0"
				"Damage" "75"
				"ModelScale" "1"
				"SpeedMax" "1000000"
				"SpeedMin" "1000000"
				"SplashRadius" "144"
				"SpreadAngle" "0"
				"WeaponType" "3"

				"OnUser1" "!self,FireOnce,,2,-1"
				"OnUser4" "!self,DetonateStickies,,0,-1"
			}
			
			logic_measure_movement 
			{
				"MeasureReference" "detonate_position"
				"MeasureTarget" "detonate_position"
				"MeasureType" "0"
				"Target" "tip_explosion"
				"TargetReference" "detonate_position"
				"TargetScale" "1"
			}

			info_particle_system
			{
				"targetname" "sticky_flicker"
				"effect_name" "stickybomb_pulse_red"
				"flag_as_weather" "0"
				"start_active" "0"
				
				"OnUser1" "!self,Start,2,1,-1"
				"OnUser1" "!self,Kill,2.7,3,-1"
			}
			logic_measure_movement 
			{
				"MeasureReference" "detonate_position"
				"MeasureTarget" "detonate_position"
				"MeasureType" "0"
				"Target" "sticky_flicker"
				"TargetReference" "detonate_position"
				"TargetScale" "1"
			}

			ambient_generic
			{
				"targetname" "sticky_sound"
				"message" "weapons/stickybomblauncher_det.wav"
				"radius" "4000"
				"health" "5"
				"spawnflags" "48"

				"OnUser1" "!self,PlaySound,,1,-1"
				"OnUser1" "!self,Kill,,3,-1"
			}

			logic_measure_movement 
			{
				"MeasureReference" "detonate_position"
				"MeasureTarget" "detonate_position"
				"MeasureType" "0"
				"Target" "sticky_sound"
				"TargetReference" "detonate_position"
				"TargetScale" "1"
			}

			filter_activator_tfteam 
			{
				"targetname" "filter_is_blu"
				"Negated" "0"
				"TeamNum" "3"

				"OnUser1" "!self,Kill,,2.1,-1"
			}	

			trigger_hurt //for some reason I can't explain using a trigger_once or trigger_multiple just blocks the projectile
			{
				"targetname" "attach_to_enemy"
				"origin" "0 0 0"
				"mins" "-3 -3 -3"
				"maxs" "3 3 3"
				"Damage" "0"
				"spawnflags" "1" 
				"filtername" "filter_is_blu"

				"OnStartTouch" "detonate_position,SetParent,!activator,0,-1"
				//"OnStartTouch" "player,$DisplayTextChat,attached,0.1,-1"
				"OnStartTouch" "!self,Disable,,0.1,-1"

				"OnUser1" "!self,Kill,,2.1,-1"
			}
			

			RemoveIfKilled "explosive_tip_relay"
		}
		PlayerResInput
		{
			NoFixup 1
			OnSpawnOutput
			{
				Target "playerResInWave"
				Action Test
			}
			logic_relay
			{
				"targetname" "wipe_loopfix"
				"onTrigger" "player,$SetVar$hasRes,0,0,-1"
			}
			logic_branch
			{
				"startvalue" "0" // used to detect if wave is started or not
				"targetname" "playerResInWave"
				"onTrue" "player,$SetVar$inWave,1,0,-1"
				"onTrue" "playerResInWaveTest,$SetVar$inWave,1,0,-1"
				"onFalse" "player,$SetVar$inWave,0,0,-1"
				"onFalse" "playerResInWaveTest,$SetVar$inWave,0,0,-1"
			}
			math_counter
			{
				"targetname" "playerResInWaveTest"
			}
			math_counter
			{
				"startvalue" "0" // value to change


				"targetname" "playerResVal1"
				"onGetValue" "player,$SetVar$hasRes,,0,-1"
			}
			math_counter
			{
				"startvalue" "1" // value to change


				"targetname" "playerResVal2"
				"onGetValue" "player,$SetVar$hasRes,,0,-1"
			}
			math_counter
			{
				"startvalue" "4" // value to change


				"targetname" "playerResVal3"
				"onGetValue" "player,$SetVar$hasRes,,0,-1"
			}
			logic_relay
			{
				"targetname" "playerResConfirmForceRespawn"
				"OnTrigger" "!activator,$ForceRespawnDead,,0,-1"
			}
		}
        PlayerRes
		{
			keepalive 1
			OnParentKilledOutput
			{
				Target "playerResConfirm"
				Action InValue
				Param  "$$=''..?(int(!activator.hasRes) > 0, ?(int(playerResInWaveTest.inWave) < 1,string('99'),string('1')),?(int(playerResInWaveTest.inWave) < 1,string('99'),string('0')))"
			}
            logic_case{
                "targetname" "playerResConfirm"
                "case01" "1"
                "case02" "0"
				"case03" "99"
                "OnCase01" "!activator,$ForceRespawnDead,,2,-1"
				"OnCase01" "!activator,$AddCond,52 5,2.1,-1" //respawn uber, change 2nd number for duration
                "OnCase01" "!activator,$SetVar$hasRes,$$=(int(!activator.hasRes) - 1),2,-1"
				// formatting string for if you have lifes
                "OnCase01" "player,$DisplayTextChat,$$=''.. '{f5c542}' .. string(!activator.m_szNetname) .. string('{ffffff} has been revived, they have {f5c542}') .. string(!activator.hasRes) .. string('{ffffff} more lives left.'),2,-1"
				"OnCase01" "revivefx,PlaySound,,2.05,-1"
				"OnCase01" "revivefx,PlaySound,,2.05,-1"
				"OnCase01" "revivefx,kill,,3,-1"
				"OnCase01" "!self,kill,,3,-1"
				// formatting string for if no lifes
				"OnCase02" "player,$DisplayTextChat,$$=''.. '{f5c542}' .. string(!activator.m_szNetname) .. string('{ffffff} has {ff2b2b} no more lives {ffffff}, they will be able to respawn at wave end.'),0,-1"
				"OnCase02" "!self,kill,,3,-1"
				"OnCase02" "revivefx,kill,,3,-1"
				"OnCase03" "playerResConfirmForceRespawn,Trigger,,2,-1"
				"OnCase03" "!self,kill,,0,-1"
				"OnCase03" "revivefx,kill,,0,-1"
            }
			ambient_generic
			{
                "targetname" "revivefx"
                "origin" "0 0 0"
                "volstart" "10"
                "spawnflags" "17"
                "radius" "999999"
                "preset" "0"
                "pitchstart" "125"
                "pitch" "125"
                "message" "#mvm\mvm_revive.wav" //to change respawn sound (plays globally)
                "lfotype" "0"
                "lforate" "0"
                "lfomodvol" "0"
                "lfomodpitch" "0"
                "health" "7.5"
                "fadeoutsecs" "0"
                "fadeinsecs" "0"
                "cspinup" "0"
			}
        }

        CustomCanteensSetup
		{
            OnSpawnOutput
            {
                Target "@c@!activator"
                Action "$SetProp$m_usNumCharges"
                Param 0
                Delay 0
            }

            OnSpawnOutput
            {
                Target "!activator"
                Action "$SetVar$currentCustomCanteenCharges"
                Param 0
                Delay 0
            }

            OnSpawnOutput
            {
                Target "!activator"
                Action "$SetVar$lastUpdatedClass"
                Param "69"
                Delay 0
            }
        }

		CustomCanteens
		{
			OnSpawnOutput
			{
				Target "canteen_input"
				Action "FireUser1"
                Delay 0.1
			}

            OnSpawnOutput
            {
                Target "set_class_changed_value"
                Action "$SetKey$case01"
                Param "$$=!activator.m_iClass"
                Delay 0
            }

            OnSpawnOutput
            {
                Target "set_class_changed_value"
                Action "$Format"
                Delay 0.01
            }

            OnSpawnOutput
            {
                Target "class_changed_check"
                Action "TestActivator"
                Delay 0.02
            }

            logic_case
            {
                //can't target $value with setkey
                "targetname" "set_class_changed_value"
                "case16" "$value %"
                "case01" "def"

                "OnDefault" "class_changed_check,AddOutput,,0,-1"
            }

            $filter_variable
			{
                //check if player changed class since last canteen applied update
                //in which case reset their charges count
                "targetname" "class_changed_check"
				"$name" "lastUpdatedClass"
                
				"$value" "-1" //to be set later

				"$compare" "equal"
				"Negated" "1"

                "OnPass" "player,$SetVar$currentCustomCanteenCharges,0,0,-1"
                "OnPass" "player,$SetProp$m_usNumCharges,0,0,-1"
            }

            logic_branch
            {
                //bool for if player has vanilla canteen
                "targetname" "vanilla_canteens_bool"

                "InitialValue" "0"

                "OnTrue" "!activator,$SetVar$currentCustomCanteenCharges,0,-1"
            }

            logic_compare
            {
                //check if player owns any vanilla canteen incase a vanilla canteen is bought with a custom canteen equipped
                //in which case, remove all current current canteens charges
                "targetname" "vanilla_canteens_check"

                "CompareValue" "1988"

                "OnNotEqualTo" "vanilla_canteens_bool,SetValue,1,0,-1"
            }

            logic_compare
            {
                //check if m_usNumCharges is different from currentCustomCanteenCharges variable
                "targetname" "canteen_input_used_check"

                "CompareValue" "69420" //to be set later

                "OnLessThan" "canteen_owned_check,TestActivator,,0,-1"
            }

            logic_compare
            {
                "targetname" "sanitize_canteen_input"

                "CompareValue" "6900"
                
                //"OnLessThan" "player,$DisplayTextChat,,0,-1"
                "OnLessThan" "canteen_input_used_check,SetCompareValue,$$=!activator.currentCustomCanteenCharges,0,-1"
                "OnLessThan" "canteen_input_used_check,SetValueCompare,,0.01,-1"
            }

            logic_relay 
            {
                "targetname" "canteen_input"

                //since $getprop with @c@ work like an index loop doing the applied output on every child and default to a set value if the prop index doesn't exist 
                //I can hook it to a logic_compare and see if the input is different from the default value
                "OnUser1" "@c@!activator,$GetProp$m_usNumCharges,sanitize_canteen_input|SetValueCompare|6900,0,-1"
                "OnUser1" "vanilla_canteens_bool,SetValue,0,0,-1" //reset for this cycle

                //test for vanilla cans 
                "OnUser1" "!activator,$GetItemAttribute,9|critboost|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|ubercharge|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|refill_ammo|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|recall|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|building instant upgrade|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "vanilla_canteens_bool,Test,,0.01,-1"

                "OnUser1" "!self,FireUser1,,0.2,-1"
            }

            logic_compare
            {
                //check if canteen count is at 0
                "targetname" "canteen_is_empty"

                "CompareValue" "0"

                "OnEqualTo" "on_canteen_empty,Trigger,,0,-1"

                "OnUser1" "!activator,$GetVar$currentCustomCanteenCharges,canteen_is_empty|SetValueCompare|-1,0,-1"
            }

            logic_relay
			{
                //triggered after a successful custom canteen use
				"targetname" "canteen_input_success"
				"spawnflags" "2"

                "OnTrigger" "!activator,$SetVar$currentCustomCanteenCharges,$$=!activator.currentCustomCanteenCharges - 1,0,-1"
                "OnTrigger" "@c@!activator,$SetProp$m_usNumCharges,$$=!activator.currentCustomCanteenCharges - 1,0,-1"
                "OnTrigger" "canteen_is_empty,FireUser1,,0.01,-1"
			}

            $filter_variable
			{
                //check if player has any remaining canteen charges
                "targetname" "canteen_owned_check"
				"$name" "currentCustomCanteenCharges"
				"$value" "0"
				"$compare" "greater than"
				"Negated" "0"

                "OnPass" "canteen_effect,TestActivator,,0,-1"
            }

            $filter_variable
			{
				"targetname" "canteen_effect" //speed boost canteen

                "$value" "1"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}SPEED BOOST {reset}Power Up Canteen!,0,-1"
                "OnPass" "!activator,$AddCond,32,0,-1"
                "OnPass" "!activator,$RemoveCond,32,5,-1"
			}

            filter_activator_tfteam 
			{
				"targetname" "filter_is_red"
				"Negated" "0"
				"TeamNum" "2"
			}

            $filter_sendprop
			{
                "targetname" "filter_is_not_giant"
				"$name" "m_bIsMiniBoss"
				"$value" "0"
				"$compare" "equal"
				"Negated" "0"
            }

            filter_multi 
            {
                "targetname" "filter_can_be_sapped"
                "Negated" "0"
                "FilterType" "0"
                "Filter01" "filter_is_red"
                "Filter02" "filter_is_not_giant"
            }


            trigger_multiple
            {
                "targetname" "reprogram_canteen_apply"
                "origin" "0 0 0"
                "mins" "-300.0 -300.0 -300.0"
                "maxs" "300.0 300.0 300.0"
                "spawnflags" "1" 
                "StartDisabled" "1"
                "filtername" "filter_can_be_sapped"

                "OnStartTouch" "!activator,$AddPlayerAttribute,receive friendly fire|1,0,-1"
                "OnStartTouch" "!activator,$RemoveCond,43,0,-1"
                "OnStartTouch" "!activator,$AddCond,50,0,-1"

                "OnStartTouch" "!activator,$RemovePlayerAttribute,receive friendly fire,8,-1"
                "OnStartTouch" "!activator,$AddCond,43,8,-1"
                "OnStartTouch" "!activator,$RemoveCond,50,8,-1"
                "OnStartTouch" "!activator,$Suicide,50,8,-1" //self-destruct bot after done reprogramming

                "OnUser1" "!self,Enable,,0,-1"
                "OnUser1" "!self,Disable,,0.01,-1"
            }

            info_particle_system
            {
                "targetname" "sapper_effect"
                "effect_name" "Explosion_ShockWave_01"
                "flag_as_weather" "0"
                "start_active" "0"
            }

			$filter_variable
			{
				"targetname" "canteen_effect" //reprogram canteen
				
                "$value" "2"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"


                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}REPROGRAM {reset}Power Up Canteen!,0,-1"
                "OnPass" "sapper_effect,Stop,,0,-1" 
                "OnPass" "sapper_effect,Start,,0.01,-1" 
                "OnPass" "reprogram_canteen_apply,FireUser1,,0,-1" 
			}

            $filter_variable
			{
				"targetname" "canteen_effect" //berserk canteen
				
                "$value" "3"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"


                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}BERSERK {reset}Power Up Canteen!,0,-1"

                //force minigun to stop reving/sniper unscope 
                "OnPass" "!activator,$AddItemAttribute,alt-fire disabled|1|0,0,-1"

                "OnPass" "!activator,$Addcond,41,0,-1"
				"OnPass" "!activator,$Addcond,46,0,-1"
                "OnPass" "!activator,$WeaponSwitchSlot,2,0.01,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: damage bonus|1.25,0,-1"
                //"OnPass" "!activator,$AddItemAttribute,fists have radial buff|1|2,0,-1"
                //"OnPass" "!activator,$AddPlayerAttribute,melee range multiplier|1.1,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,melee attack rate bonus|0.8,0,-1"

                "OnPass" "!activator,$WeaponSwitchSlot,2,1.5,-1" //for revved up miniguns

                "OnPass" "!activator,$RemoveItemAttribute,alt-fire disabled|0,5,-1"

				"OnPass" "!activator,$Removecond,46,5,-1"
            	"OnPass" "!activator,$RemovePlayerAttribute,CARD: damage bonus,5,-1"
                //"OnPass" "!activator,$RemoveItemAttribute,fists have radial buff|2,5,-1"
                //"OnPass" "!activator,$RemovePlayerAttribute,melee range multiplier,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,melee attack rate bonus,5,-1"
                "OnPass" "!activator,$Removecond,41,5,-1"
			}

            $filter_variable
			{
				"targetname" "canteen_effect" //adrenaline canteen
				
                "$value" "4"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"
                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}ADRENALINE {reset}Power Up Canteen!,0,-1"

                "OnPass" "!activator,$Addcond,46,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: damage bonus|1.5,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: move speed bonus|1.2,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: health regen|5,0,-1"
                "OnPass" "!activator,$Addcond,46,0,-1"

                "OnPass" "!activator,$Removecond,46,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,CARD: damage bonus,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,CARD: move speed bonus,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,CARD: health regen,5,-1"

                //fatigue
				"OnPass" "!activator,$Addcond,15,5,-1"
                "OnPass" "!activator,$AddPlayerAttribute,damage penalty|0.7,5,-1"
                "OnPass" "!activator,$AddPlayerAttribute,move speed penalty|0.8,5,-1"

				"OnPass" "!activator,$Removecond,15,10,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,damage penalty,10,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,move speed penalty,10,-1"
			}

            logic_relay 
            {
                //proxy relay to deapply stealth, deapplication is cancelled upon using a new stealth canteen to prevent overlap
                "targetname" "stealth_can_duration"
                "spawnflags" "2"

                "OnTrigger" "!activator,$Removecond,64,14.9,-1"
            }

            $filter_variable
			{
				"targetname" "canteen_effect" //stealth canteen
				
                "$value" "5"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}STEALTH {reset}Power Up Canteen!,0,-1"

                "OnPass" "stealth_can_duration,$CancelPending,,0,-1"
                "OnPass" "!activator,$Addcond,64,0,-1"

                "OnPass" "stealth_can_duration,Trigger,,0.1,-1"
			}

            trigger_multiple
            {
                "targetname" "piss_apply"
                "origin" "0 0 0"
                "mins" "-1000.0 -1000.0 -1000.0"
                "maxs" "1000.0 1000.0 1000.0"
                "spawnflags" "1" 
                "StartDisabled" "1"
                "filtername" "filter_is_red"

                "OnStartTouch" "!activator,$AddCond,24,0,-1"
                "OnStartTouch" "!activator,$RemoveCond,24,15,-1"

                "OnUser1" "!self,Enable,,0,-1"
                "OnUser1" "!self,Disable,,0.01,-1"
            }

            info_particle_system
            {
                "targetname" "piss_effect"
                "effect_name" "eyeboss_death"
                "flag_as_weather" "0"
                "start_active" "0"
            }

	        $filter_variable
			{
				"targetname" "canteen_effect" //piss canteen
				
                "$value" "6"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}PISSPLOSION {reset}Power Up Canteen!,0,-1"

                "OnPass" "piss_effect,Stop,,0,-1" 
                "OnPass" "piss_effect,Start,,0.01,-1" 
                "OnPass" "piss_apply,FireUser1,,0,-1" 
			}

            $filter_variable
			{
				"targetname" "canteen_effect" //knockback immunity canteen
				
                "$value" "69"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}KNOCKBACK IMMUNITY {reset}Power Up Canteen!,0,-1"

                "OnPass" "!activator,$Addcond,20,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,damage force reduction|0.001,0,-1"

				"OnPass" "!activator,$Removecond,20,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,damage force reduction,5,-1"

			}
		}

        CanteenPurchase 
        {
            NoFixup 1

            logic_relay 
            {
                "targetname" "canteen_count_update"
                "spawnflags" "2"

                "$OnUser5" "@c@!activator,$SetProp$m_usNumCharges,,0,-1"
                "$OnUser5" "!activator,$SetVar$currentCustomCanteenCharges,,0,-1"

                "$OnUser5" "!activator,$GetProp$m_iClass,!activator|$SetVar$lastUpdatedClass|69,0,-1"
            }

            logic_relay 
            {
                "targetname" "on_canteen_empty"
                "spawnflags" "2"

                "OnTrigger" "!activator,$RemoveItemAttribute,refill_ammo|9,0,-1"
                "OnTrigger" "!activator,$RemoveItemAttribute,special item description|9,0,-1"
                "OnTrigger" "!activator,$SetVar$canteenIndex,-1,0,-1"
            }
        }
    }

    SpawnTemplate CanteenPurchase

	PlayerSpawnTemplate 
	{
		Name CustomCanteens
		Origin "0 0 0" 
	}

    PlayerSpawnOnceTemplate
	{
		Name CustomCanteensSetup
		Origin "0 0 0"
	}

	//todo: handle wave restore 

	ExtendedUpgrades
	{
		//canteens
		speed_can
		{
			Name "Speed Boost Canteen" 

			//random attribute, preferably one that doesn't do anything nor show up on the player, basically just meant to index
			Attribute "mvm completed challenges bitmask" 
			Cap 5
			Increment 1 
			Cost 25

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}
            
            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain a speed boost for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,1,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain a speed boost for 5 seconds|9,0"
                Output "!activator,$SetVar$canteenIndex,1,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore 
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain a speed boost for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,1,0"
            }
		}

        re_can
		{
			Name "Reprogram Canteen" 

			Attribute "limited quantity item" 
			Cap 10
			Increment 1 
			Cost 100

            Description "Reprogram non-giant enemies in a radius"

			UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Reprogram non-giant enemies in a radius|9,0"

                Output "!activator,$SetVar$canteenIndex,2,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Reprogram non-giant enemies in a radius|9,0"

                Output "!activator,$SetVar$canteenIndex,2,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore 
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Reprogram non-giant enemies in a radius|9,0"

                Output "!activator,$SetVar$canteenIndex,2,0"
            }
		}

        ber_can
		{
			Name "Berserk Canteen" 

			Attribute "throwable healing" 
			Cap 3
			Increment 1 
			Cost 25

            Description "Locked to melee for 5 seconds, greatly increased melee power"

			UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Lock to melee but increase melee power|9,0"

                Output "!activator,$SetVar$canteenIndex,3,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Lock to melee but increase melee power|9,0"

                Output "!activator,$SetVar$canteenIndex,3,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Lock to melee but increase melee power|9,0"

                Output "!activator,$SetVar$canteenIndex,3,0"
            }
		}

        add_can
		{
			Name "Adrenaline Canteen" 

			Attribute "throwable damage" 
			Cap 3
			Increment 1 
			Cost 75

            Description "Gain various buffs for 5 seconds, become weakened for a duration afterward"

			UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain various buffs for 5 seconds and become fatigue briefly after duration|9,0"

                Output "!activator,$SetVar$canteenIndex,4,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain various buffs for 5 seconds and become fatigue briefly after duration|9,0"

                Output "!activator,$SetVar$canteenIndex,4,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain various buffs for 5 seconds and become fatigue briefly after duration|9,0"

                Output "!activator,$SetVar$canteenIndex,4,0"
            }
		}

        cloak_can
		{
			Name "Stealth Canteen" 

			Attribute "throwable particle trail only" 
			Cap 3
			Increment 1 
			Cost 50

            Description "Cloak for up to 15 seconds, cloak is cancelled when attacking"

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade knock_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Cloak for up to 15 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,5,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Cloak for up to 15 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,5,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Cloak for up to 15 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,5,0"
            }
		}

        piss_can
		{
			Name "Pissplosion Canteen" 

			Attribute "decoded by itemdefindex" 
			Cap 3
			Increment 1 
			Cost 25

            Description "Apply Jarate to enemies within a large radius"

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade knock_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Apply Jarate to enemies within a large radius|9,0"

                Output "!activator,$SetVar$canteenIndex,6,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Apply Jarate to enemies within a large radius|9,0"

                Output "!activator,$SetVar$canteenIndex,6,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Apply Jarate to enemies within a large radius|9,0"

                Output "!activator,$SetVar$canteenIndex,6,0"
            }
		}

        knock_can
		{
			Name "Knockback Immunity Canteen" 

			Attribute "elevate quality" 
			Cap 3
			Increment 1 
			Cost 25

            Description "fuck the last subwave"

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Knockback resistance for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,69,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Knockback resistance for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,69,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Knockback resistance for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,69,0"
            }
		}
	}
	SpawnTemplate "general_logic"
	Wave // Wave #1
    {
        SpawnTemplate "wave1_logic"
		InitWaveOutput
		{
			Target wave1_init_relay
			Action Trigger
		}
        StartWaveOutput
        {
            Target wave_start_relay
            Action Trigger
        }
        DoneOutput
        {
            Target wave_finished_relay
            Action Trigger
        }
        WaveSpawn
        {
            Name "Bomb Fella"
            Where spawnbot
            TotalCount 1
            MaxActive 1
            SpawnCount 1
            WaitBeforeStarting 0.1
            WaitBetweenSpawns 0
            DoneOutput
            {
                Target wave1_loss_relay
                Action Trigger
            }
			RandomChoice{RandomChoice{
            TFBot
            {

				Template T_TFBot_Giant_Soldier_Extended_Battalion_Fake
			    Name "Bomb Fella"
                Tag bomb_fella
                EventChangeAttributes
			    {
			    	Default
			    	{
			    		InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-7035 1375 196"
			    			Delay 1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_1" //Entity name to use
				        	Action "Enable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        Message 
                        {
                            Name "{blue}subwave one" 
                            Delay 0
                            Repeats 1
                        }
			    	}
                    SubwaveOne_Complete
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_1" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
			    		InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "gate_pathing_capture"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}subwave one complete" 
                            Delay 0
                            Repeats 1
                        }
			    	}
			    	GateOne_Capped
			    	{
                        InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "gate_pathing_capture"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}Bomb Fella {FFFFFF}has used their {9BBF4D}SELF HEAL {FFFFFF}Power Up Canteen!" 
                            Delay 0
                            Repeats 1
                        }
                        AddCond [$SIGSEGV] //Adds conditions to bots
				        {
				        	Name "TF_COND_MVM_BOT_STUN_RADIOWAVE"
				        	Delay 0.5
				        	Duration 21.5
                        }
                        FireInput [$SIGSEGV] 
				        {
				        	Target "canteen_relay" //Entity name to use
				        	Action "Trigger" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        ChangeAttributes [$SIGSEGV]  //Periodically changes bot attributes, defined in EventChangeAttributes
			            {
			            	Delay 22 //Time before the first bot attribute change (Default: 10)
			            	Cooldown 1 //Time between each bot attribute change (Default: 10)
			            	Repeats 1 //How many times should bot change attributes in total (Default: 0 - Infinite)
			            	Name "SubwaveTwo" // Name of the bot attributes listed in EventChangeAttributes
			            }
                        Message 
                        {
                            Name "{blue}gate one captured" 
                            Delay 0
                            Repeats 1
                        }
			    	}
			    	SubwaveTwo
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_2" //Entity name to use
				        	Action "Enable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-4465 -490 193"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}subwave two" 
                            Delay 0
                            Repeats 1
                        }
			    	}
                    SubwaveTwo_Complete
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_2" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
			    		InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "trigger_that_does_nothing"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}subwave two complete" 
                            Delay 0
                            Repeats 1
                        }
			    	}
                    GateTwo_Capped
                    {
                        Message 
                        {
                            Name "{blue}Bomb Fella {FFFFFF}has used their {9BBF4D}SELF HEAL {FFFFFF}Power Up Canteen!" 
                            Delay 0
                            Repeats 1
                        }
                        AddCond [$SIGSEGV] //Adds conditions to bots
				        {
				        	Name "TF_COND_MVM_BOT_STUN_RADIOWAVE"
				        	Delay 0.5
				        	Duration 21
                        }
                        FireInput [$SIGSEGV] 
				        {
				        	Target "canteen_relay" //Entity name to use
				        	Action "Trigger" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        ChangeAttributes [$SIGSEGV]  //Periodically changes bot attributes, defined in EventChangeAttributes
			            {
			            	Delay 22 //Time before the first bot attribute change (Default: 10)
			            	Cooldown 1 //Time between each bot attribute change (Default: 10)
			            	Repeats 1 //How many times should bot change attributes in total (Default: 0 - Infinite)
			            	Name "SubwaveThree" // Name of the bot attributes listed in EventChangeAttributes
			            }
                        Message 
                        {
                            Name "{blue}gate two captured" 
                            Delay 0
                            Repeats 1
                        }
                    }
                    SubwaveThree
                    {
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_3" //Entity name to use
				        	Action "Enable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-1233 549 68"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message
                        {
                            Name "{blue}subwave three" 
                            Delay 0
                            Repeats 1
                        }
                    }
                    SubwaveThree_Complete
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_3" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        FireInput [$SIGSEGV] 
				        {
				        	Target "wave1_loss_relay" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        Message 
                        {
                            Name "{blue}subwave three complete" 
                            Delay 0
                            Repeats 1
                        }
						InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-1128 1684 164"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 1 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 0 // How long should the ai be interrupted
                            WaitUntilDone 1
							OnDoneChangeAttributes "Shapeshift"
			    		}
			    	}
					Shapeshift
					{
						FireInput [$SIGSEGV] 
				        {
				        	Target "disguise_stop" //Entity name to use
				        	Action "Trigger" //Input to fire
				        	Delay 2 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
					}
			    }
            }
			}}
        }
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_one"
			Where "spawnbot_factory_two"
            TotalCount 32
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 1.5
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Heavyweapons_Shotgun
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
							"voice pitch scale" 0
                        }
                        SpawnTemplate "points_common_one"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_one"
			Where "spawnbot_factory_two"
            TotalCount 36
			MaxActive 6
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Scout_Melee
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_one"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_one"
            TotalCount 2
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 5
			WaitBetweenSpawns 20
            TFBot
            {
                Template T_TFBot_Giant_Pyro_Flare_Spammer
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                SpawnTemplate "points_gdetonator"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_two"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 25
			WaitBetweenSpawns 20
			TFBot
			{
			    Template T_TFBot_Giant_Pyro_Flare_Spammer
			    Action Mobber  
			    BehaviorModifiers Mobber
			    Attributes IgnoreFlag
			    Attributes DisableDodge
			    UseMeleeThreatPrioritization 1  
			    AddCond { Name "TF_COND_REPROGRAMMED" }
			    CharacterAttributes
			    {
			        "damage force reduction" 0.6
			        "airblast vulnerability multiplier" 0.6
			        "crit mod disabled" 0
					"force distribute currency on death" 1
			    }
			    SpawnTemplate "points_gdetonator"
			}
		}
        WaveSpawn 
        {
			Name "w1_gateone"
			Where "spawnbot_scaffold"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 1.5
            TFBot
            {
                Class Heavyweapons
			    Name "Giant Steel Gauntlet"
			    ClassIcon heavy_steelfist
			    Skill Expert
			    Health 5000
			    Item "Fists of Steel"
			    StripItemSlot 0
			    StripItemSlot 1
			    WeaponRestrictions MeleeOnly
			    Attributes MiniBoss
			    Attributes DisableDodge
			    ItemAttributes
			    {
			    	ItemName "Fists of Steel"
			    	"fire rate bonus" 0.6
			    	"damage bonus" 1.2
			    }
			    CharacterAttributes
			    {
			    	"move speed bonus"	0.5
			    	"damage force reduction" 0.3
			    	"airblast vulnerability multiplier" 0.3
			    	"override footstep sound set" 2
					"voice pitch scale" 0
			    }
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
				{
					Target "gate_pathing_capture"
					Delay 1 // Time before the first task starts (Default: 10)
					Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
					Cooldown 5 //Time between each task (Default: 10)
					Duration 300 // How long should the ai be interrupted
                    WaitUntilDone 1
				}
                SpawnTemplate "points_gsteelfist"
            }
		}
        WaveSpawn 
        {
			Name "w1_gateone"
			Where "spawnbot_scaffold"
			Where "spawnbot_balcony"
            TotalCount 24
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 2
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Scout_Scattergun_SlowFire
                        Name "Scout"
                        Action Mobber
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_gateone"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gateone"
			Where "spawnbot_scaffold"
			Where "spawnbot_balcony"
            TotalCount 20
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 2
			WaitBetweenSpawns 2
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Class Soldier
                        Skill Hard
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_gateone"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavetwo"
			Where "spawnbot_balcony_drain_extra"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Template T_TFBot_Giant_Soldier_Spammer
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                SpawnTemplate "points_gsoldier"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavetwo"
			Where "spawnbot_balcony_extra"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Template T_TFBot_Giant_Soldier_Spammer
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                SpawnTemplate "points_gsoldier"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavetwo"
			Where "spawnbot_balcony_drain_extra"
			Where "spawnbot_balcony_extra"
            TotalCount 24
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 2
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Heavyweapons_Heavyweight_Champ_Fast
                        Action Mobber
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
							"voice pitch scale" 0
                        }
                        SpawnTemplate "points_common_two"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gatetwo"
			Where "spawnbot_balcony_drain"
            TotalCount 40
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 10
			WaitBetweenSpawns 2.5
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Class Demoman
                        Skill Expert
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_gatetwo"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gatetwo"
			Where "spawnbot_balcony_drain"
            TotalCount 10
			MaxActive 4
			SpawnCount 1
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 6
			WaitBetweenSpawns 8
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Heavyweapons_Fist
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
							"voice pitch scale" 0
                        }
                        SpawnTemplate "points_steelfist"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gatetwo"
			Where "spawnbot_balcony_drain"
            TotalCount 2
			MaxActive 2
			SpawnCount 2
			TotalCurrency 50
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            TFBot
            {
                Template T_TFBot_Giant_Pyro
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
				{
					Target "trigger_that_does_nothing"
					Delay 1 // Time before the first task starts (Default: 10)
					Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
					Cooldown 5 //Time between each task (Default: 10)
					Duration 300 // How long should the ai be interrupted
                    WaitUntilDone 1
				}
                SpawnTemplate "points_gpyro"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavethree_support"
			Where "spawnbot_hatch"
            Where "spawnbot_garage"
            TotalCount 100
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 4
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Soldier_RocketShotgun
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavethree_support"
			Where "spawnbot_hatch"
            Where "spawnbot_garage"
            TotalCount 100
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 5
			WaitBetweenSpawns 4
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Class Pyro
                        Skill Normal
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        WeaponRestrictions PrimaryOnly
                        UseMeleeThreatPrioritization 1  
                        ItemAttributes
                        {
                            ItemName "TF_WEAPON_FLAMETHROWER"
                            "airblast disabled" 1
                        }
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                    }
                }
            }
		}
        WaveSpawn
        {
			Name "w1_subwavethree"
			Where "spawnbot_hatch"
            TotalCount 2
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            TFBot
			{
				Template T_TFBot_Giant_Demo_Burst
                AddCond { Name "TF_COND_REPROGRAMMED" }
                
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
			}
		}
        WaveSpawn
        {
			Name "w1_subwavethree"
			Where "spawnbot_garage"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            TFBot
			{
				Template T_TFBot_Giant_Demo_Burst
                AddCond { Name "TF_COND_REPROGRAMMED" }
                
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
			}
		}
		WaveSpawn
		{
			WaitForAllDead "w1_subwavethree"
			DoneOutput
			{
				Target subwavethree_complete_relay
				Action Trigger
			}
		}
        WaveSpawn
        {
			Name "w1_endboss"
			Where "spawnbot_extra"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 400
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            DoneOutput
            {
                Target wave1_endsequence_relay
                Action Trigger
            }
            TFBot
			{
				Template T_TFBot_Sergeant_Shapeshift
			}
		}
		WaveSpawn
		{
			Where spawnbot
			TotalCount 1
			WaitBeforeStarting 9999
            RandomChoice
            {
                RandomChoice
                {
			        TFBot { Class Scout ClassIcon hellmet_blank }
                }
            }
		}
    }
	PlayerSpawnTemplate "PlayerRes"
    Wave //Wave #2
    {
    	SpawnTemplate "wave2_logic"
		SpawnTemplate "PlayerResInput"
		PlayerAttributes  
    	{
    	    "min respawn time" 9999
    	}
		InitWaveOutput
		{
			Target blu_init_teleport_boss
			Action Enable
		}
        StartWaveOutput
		{
			Target wave_start_boss_relay
			Action Trigger
		}
		DoneOutput
		{
			Target wave_finished_relay
			Action Trigger
		}
		WaveSpawn
		{
            FirstSpawnOutput
			{
                Target playerResInWave //REQUIRED | Used to tell self res logic that wave is active/ turn it off again at the end of a wave
                Action ToggleTest
            }
        }
        WaveSpawn
		{
            FirstSpawnOutput
			{
                Target playerResVal3 //set res count to one of 3 set
                Action GetValue
            }
        }
        WaveSpawn
		{
            FirstSpawnOutput
			{
                Target boss_resupply
                Action Disable
            }
        }
        WaveSpawn
		{                          
            Name "shapeshift"


			Where spawnbot_boss
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			DoneOutput
			{
				Target "bots_win"
				Action "RoundWin"
			}

            TFBot
            {
                Template T_TFBot_Sergeant_Shapeshift_Supreme
            }
        }
		WaveSpawn
		{                          
			Where summon_chief
			TotalCount 4
			MaxActive 4
			SpawnCount 4
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support 1

			RandomChoice 
			{
				RandomChoice 
				{
					TFBot
					{
						SpawnTemplate "Necromancer_Summoned"
						Template T_TFBot_Scout_Shortstop
						Health 350
                		Action Mobber  
                		BehaviorModifiers Mobber
                		Attributes IgnoreFlag
                		Attributes DisableDodge
						CharacterAttributes
						{
							"cancel falling damage" 1
                    		"crit mod disabled" 0
						}
                		AddCond { Name "TF_COND_REPROGRAMMED" }
					}
				}
			}
        }
		WaveSpawn
		{                          
			Where summon_chief2
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support 1

			RandomChoice 
			{
				RandomChoice 
				{
					TFBot
					{
						SpawnTemplate "Necromancer_Summoned"
						Template T_TFBot_Giant_Pyro_Flare_Spammer
                		Action Mobber  
                		BehaviorModifiers Mobber
                		Attributes IgnoreFlag
                		Attributes DisableDodge
                		AddCond { Name "TF_COND_REPROGRAMMED" }
						CharacterAttributes
						{
							"cancel falling damage" 1
                    		"crit mod disabled" 0
						}
					}
				}
			}
        }
		WaveSpawn
		{                          
			Where summon_chief3
			TotalCount 3
			MaxActive 3
			SpawnCount 3
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support 1

			RandomChoice 
			{
				RandomChoice 
				{
					TFBot
					{
						SpawnTemplate "Necromancer_Summoned"
						Class Spy
						Name "Upgraded Munitions Spy"
						Skill Expert
						Health 650
						Scale 1.35
                		Action Mobber  
                		BehaviorModifiers Mobber
                		Attributes IgnoreFlag
                		Attributes DisableDodge
						AimTrackingInterval 0.05
						ItemAttributes
						{
							ItemName "TF_WEAPON_REVOLVER"
							"hand scale" 1.5
							"override projectile type" 2
							"fire rate penalty" 2
							"faster reload rate" 1.4
							"custom projectile model" "models/weapons/w_models/w_rocketbullet.mdl"
							"projectile trail particle" "rockettrail_airstrike_line"
							"no self blast dmg" 2
							"centerfire projectile" 1
							"projectile no deflect" 1
						}
						CharacterAttributes
						{
							"move speed bonus"	0.85
							"cannot disguise" 1
							"voice pitch scale" 0.8
							"damage force reduction" 0.4
							"airblast vulnerability multiplier"	0.75
                    		"crit mod disabled" 0
						}
                		AddCond { Name "TF_COND_REPROGRAMMED" }
					}
				}
			}
        }
		WaveSpawn 
        {
			Name "midphase1"
			Where "spawnbot_arena_1"
            TotalCount 2
			MaxActive 2
			SpawnCount 2
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Template T_TFBot_Heavyweapons_Fist
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
					"voice pitch scale" 0
                }
            }
		}
		WaveSpawn 
        {
			Name "midphase1"
			Where "spawnbot_arena_2"
            TotalCount 2
			MaxActive 2
			SpawnCount 2
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Template T_TFBot_Heavyweapons_Fist
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
					"voice pitch scale" 0
                }
            }
		}
		WaveSpawn 
        {
			Name "midphase1"
			Where "spawnbot_arena_1"
            TotalCount 5
			MaxActive 5
			SpawnCount 5
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Class Demoman
                Skill Expert
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
            }
		}
		WaveSpawn 
        {
			Name "midphase1"
			Where "spawnbot_arena_2"
            TotalCount 5
			MaxActive 5
			SpawnCount 5
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Class Demoman
                Skill Expert
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
            }
		}
		WaveSpawn
		{
			Name ""
			WaitForAllDead "midphase1"
			DoneOutput
			{
				Target "bip"
				Action Trigger
			}
		}
		WaveSpawn 
        {
			Name "midphase2"
			Where "spawnbot_arena_1"
			WaitForAllDead "midphase1"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
			Support Limited
			TFBot
			{
			    Template T_TFBot_Giant_Soldier_RocketShotgun
			    Action Mobber  
			    BehaviorModifiers Mobber
			    Attributes IgnoreFlag
			    Attributes DisableDodge
			    UseMeleeThreatPrioritization 1  
			    AddCond { Name "TF_COND_REPROGRAMMED" }
			    CharacterAttributes
			    {
			        "crit mod disabled" 0
					"force distribute currency on death" 1
			    }
			}
                
		}
		WaveSpawn 
        {
			Name "midphase2"
			Where "spawnbot_arena_2"
			WaitForAllDead "midphase1"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
			Support Limited
			TFBot
			{
			    Template T_TFBot_Giant_Soldier_RocketShotgun
			    Action Mobber  
			    BehaviorModifiers Mobber
			    Attributes IgnoreFlag
			    Attributes DisableDodge
			    UseMeleeThreatPrioritization 1  
			    AddCond { Name "TF_COND_REPROGRAMMED" }
			    CharacterAttributes
			    {
			        "crit mod disabled" 0
					"force distribute currency on death" 1
			    }
			}
		}
		WaveSpawn
		{
			Name "midphase2"
			Where spawnbot_arena_2
			WaitForAllDead "midphase1"
			TotalCount 4
			MaxActive 4
			SpawnCount 4
			WaitBeforeStarting 5
			WaitBetweenSpawns 0
		
			TotalCurrency 50
			Support Limited
		
			TFBot
            {
                Class Pyro
                Skill Normal
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                WeaponRestrictions PrimaryOnly
                UseMeleeThreatPrioritization 1  
                ItemAttributes
                {
                    ItemName "TF_WEAPON_FLAMETHROWER"
                    "airblast disabled" 1
                }
                AddCond { Name "TF_COND_REPROGRAMMED" }
                
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
            }
		}
		WaveSpawn
		{
			Name "midphase2"
			Where spawnbot_arena_1
			WaitForAllDead "midphase1"
			TotalCount 4
			MaxActive 4
			SpawnCount 4
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
		
			TotalCurrency 50
			Support Limited
		
			TFBot
            {
                Class Pyro
                Skill Normal
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                WeaponRestrictions PrimaryOnly
                UseMeleeThreatPrioritization 1  
                ItemAttributes
                {
                    ItemName "TF_WEAPON_FLAMETHROWER"
                    "airblast disabled" 1
                }
                AddCond { Name "TF_COND_REPROGRAMMED" }
                
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
            }
		}
		WaveSpawn
		{
			Name ""
			WaitForAllDead "midphase2"
			DoneOutput
			{
				Target "bip"
				Action Trigger
			}
		}
		WaveSpawn
		{
			Where spawnbot
			TotalCount 1
			WaitBeforeStarting 9999
            RandomChoice
            {
                RandomChoice
                {
			        TFBot { Class Scout ClassIcon hellmet_blank }
                }
            }
		}
    }
}