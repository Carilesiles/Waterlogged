#base robot_standard.pop
#base robot_giant.pop
#base robot_gatebot.pop

WaveSchedule 
{
    //Standard KVs
	StartingCurrency				1350
	CanBotsAttackWhileInSpawnRoom 	No
	RespawnWaveTimeBlue 			1
	FixedRespawnWaveTimeBlue 		1
	AddSentryBusterWhenDamageDealtExceeds 0

	//Reverse KVs
	ReverseWinConditions 1
	AllowJoinTeamBlueMax 6
	AllowJoinTeamBlue 1
	HumansMustJoinTeam Blue
	SetCreditTeam 3
	SniperAllowHeadshots 1
	SendBotsToSpectatorImmediately 1
	//FlagCarrierMovementPenalty 1
	BluHumanFlagCapture 0
	BluHumanFlagPickup 0
    FixHuntsmanDamageBonus 1
    NoBluHumanFootsteps 1

	//Team/Player KVs
    FastEntityNameLookup 1
    NoReanimators 1
    MaxSpectators 1
    RobotLimit 24
    NoRomevisionCosmetics 1
    BluHumanInfiniteAmmo 0
    BluHumanInfiniteCloak 0
    BluPlayersAreRobots 1
    PlayerRobotsUsePlayerAnimation 1
	BotsRandomCrit 0
    MaxSpeedLimit 3500
	BotHumansHaveEyeGlow 0
	MedigunShieldDamage 1
	RemoveBluVelocityLimit 1
    //NoRedBotsRandomCrit 1
    //NoRedSniperBotHeadshots 1

	//Visual/Audio KVs
    TextPrintTime 0
    SniperHideLasers 1
    NoMvMDeathTune 1
    WaveStartCountdown 3
	FixSetCustomModelInput 1
	DisableSound "heavy_mvm_giant_robot01"                       
    DisableSound "heavy_mvm_giant_robot02"                       
    DisableSound "heavy_mvm_giant_robot03"                       
    DisableSound "heavy_mvm_giant_robot04"                       
    DisableSound "engineer_mvm_giant_robot01"                    
    DisableSound "engineer_mvm_giant_robot02"                    
    DisableSound "engineer_mvm_giant_robot03"                    
    DisableSound "soldier_mvm_giant_robot01"                     
    DisableSound "soldier_mvm_giant_robot02"                     
    DisableSound "soldier_mvm_giant_robot03"                     
    DisableSound "soldier_mvm_giant_robot04"                     
    DisableSound "medic_mvm_giant_robot01"                       
    DisableSound "medic_mvm_giant_robot02"                       
    DisableSound "medic_mvm_giant_robot03"  

	DisableSound "Announcer.MVM_Bomb_Alert_Near_Hatch"  
    DisableSound "Announcer.MVM_Spy_Alert"                  	 
    PrecacheSound "mvm/mvm_used_powerup.wav"
	PrecacheModel "models/props_mvm/mvm_comically_small_player_shield.mdl"

	LuaScript"function vitasawOnHit(_, activat, calle) local teamCheckInstance = ents.FindByName('vitasaw_team_check'); teamCheckInstance:AcceptInput('TestActivator',_,calle,activat); activat:SetName('vitasaw_caller');
    end"

	ExtraTankPath  
	{
		Name "generator_one_path"
    	Node "-5020 135 127" 
    	Node "-4020 135 127"
	}
	ExtraTankPath  
	{
		Name "generator_two_path"
    	Node "-2587 -61 63" //"-5020 135 127"
    	Node "-1000 -61 63"
	}
	ExtraTankPath  
	{
		Name "generator_three_path"
    	Node "-2711 -560 251" //"-2587 -61 63" //"-5020 135 127"
    	Node "-2000 -560 251"
	}
	ExtraTankPath  
	{
		Name "generator_four_path"
    	Node "-1574 987 -1" //"-2611 -560 251" //"-2587 -61 63" //"-5020 135 127"
    	Node "-1000 987 -1"
	}
	ExtraTankPath  
	{
		Name "generator_five_path"
    	Node "-615 1107 -1" //"-1574 987 -1" //"-2611 -560 251" //"-2587 -61 63" //"-5020 135 127"
    	Node "-615 1200 -1"
	}
	ExtraTankPath  
	{
		Name "generator_six_path"
    	Node "-940 1888 95" //"-615 1107 -1" //"-1574 987 -1" //"-2611 -560 251" //"-2587 -61 63" //"-5020 135 127"
    	Node "-762 1789 95"
	}
	ExtraSpawnPoint 
	{
		Name "spawnbot_extra"  
		StartDisabled 1 
		TeamNum 2
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"
	}
	ExtraSpawnPoint 
	{
		Name "summon_chief"   
		TeamNum 3
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"

		StartDisabled 1
	}
	ExtraSpawnPoint 
	{
		Name "summon_chief2"   
		TeamNum 3
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"

		StartDisabled 1
	}
	ExtraSpawnPoint 
	{
		Name "summon_chief3"   
		TeamNum 3
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"

		StartDisabled 1
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_heli"   
		TeamNum 2
		X "-3098.7"  
		Y "-1490.0"
		Z "276.6"
		StartDisabled 1
	}
    ExtraSpawnPoint
    {
        Name "spawnbot_balcony_drain_extra"
        TeamNum 2
        X "-3488"
        Y "-376"
        Z "463"
    }
    ExtraSpawnPoint 
    {
        Name "spawnbot_balcony_extra"
        TeamNum 2
        X "-3736"
        Y "-424"
        Z "463"
    }
    ExtraSpawnPoint //setpos -1164.731567 5462.979980 -379.968689;
	{
		Name "spawnbot_boss"   
		TeamNum 2
		X "-1164"  
		Y "5462"
		Z "-379"
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_arena_1" 
		TeamNum 2
		X "-2808"  
		Y "5895"
		Z "-145"
		StartDisabled 1  
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_arena_2"   
		TeamNum 2
		X "667"  
		Y "4136"
		Z "-145"
		StartDisabled 1  
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_arena_3"   
		TeamNum 2
		X "-2828"  
		Y "4120"
		Z "-132"
		StartDisabled 1  
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_barrier_1"
		TeamNum 2
		X "-2828"
		Y "4119"
		Z "-132"
		//StartDisabled 1
	}
    ExtraSpawnPoint 
	{
		Name "spawnbot_barrier_2"
		TeamNum 2
		X "-2567"
		Y "-203"
		Z "243"
		//StartDisabled 1
	}
	
    Templates
    {
        T_TFBot_Helicopter_Base
		{
			SpawnTemplate Yakuza_Title_Card_HunterChopper

			Name "tomboyfan52"
			Class Scout

			Action Mobber
			Skill Expert
			Attributes SuppressFire

			UseCustomModel "models/empty.mdl" 
			Scale 0.3

			AddCond 
			{
				Index 52 
			}

			CustomWeaponModel
			{
				Slot 0
				Model "models/empty.mdl"
			}

			CustomWeaponModel
			{
				Slot 1
				Model "models/empty.mdl"
			}

			CustomWeaponModel
			{
				Slot 2
				Model "models/empty.mdl"
			}
		
			CharacterAttributes
			{
				"not solid to players" 1
				"voice pitch scale" 0
				"move speed bonus" 0.5
				"no_jump" 1
				"damage force reduction" 0.001
				"airblast pushback scale" 0.0001
				"airblast vertical pushback scale" 0.0001
				"dmg from ranged reduced" 0
				"dmg from melee increased" 0
				"cannot be backstabbed" 1
				"cannot pick up intelligence" 1
                "crit mod disabled" 0
				"force distribute currency on death" 1
			}
		}

		T_TFBot_Helicopter_Shoot
		{
			SpawnTemplate Helicopter_Patterns

			Name "Helicopter"
			Class Soldier

			Action Mobber
			Skill Expert

			Health 1984

			UseCustomModel "models/empty.mdl" 
			Scale 0.01

			AddCond 
			{
				Index 52 
			}

			CustomWeaponModel
			{
				Slot 0
				Model "models/empty.mdl"
			}

			CustomWeaponModel
			{
				Slot 1
				Model "models/empty.mdl"
			}

			CustomWeaponModel
			{
				Slot 2
				Model "models/empty.mdl"
			}

			CharacterAttributes
			{
				"not solid to players" 1
				"move speed bonus" 0.5
				"no_jump" 1
				"dmg from ranged reduced" 0
				"dmg from melee increased" 0
				"cannot be backstabbed" 1
				"cannot pick up intelligence" 1
			}

			EventChangeAttributes
			{
				Default 
				{
					Attributes HoldFireUntilFullReload

					Item TF_WEAPON_ROCKETLAUNCHER

					ItemAttributes
					{
						ItemName TF_WEAPON_ROCKETLAUNCHER
						//"fire full clip at once" 1
                        "is invisible" 1
						"fire rate penalty" 1.3
						"reload time decreased" 0.7
					}
		
								
					ShootTemplate
					{
						Name TridentBurst 
						AttachToProjectile 1
					}
				}

				Pattern2 
				{
					// Item TF_WEAPON_SNIPERRIFLE

					// FireWeapon    
					// {
					// 	Delay 0 
					// 	Cooldown 0.5
					// 	Duration 0.1
					// 	Type "Primary" 
					// }

					// ItemAttributes
					// {
					// 	ItemName TF_WEAPON_SNIPERRIFLE
					// 	"is invisible" 1
					// 	"fire rate bonus" 0.1
					// 	"sniper fires tracer" 1 
					// }

                    Attributes AlwaysFireWeapon
                    
                    Item TF_WEAPON_ROCKETLAUNCHER

                    ItemAttributes
					{
						ItemName TF_WEAPON_ROCKETLAUNCHER
                        "is invisible" 1
						"fire rate bonus" 0.4
                        "Reload time decreased" -1
					}

                    ShootTemplate
					{
						Name RocketMastery
                        AttachToProjectile 1
					}
				}

                Pattern3
				{
                    Attributes AlwaysFireWeapon
                    
                    Item TF_WEAPON_ROCKETLAUNCHER

                    AimOffset "0 0 30"

                    ItemAttributes
					{
						ItemName TF_WEAPON_ROCKETLAUNCHER
                        "is invisible" 1
						"fire rate penalty" 0.5
                        "Projectile speed decreased" 0.3
					}

                    ShootTemplate
					{
						Name RocketSpike
                        AttachToProjectile 1
					}
                }

                Pattern4
				{
                    Attributes AlwaysFireWeapon
                    
                    Item TF_WEAPON_ROCKETLAUNCHER

                    ItemAttributes
					{
						ItemName TF_WEAPON_ROCKETLAUNCHER
                        "is invisible" 1
						"fire rate penalty" 10 //fire once 
                        "Projectile speed decreased" 0.3
                        "always crit" 1
					}

                    ShootTemplate
					{
						Name RocketMasteryConstant 
						AttachToProjectile 1
					}

                }
			}
		}
        T_TFBot_Giant_Soldier_Extended_Battalion_Fake
		{
            SpawnTemplate Shapeshift_PrespawnDisguise
			Class Spy

            //UseCustomModel "models/bots/soldier_boss/bot_soldier_boss.mdl" 

			Name "Giant Battalion Soldier"
			ClassIcon soldier_backup_giant
			Skill Expert
			Health 15000
			Scale 1.9
			WeaponRestrictions PrimaryOnly
			Attributes HoldFireUntilFullReload
			Attributes MiniBoss
			Attributes SpawnWithFullCharge
			Attributes UseBossHealthBar

            Action FetchFlag

            Item TF_WEAPON_ROCKETLAUNCHER
			Item "The Battalion's Backup"

			CharacterAttributes
			{
                "voice pitch scale" 0
                //"cannot disguise" 1

				"move speed bonus"	0.5
				"damage force reduction" 0.1
				"airblast vulnerability multiplier" 0.1
				"override footstep sound set" 3
				"increase buff duration"	999.0
			}
		}

        T_TFBot_Sergeant_Shapeshift
        {
			SpawnTemplate Yakuza_Title_Card_Shapeshift
			SpawnTemplate Shapeshift_Logic
            SpawnTemplate Shapeshift_Spawn

            //no fucking clues what slot the invis watch is 
            // StripItemSlot 3 
            // StripItemSlot 4
            // StripItemSlot 5
            // StripItemSlot 6

            Class Spy
			Name "Sergeant Shapeshift"
			Skill Expert
			Health 15000

            Action Mobber

			WeaponRestrictions PrimaryOnly

			Attributes MiniBoss
			Attributes UseBossHealthBar
			
			Scale 1.9 

			CharacterAttributes
			{
                "cannot disguise" 1
				"cancel falling damage" 1

				"move speed bonus"	0.5
				"damage force reduction" 0.1
				"airblast vulnerability multiplier" 0.1
			}

			ItemAttributes
			{
				ItemName TF_WEAPON_REVOLVER

				"damage bonus" 1.25
			}

			AddCond 
			{
				Index 4
				Duration 0.4
			}

			EventChangeAttributes
			{
				Default 
				{
					Attributes MiniBoss
				}

				Soldier
				{
					Attributes MiniBoss
					Attributes HoldFireUntilFullReload
					Item "Full Metal Drill Hat"

					Item "Upgradeable TF_WEAPON_ROCKETLAUNCHER"

					ItemAttributes
					{
						ItemName "Upgradeable TF_WEAPON_ROCKETLAUNCHER"
						"clip size upgrade atomic" 10.0
						"Projectile speed decreased" 0.45
						"faster reload rate" 0.4
						"fire rate bonus" 0.3
						"projectile spread angle penalty" 2
					}
				}

				Demo 
				{
					Attributes MiniBoss

					Attributes AlwaysFireWeapon

					Item "Prince Tavish's Crown"

                    Item "The Loose Cannon"
                    Item "The Chargin' Targe"
			        Item "The Eyelander"

                    //ExtAttr AlwaysFireWeaponAlt

                    WeaponSwitch 
                    {
                        Delay 3
                        Cooldown 3
                        Repeats 1
                        Type "Melee" 
				    }

					AddCond
					{
						Index 17 
						Delay 3.2
					}
                    // FireWeapon 
                    // {
                    //     Delay 3.1
                    //     Cooldown 3.1
                    //     Type "Secondary" 
				    // }

                    ItemAttributes
                    {
                        ItemName "The Loose Cannon"
                        "grenade launcher mortar mode" 0
                        "faster reload rate" -1
                        "fire rate bonus" 3
                        "Projectile speed increased" 0.8
                        "projectile spread angle penalty" 5
                        "damage bonus" 1.75
                        "damage causes airblast" 1
                        "blast radius increased" 1.2
                        "use large smoke explosion" 1
                    }

                    ItemAttributes
                    {
                        ItemName "The Eyelander"
						"switch from wep deploy time decreased" 0.01
						"single wep deploy time decreased" 0.01
                        "critboost on kill" 5 //carries over to the next transformation. little bit of trolling
                        //"charge recharge rate increased" 100
                        "Attack not cancel charge" 1
                        "max health additive penalty" 0
                    }
				}

                Heavy 
                {
                    Item "The U-clank-a"
                    Item "Deflector"
                    WeaponRestrictions PrimaryOnly
                    MaxVisionRange 1200
                    Attributes MiniBoss

                    ItemAttributes
                    {
                        ItemName "Deflector"
						"minigun spinup time increased" 2 //removed briefly after spawn, is there to telegraph 
                        "damage bonus"	1.25
                        "attack projectiles" 2
                    }
                }
			}

           AddCond { Name "TF_COND_REPROGRAMMED" } 
        }

        T_TFBot_Sergeant_Shapeshift_Supreme
        {
			SpawnTemplate Yakuza_Title_Card_Shapeshift_Supreme
			SpawnTemplate Shapeshift_Supreme_Logic
			SpawnTemplate Necromancer_Position

            Class Spy
			Name "Sergeant Shapeshift Supreme"
			Skill Expert
			Health 36000

            Action Mobber

			WeaponRestrictions PrimaryOnly

			Attributes MiniBoss
			Attributes UseBossHealthBar
			
			Scale 1.9 
			Tag bot_shapeshift

			CharacterAttributes
			{
                "cannot disguise" 1
				"cancel falling damage" 1

				"move speed bonus"	0.5
				"damage force reduction" 0.1
				"airblast vulnerability multiplier" 0.1
			}

			ItemAttributes
			{
				ItemName TF_WEAPON_REVOLVER

				"damage bonus" 1.5
			}

			AddCond 
			{
				Index 4
				Duration 0.4
			}
			FireInput [$SIGSEGV] 
			{
				Target "midphase_start_relay" //Entity name to use
				Action "Trigger" //Input to fire
				Delay 0 //Delay before firing the input
				Cooldown 1 //Cooldown between firing the input
				Repeats 1 //How many times should the input be fired
				IfHealthBelow 12000
			}
			FireInput [$SIGSEGV] 
			{
				Target "midphase_start_relay" //Entity name to use
				Action "Trigger" //Input to fire
				Delay 0 //Delay before firing the input
				Cooldown 1 //Cooldown between firing the input
				Repeats 1 //How many times should the input be fired
				IfHealthBelow 24000
			}
			EventChangeAttributes
			{
				Default 
				{
					Attributes MiniBoss
				}

				Return
				{
					Attributes MiniBoss
					FireInput [$SIGSEGV] 
					{
						Target "midphase_end_relay" //Entity name to use
						Action "Trigger" //Input to fire
						Delay 0 //Delay before firing the input
						Cooldown 1 //Cooldown between firing the input
						Repeats 0 //How many times should the input be fired
					}
					ChangeAttributes [$SIGSEGV]  
					{
						Delay 1
						Cooldown 1
						Repeats 1
						Name "Default"
					}
				}

                Scout 
                {
                    Attributes MiniBoss

                    Item "Upgradeable TF_WEAPON_BAT"
                    Item "Hero's Tail"
                    Item "The Eye-Catcher"
                    Item "Dead of Night"

                    WeaponRestrictions MeleeOnly

                    ItemColor 
                    {
                        ItemName "Hero's Tail"
                        Red 0
                        Green 0
                        Blue 0
                    }
                }

				Soldier
				{
					Attributes MiniBoss
					Attributes HoldFireUntilFullReload
					Item "Tyrant's Helm"

					Item "Upgradeable TF_WEAPON_ROCKETLAUNCHER"

					ItemAttributes
					{
						ItemName "Upgradeable TF_WEAPON_ROCKETLAUNCHER"
                        //"damage bonus" 1.5
                        "faster reload rate" 0.1
                        "fire rate bonus" 0.3
                        "clip size upgrade atomic" 10.0
                        "Projectile speed increased" 0.9//1.3
					}
				}

				Demo 
				{
					Attributes MiniBoss

					Attributes AlwaysFireWeapon
                    Attributes HoldFireUntilFullReload

					Item "Rimmed Raincatcher"

                    Item "Upgradeable TF_WEAPON_GRENADELAUNCHER"

                    ItemAttributes
                    {
                        ItemName "Upgradeable TF_WEAPON_GRENADELAUNCHER"
                        "fire rate bonus" 0.2
                        "faster reload rate" 0.3
                        "clip size bonus" 6.0
                        "Projectile speed increased" 1.2
                    }
				}

                //burst shotgun
                Heavy 
                {
					Attributes MiniBoss
					Attributes HoldFireUntilFullReload

                    Item "Security Shades" 
					Item "Upgradeable TF_WEAPON_SHOTGUN_PRIMARY"

                    ItemAttributes
                    {
                        ItemName "Upgradeable TF_WEAPON_SHOTGUN_PRIMARY"
                        "fire rate bonus" 0.5
                        "bullets per shot bonus" 10
                        "clip size penalty" 0.5
                        "damage penalty" 0.5
                        "faster reload rate" 0.45
                    }
                }

				//necromancer medic
				Medic 
				{
					Item "Spine-Chilling Skull"
      				//Item "Zombie Medic"
					//Item "Berliner's Bucket Helm"
					//Item "Upgradeable TF_WEAPON_BONESAW"

					Item "The Crusader's Crossbow"

					// ItemModel 
					// {
					// 	ItemName "Berliner's Bucket Helm"
					// 	Model "models/player/items/medic/medic_zombie.mdl"
					// }

					//UseHumanAnimations 1
					
					ItemAttributes
                    {
                        ItemName "The Crusader's Crossbow"
                        "mark for death" 1
                    }

					WeaponRestrictions PrimaryOnly

					// Taunt
					// {
					// 	Delay 0.5
					// 	Repeats 1
					// 	Name "Taunt: Second Rate Sorcery" 
					// }
				}

				//explosive tip
				Sniper 
				{
					WeaponRestrictions PrimaryOnly

					Item "Corona Australis"
      				Item "The Fortified Compound"

					Attributes SuppressFire

					//Attributes AlwaysFireWeapon

					FireWeapon 
					{
						Delay 0.8
						Cooldown 0.8

						Type "Primary" 
					}

					AimAt Body

					ShootTemplate
					{
						Name Explosive_Tip_Bot
						Speed 0
						AttachToProjectile 1 
						Classname "tf_weapon_compound_bow"
					}

					ItemAttributes
                    {
                        ItemName "The Fortified Compound"
                        "faster reload rate" 0.001
						"sniper no headshots" 1
						"damage bonus" 0.75
                    }
				}
			}

           AddCond { Name "TF_COND_REPROGRAMMED" } 
        }
    }
	SpawnTemplate "temp_thingy"
    PlayerSpawnTemplate "temp_thingy_player"
    PointTemplates
    {
        temp_thingy_player
        {
            OnSpawnOutput
            {
                Target "!activator"
                Action "$SetVar$inSpawn"
                Param "1"
            }
        }
		temp_thingy
		{
			NoFixup 1
			OnSpawnOutput
			{
				Target collider
				Action $SetCollisionFilter
				Param "filter_inSpawn"
			}
            OnSpawnOutput
            {
                Target bossroom_door_trigger
                Action AddOutput
                Param "OnStartTouch !activator:$SetVar$inSpawn:1:0:-1"
            }
			func_brush
			{
				"targetname" "collider"
				"origin" "-1088 2504 -384"
				"mins" "-92 -8 -64"
				"maxs" "92 8 64"
			}
			filter_activator_class
			{
				"targetname" "filter_player"
				"filterclass" "player"
				"negated" "1"
			}
            $filter_variable
            {
                "targetname" "filter_inSpawn"
                "$name" "inSpawn"
                "$value" "1"
                "negated" "1"
            }
            filter_multi
            {
                "targetname" "filter_playerInSpawn"
                "filtertype" "0"
				"filter01" "filter_player"
				"filter02" "filter_inSpawn"
            }
            trigger_multiple
            {
                "mins" "-136 -32 -64"
                "maxs" "136 32 64"
                "origin" "-1088 2688 -384"
                "spawnflags" "1"
                "filtername" "filter_blueteam"
                "OnStartTouch" "!activator,$SetVar$inSpawn,0"
            }
            trigger_multiple
            {
                "mins" "-32 -96 -64"
                "maxs" "32 96 64"
                "origin" "-1256 2624 -384"
                "spawnflags" "1"
                "filtername" "filter_blueteam"
                "OnStartTouch" "!activator,$SetVar$inSpawn,0"
            }
            trigger_multiple
            {
                "mins" "-32 -96 -64"
                "maxs" "32 96 64"
                "origin" "-920 2624 -384"
                "spawnflags" "1"
                "filtername" "filter_blueteam"
                "OnStartTouch" "!activator,$SetVar$inSpawn,0"
            }

			//logic_auto
			//{
			//	"OnMapSpawn" "bossroom_blocker,BlockNav"
			//}
			//func_nav_blocker
			//{
			//	"targetname" "bossroom_blocker"
			//	"teamToBlock" "-1"
			//	"affectsFlow" "1"
			//	"mins" "-127.5 -336 -96"
			//	"maxs" "127.5 336 96"
			//	"origin" "-1088 3088 -352"
			//}
			//func_nav_blocker
			//{
			//	"targetname" "bossroom_blocker"
			//	"teamToBlock" "-1"
			//	"affectsFlow" "1"
			//	"mins" "-944 -144 -96"
			//	"maxs" "944 144 96"
			//	"origin" "-1056 2672 -352"
			//}
			//func_nav_blocker
			//{
			//	"targetname" "bossroom_blocker"
			//	"teamToBlock" "-1"
			//	"affectsFlow" "1"
			//	"mins" "-92 -48 -64"
			//	"maxs" "92 48 64"
			//	"origin" "-1088 2500 -384"
			//}
		}
		general_logic
		{
			NoFixup 1
			logic_relay
			{
				"targetname" "wave1_init_relay"
				"OnTrigger" "reset_wave_relay,AddOutput,OnTrigger clearbuildings_trigger:Enable::0:-1"
				"OnTrigger" "reset_wave_relay,AddOutput,OnTrigger clearbuildings_trigger:Disable::0.1:-1"
				"OnTrigger" "intel,SetReturnTime,120"
				"OnTrigger" "barrier_gate2_relay_disable,AddOutput,OnTrigger barrier_gate2_right*:Disable::0:-1"
				"OnTrigger" "spawnbot_scaffold,Disable"
                "OnTrigger" "spawnbot_balcony,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Disable"
                "OnTrigger" "spawnbot_balcony_drain,Disable"
                "OnTrigger" "spawnbot_balcony_drain_extra,Disable"
                "OnTrigger" "spawnbot_garage,Disable"
                "OnTrigger" "spawnbot_hatch,Disable"
                "OnTrigger" "barrier_factory_relay_enable,Trigger"
                "OnTrigger" "barrier_gate1_relay_enable,Trigger"
                "OnTrigger" "barrier_gate2_relay_enable,Trigger"
                "OnTrigger" "barrier_gate1_relay_disable,Disable"
                "OnTrigger" "gate1_door_trigger,Disable"
                "OnTrigger" "gate2_door_trigger,Disable"
                "OnTrigger" "capturezone_blue,Disable"

				"OnTrigger" "intel,AddOutput,OnReturn wave1_bombloss_relay:Trigger::0:-1"
				"OnTrigger" "gate1_relay,AddOutput,OnTrigger wave1_gate1_relay:Trigger::0:-1"
				"OnTrigger" "gate2_relay,AddOutput,OnTrigger wave1_gate2_relay:Trigger::0:-1"
                "OnTrigger" "reset_wave_relay,AddOutput,OnTrigger gate1_alarm_door_reset_relay:Enable::0:-1"
                "OnTrigger" "reset_wave_relay,AddOutput,OnTrigger gate2_alarm_door_reset_relay:Enable::0:-1"
			}
			logic_relay
			{
				"targetname" "wave2_init_relay"
                "OnTrigger" "clearbuildings_trigger,Enable"
                "OnTrigger" "clearbuildings_trigger,Disable,,0.1"
                "OnTrigger" "blu_init_teleport_boss,Enable"
				"OnTrigger" "bossroom_door_trigger,Disable"
			}
			logic_relay
			{
				"targetname" "wave3_init_relay"
                "OnTrigger" "clearbuildings_trigger,Enable"
                "OnTrigger" "clearbuildings_trigger,Disable,,0.1"
                "OnTrigger" "blu_init_teleport_boss,Disable"
                "OnTrigger" "blu_init_teleport,Enable"
                "OnTrigger" "blu_init_teleport,Disable,,0.1"
				"OnTrigger" "barrier_gate2_relay_disable,AddOutput,OnTrigger barrier_gate2_right*:Disable::0:-1"
				"OnTrigger" "spawnbot_scaffold,Disable"
                "OnTrigger" "spawnbot_balcony,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Disable"
                "OnTrigger" "spawnbot_balcony_drain,Disable"
                "OnTrigger" "spawnbot_balcony_drain_extra,Disable"
                "OnTrigger" "spawnbot_garage,Disable"
                "OnTrigger" "spawnbot_hatch,Disable"
                //"OnTrigger" "barrier_factory_relay_enable,Trigger"
                "OnTrigger" "barrier_gate1_relay_enable,Trigger"
                "OnTrigger" "barrier_gate2_relay_enable,Trigger"
                "OnTrigger" "barrier_building_1,Enable"
                "OnTrigger" "barrier_building_2,Enable"
                //"OnTrigger" "barrier_hatch_relay_enable,Trigger"
                "OnTrigger" "barrier_gate1_relay_disable,Enable"
                "OnTrigger" "gate1_door_trigger,Disable"
                "OnTrigger" "gate2_door_trigger,Disable"
                "OnTrigger" "capturezone_blue,Disable"
				"OnTrigger" "hatchshield,Enable"
				"OnTrigger" "hatchshield_collision,Enable"

				//"OnTrigger" "gate1_relay,AddOutput,OnTrigger wave1_gate1_relay:Trigger::0:-1"
				//"OnTrigger" "gate2_relay,AddOutput,OnTrigger wave1_gate2_relay:Trigger::0:-1"
                "OnTrigger" "reset_wave_relay,AddOutput,OnTrigger gate1_alarm_door_reset_relay:Enable::0:-1"
                "OnTrigger" "reset_wave_relay,AddOutput,OnTrigger gate2_alarm_door_reset_relay:Enable::0:-1"
			}
			trigger_hurt
			{
				"targetname" "clearbuildings_trigger"
				"origin" "-4878 1552 952"
				"mins" "-7150 -4880 -2376"
				"maxs" "7150 4880 2376"
				"StartDisabled" "1"
				"spawnflags" "64"
				"nodmgforce" "0"
				"filtername" "filter_buildings"
				"damagetype" "0"
				"damagemodel" "0"
				"damagecap" "20"
				"damage" "2000"
			}
            game_round_win
            {
                "targetname" "red_win"
                "TeamNum" "2"
                "switch_teams" "0"
                "force_map_reset" "1"
            }
			filter_activator_class
			{
				"targetname" "filter_dispenser"
				"filterclass" "obj_dispenser"
				"negated" "0"
			}
			filter_activator_class
			{
				"targetname" "filter_sentry"
				"filterclass" "obj_sentrygun"
				"negated" "0"
			}
			filter_activator_class
			{
				"targetname" "filter_tele"
				"filterclass" "obj_teleporter"
				"negated" "0"
			}
			filter_multi
			{
				"targetname" "filter_buildings"
				"filtertype" "1"
				"filter01" "filter_sentry"
				"filter02" "filter_dispenser"
				"filter03" "filter_tele"
			}
			filter_multi
			{
				"targetname" "filter_bot_small_red"
				"filtertype" "0"
				"filter01" "filter_giant_exclude"
				"filter02" "filter_sentrybuster_exclude"
				"filter03" "filter_redteam"
			}
			prop_dynamic
			{
				"disableshadows" "1"
				"model" "models/props_mvm/hatch_shield.mdl"
				"solid" "0"
				"targetname" "hatchshield"
				"startdisabled" "1"
				"origin" "-1132 1686 84"
			}
			func_forcefield
			{
				"targetname" "hatchshield_collision"
				"origin" "-1132 1686 150"
				"mins" "-120 -120 -60"
				"maxs" "120 120 60"
				"TeamNum" "2"
				"startdisabled" "1"
			}
			trigger_add_tf_player_condition
			{
				"targetname" "bot_stun_reprogram"
				"condition" "71"
				"duration" "22"
				"filtername" "filter_bot_small_red"
				"origin" "-4878 1552 952"
				"mins" "-7150 -4880 -2376"
				"maxs" "7150 4880 2376"
				"spawnflags" "3"
				"StartDisabled" "1"
			}
		}
		wave1_logic
        {
            NoFixup 1
			logic_relay
			{
				"targetname" "wave1_loss_relay"
				"OnTrigger" "red_win,RoundWin"
			}
			logic_relay
			{
				"targetname" "wave1_bombloss_relay"
				"OnTrigger" "red_win,RoundWin,,1"
			}
			logic_relay
			{
				"targetname" "wave1_endsequence_relay"
				"OnTrigger" "wave1_bombloss_relay,CancelPending"
				"OnTrigger" "wave1_bombloss_relay,Disable"
				"OnTrigger" "intel,$SetKey$ReturnTime,9999"
				"OnTrigger" "intel,SetReturnTime,9999"
				"OnTrigger" "hatchshield,Enable,,3"
				"OnTrigger" "hatchshield,SetAnimation,enable,3"
				"OnTrigger" "hatchshield_collision,Enable"
				"OnTrigger" "player,$PlaySoundToSelf,player/spy_uncloak_feigndeath.wav,3"
				"OnTrigger" "player,$PlaySoundToSelf,vo/mvm/norm/spy_mvm_laughlong01.mp3,2"
				"OnTrigger" "bots_win,RoundWin,,5"
			}
			training_annotation
			{
				"targetname" "gate1_upgrade_sign"
				"origin" "-6418.695801 2833.543213 516.350342"
				"display_text" "Come one come all! Get your upgrades here!"
				"lifetime"     "22"
			}
			training_annotation
			{
				"targetname" "gate2_upgrade_sign"
				"origin" "-4982.911621 -2107.001953 1184.875854"
				"display_text" "Hey fellas I'm back, come get your upgrades!"
				"lifetime"     "22"
			}
			training_annotation
			{
				"targetname" "gate2_upgrade_sign2"
				"origin" " -4071.288574 -1997.408813 505.022308"
				"display_text" "You can get to the shop through this nifty little vent here."
				"lifetime"     "18"
			}
			logic_auto
			{
				"OnMapSpawn" "spawnbot_scaffold,Disable"
                "OnMapSpawn" "spawnbot_balcony,Disable"
                "OnMapSpawn" "spawnbot_balcony_extra,Disable"
                "OnMapSpawn" "spawnbot_balcony_drain,Disable"
                "OnMapSpawn" "spawnbot_balcony_drain_extra,Disable"
                "OnMapSpawn" "spawnbot_garage,Disable"
                "OnMapSpawn" "spawnbot_hatch,Disable"
                "OnMapSpawn" "barrier_factory_relay_enable,Trigger"
                "OnMapSpawn" "barrier_gate1_relay_disable,Disable"
                "OnMapSpawn" "gate1_door_trigger,Disable"
                "OnMapSpawn" "gate2_door_trigger,Disable"
                "OnMapSpawn" "capturezone_blue,Disable"

				"OnMapSpawn" "gate1_relay,AddOutput,OnTrigger wave1_gate1_relay:Trigger::0:-1"
				"OnMapSpawn" "gate2_relay,AddOutput,OnTrigger wave1_gate2_relay:Trigger::0:-1"
                "OnMapSpawn" "reset_wave_relay,AddOutput,OnTrigger gate1_alarm_door_reset_relay:Enable::0:-1"
                "OnMapSpawn" "reset_wave_relay,AddOutput,OnTrigger gate2_alarm_door_reset_relay:Enable::0:-1"
			}
            logic_relay
            {
                //"OnMapSpawn" "pop_interface,Kill"
                "OnSpawn" "spawnbot_scaffold,Disable"
                "OnSpawn" "spawnbot_balcony,Disable"
                "OnSpawn" "spawnbot_balcony_extra,Disable"
                "OnSpawn" "spawnbot_balcony_drain,Disable"
                "OnSpawn" "spawnbot_balcony_drain_extra,Disable"
                "OnSpawn" "spawnbot_garage,Disable"
                "OnSpawn" "spawnbot_hatch,Disable"
                "OnSpawn" "barrier_factory_relay_enable,Trigger"
                "OnSpawn" "barrier_gate1_relay_disable,Disable"
                "OnSpawn" "gate1_door_trigger,Disable"
                "OnSpawn" "gate2_door_trigger,Disable"
                "OnSpawn" "capturezone_blue,Disable"

                "OnSpawn" "gate1_relay,AddOutput,OnTrigger wave1_gate1_relay:Trigger::0:-1"
				"OnSpawn" "gate2_relay,AddOutput,OnTrigger wave1_gate2_relay:Trigger::0:-1"
                "OnSpawn" "reset_wave_relay,AddOutput,OnTrigger gate1_alarm_door_reset_relay:Enable::0:-1"
                "OnSpawn" "reset_wave_relay,AddOutput,OnTrigger gate2_alarm_door_reset_relay:Enable::0:-1"
            }
			prop_dynamic
			{
				"angles" "0 0 0"
				"disableshadows" "1"
				"model" "models/props_gameplay/cap_circle_128.mdl"
				"skin" "0"
				"solid" "0"
				"targetname" "bombfella_hologram_1"
				"origin" "-7035 1375 136"
			}
			prop_dynamic
			{
				"angles" "0 0 0"
				"disableshadows" "1"
				"model" "models/props_gameplay/cap_circle_128.mdl"
				"skin" "0"
				"solid" "0"
				"targetname" "bombfella_hologram_2"
				"origin" "-4465 -490 136"
			}
			prop_dynamic
			{
				"angles" "0 0 0"
				"disableshadows" "1"
				"model" "models/props_gameplay/cap_circle_128.mdl"
				"skin" "0"
				"solid" "0"
				"targetname" "bombfella_hologram_3"
				"origin" "-1233 549 8"
			}
			logic_relay
			{
				"targetname" "wave1_gate1_relay"
				"OnTrigger" "bot_stun_reprogram,Enable"
				"OnTrigger" "bot_stun_reprogram,Disable,,0.1"
				"OnTrigger" "spawnbot_scaffold,Disable"
                "OnTrigger" "spawnbot_balcony,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Enable,22"
                "OnTrigger" "spawnbot_balcony_drain_extra,Enable,,27"
                "OnTrigger" "gate2_door_trigger,Disable,,24"
                "OnTrigger" "player,$ChangeAttributes,GateOne_Capped,1"
				"OnTrigger" "gate1_alarm_door_reset_relay,Disable"
				"OnTrigger" "gate1_upgrade_sign,Show"
				"OnTrigger" "teleport_spawn_gate1,Enable"
			}
			logic_relay
			{
				"targetname" "wave1_gate2_relay"
				"OnTrigger" "bot_stun_reprogram,Enable"
				"OnTrigger" "bot_stun_reprogram,Disable,,0.1"
				"OnTrigger" "player,$ChangeAttributes,GateTwo_Capped,1"
                "OnTrigger" "spawnbot_balcony_drain,Disable,,21"
                "OnTrigger" "spawnbot_hatch,Enable,,21"
                "OnTrigger" "spawnbot_garage,Enable,,21"
				"OnTrigger" "gate2_alarm_door_reset_relay,Disable"
				"OnTrigger" "gate2_upgrade_sign,Show"
				"OnTrigger" "gate2_upgrade_sign2,Show,,2"
				"OnTrigger" "teleport_gate1,Enable"
				"OnTrigger" "teleport_gate1,Enable,,22"
				"OnTrigger" "teleport_gate1,Enable,,50"
			}
            filter_tf_bot_has_tag
            {
	            "require_all_tags" "1"
	            "tags" "bomb_fella"
	            "targetname" "filter_fella"
            }
            logic_relay
            {
                "targetname" "w1_subwaveone_complete_relay"
                "OnTrigger" "player,$ChangeAttributes,SubwaveOne_Complete"
                "OnTrigger" "barrier_factory_relay_disable,Trigger"
                "OnTrigger" "spawnbot_factory*,Disable"
                "OnTrigger" "spawnbot_scaffold,Enable"
                "OnTrigger" "spawnbot_balcony,Enable"
            }
            logic_relay
            {
                "targetname" "w1_subwavetwo_complete_relay"
                "OnTrigger" "player,$ChangeAttributes,SubwaveTwo_Complete"
                "OnTrigger" "barrier_gate1_relay_disable,Trigger,,3"
                "OnTrigger" "barrier_gate1*,Disable,,3"
                "OnTrigger" "spawnbot_balcony_drain_extra,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Disable"
                "OnTrigger" "spawnbot_balcony_drain,Enable"
            }
            logic_relay
            {
                "targetname" "w1_subwavethree_complete_relay"
                "OnTrigger" "player,$ChangeAttributes,SubwaveThree_Complete"
                //"OnTrigger" "capturezone_blue,Enable"
                "OnTrigger" "spawnbot_hatch,Disable"
                "OnTrigger" "spawnbot_garage,Disable"
            }
            math_counter
            {
                "targetname" "subwaveone_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "w1_subwaveone_complete_relay,Trigger"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "gateone_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "gate1_door_trigger,Enable"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "subwavetwo_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "w1_subwavetwo_complete_relay,Trigger"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "gatetwo_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "gate2_door_trigger,Enable"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            math_counter
            {
                "targetname" "subwavethree_counter"
                "startvalue" "0"
                "max" "100"
                "onhitmax" "w1_subwavethree_complete_relay,Trigger"
                "onhitmax" "!self,SetValue,0"
                "onhitmax" "!self,Disable"
                //"OutValue" "player,$DisplayTextCenter"
            }
            logic_relay
            {
                "targetname" "canteen_relay"
                "OnTrigger" "!activator,SetHealth,15000,0,-1"
                "OnTrigger" "player,$PlaySoundToSelf,=35|mvm/mvm_used_powerup.wav,0,-1"
            }
            trigger_multiple
            {
                "targetname" "trigger_that_does_nothing"
                "origin" "-3175.55 -1999.91 197"
                "mins" "-489 -212 -37"
                "maxs" "489 212 37"
            }
            trigger_multiple
            {
                "targetname" "trigger_that_does_nothing2"
                "origin" "-5424 1424 416"
                "mins" "-464 -112 -24"
                "maxs" "464 112 24"
            }
            trigger_teleport
            {
                "mins" "-296 -120 -152"
                "maxs" "296 120 152"
                "origin" "-6744 2504 624"
				"target" "spawnbot"
				"spawnflags" "1"
				"filtername" "filter_blueteam"
            }
            trigger_teleport
            {
                "mins" "-875 -480 -110"
                "maxs" "875 480 110"
                "origin" "-3323 -2982 878"
				"target" "spawnbot"
				"spawnflags" "1"
				"filtername" "filter_blueteam"
            }
        }
        points_gdetonator
        {
            OnParentKilledOutput
            {
                Target "subwaveone_counter"
                Action Add
                Param "20"
            }
        }
        points_gsteelfist
        {
            OnParentKilledOutput
            {
                Target "gateone_counter"
                Action Add
                Param "100"
            }
        }
        points_gsoldier
        {
            OnParentKilledOutput
            {
                Target "subwavetwo_counter"
                Action Add
                Param "50"
            }
        }
        points_gpyro
        {
            OnParentKilledOutput
            {
                Target "gatetwo_counter"
                Action Add
                Param "50"
            }
        }
        points_steelfist
        {
            OnParentKilledOutput
            {
                Target "gatetwo_counter"
                Action Add
                Param "5"
            }
        }
        points_common_one
        {
            OnParentKilledOutput
            {
                Target "subwaveone_counter"
                Action Add
                Param "1"
            }
        }
        points_common_gateone
        {
            OnParentKilledOutput
            {
                Target "gateone_counter"
                Action Add
                Param "1"
            }
        }
        points_common_two
        {
            OnParentKilledOutput
            {
                Target "subwavetwo_counter"
                Action Add
                Param "1"
            }
        }
        points_common_gatetwo
        {
            OnParentKilledOutput
            {
                Target "gatetwo_counter"
                Action Add
                Param "1"
            }
        }
        points_common_three
        {
            OnParentKilledOutput
            {
                Target "subwavethree_counter"
                Action Add
                Param "1"
            }
        }
        wave2_logic
        {
            NoFixup 1
            logic_relay
            {
                "OnSpawn" "blu_init_teleport_boss,Enable"
				"OnSpawn" "bossroom_door_trigger,Enable"
				"OnSpawn" "wipe_relay,Enable"
            }
            logic_relay
            {
                "targetname" "wave_start_boss_relay"
                "OnTrigger" "bossroom_door_trigger,Enable"
            }
            game_round_win
            {
                "targetname" "red_win"
                "TeamNum" "2"
                "switch_teams" "0"
                "force_map_reset" "1"
            }
            trigger_teleport
            {
                "mins" "-296 -120 -152"
                "maxs" "296 120 152"
                "origin" "-6744 2504 624"
				"target" "spawnbot"
				"spawnflags" "1"
				"filtername" "filter_blueteam"
            }
			prop_dynamic
			{
				"angles" "0 315 0"
				"disableshadows" "1"
				"model" "models/props_mvm/robot_spawnpoint.mdl"
				"skin" "3"
				"solid" "0"
				"targetname" "spawn_hologram_building_1"
				"origin" "-2808 5895 -192" //-2828 4119 -132
			}
			prop_dynamic
			{
				"angles" "0 315 0"
				"disableshadows" "1"
				"model" "models/props_mvm/robot_spawnpoint.mdl"
				"skin" "3"
				"solid" "0"
				"targetname" "spawn_hologram_building_2"
				"origin" "-2567 -203 243"
			}
			prop_dynamic
			{
				"angles" "0 135 0"
				"disableshadows" "1"
				"model" "models/props_mvm/robot_spawnpoint.mdl"
				"skin" "3"
				"solid" "0"
				"targetname" "spawn_hologram_2"
				"origin" "667.24 4135.62 -191.955"
			}
			logic_relay
			{
				"targetname" "midphase_start_relay"
				"OnTrigger" "necromancer_summon*,Disable"
				"OnTrigger" "shapeshift_loop*,cancelpending"
				"OnTrigger" "!activator,$AddCond,4,0,-1"
				"OnTrigger" "teleport_shapeshift,Enable,,1"
				"OnTrigger" "spawn_hologram*,AddOutput,skin 0"
				"OnTrigger" "spawn_hologram*,AddOutput,skin 3,2"
				"OnTrigger" "spawnbot_arena*,Enable,,1.5"
				"OnTrigger" "spawnbot_arena*,Disable,,3"
				"OnTrigger" "player,$PlaySoundToSelf,mvm/mvm_tele_activate.wav"
			}
			logic_relay
			{
				"targetname" "midphase_end_relay"
				"OnTrigger" "shapeshift_loop*,trigger"
				"OnTrigger" "necromancer_summon*,Enable,0.1"
				"OnTrigger" "!activator,$RemoveCond,4,0.1,-1"
				"Ontrigger" "teleport_shapeshift,Disable"
				"OnTrigger" "teleport_shapeshift_back,Enable"
				"OnTrigger" "teleport_shapeshift_back,Disable,,0.1"
				"OnTrigger" "player,$PlaySoundToSelf,ambient/machines/teleport1.wav"
			}
			logic_relay
			{
				"targetname" "bip"
				"OnTrigger" "player,$ChangeAttributes,Return" 
				//"OnTrigger" "player,$DisplayTextCenter,return"
			}
			info_target
			{
				"targetname" "tele_destination_shapeshift"
				"origin" "1008 -312 108"
			}
			trigger_teleport
            {
	            "filtername" "filter_shapeshift"
	            "origin" "-352 2736 112"
                "mins" "-2192 -3664 -656"
                "maxs" "2192 3664 656"
	            "spawnflags" "1"
	            "StartDisabled" "1"
				"landmark" "!activator"
	            "target" "tele_destination_shapeshift"
	            "targetname" "teleport_shapeshift"
            }
			trigger_teleport
            {
	            "filtername" "filter_shapeshift"
	            "origin" "-352 2736 112"
                "mins" "-2192 -3664 -656"
                "maxs" "2192 3664 656"
	            "spawnflags" "1"
	            "StartDisabled" "1"
	            "target" "spawnbot_boss"
	            "targetname" "teleport_shapeshift_back"
            }
			filter_tf_bot_has_tag
			{
				"targetname" "filter_shapeshift"
				"tags" "bot_shapeshift"
			}
        }
        wave3_logic
        {
            NoFixup 1
            logic_relay
            {
                "targetname" "generator_one_killed_relay"
                "OnTrigger" "barrier_building_1,Disable"
                //"OnTrigger" "barrier_building_1,DisableCollision"
				//"OnTrigger" "generator_prop_two,Disable"
				//"OnTrigger" "generator_prop_three,Disable"
                "OnTrigger" "spawnbot_heli,Enable"
                "OnTrigger" "player,$ChangeAttributes,CaptureGateOne"
            }
            logic_relay
            {
                "targetname" "generator_twothree_enable_relay"
				"OnTrigger" "generator_prop_two,Disable"
				"OnTrigger" "generator_prop_three,Disable"
            }
			logic_relay
			{
				"targetname" "generator_twothree_killed_relay"
                "OnTrigger" "barrier_building_2,Disable"
                //"OnTrigger" "barrier_building_2,DisableCollision"
				"OnTrigger" "generator_prop_four,Disable"
				"OnTrigger" "generator_prop_five,Disable"
				"OnTrigger" "generator_prop_six,Disable"
			}
			logic_relay
			{
				"targetname" "generator_fourfivesix_killed_relay"
                "OnTrigger" "hatchshield,Disable"
                "OnTrigger" "hatchshield,DisableCollision"
			}
            prop_dynamic
			{
				"angles" "0 315 0"
				"disableshadows" "1"
				"model" "models/props_mvm/robot_spawnpoint.mdl"
				"skin" "3"
				"solid" "0"
				"targetname" "spawn_hologram_1"
				"origin" "-2808 5895 -192" //-2828 4119 -132
			}
			prop_dynamic
			{
				"targetname" "generator_prop_one"
				"model" "models/props_frontline/generator.mdl"
				"disableshadows" "1"
				"solid" "0"
				"origin" "-5020 135 127"
                "StartDisabled" "1"
			}
			prop_dynamic
			{
				"targetname" "generator_prop_two"
				"model" "models/props_frontline/generator.mdl"
				"disableshadows" "1"
				"solid" "0"
				"origin" "-2587 -61 63"
                "StartDisabled" "1"
			}
			prop_dynamic
			{
				"targetname" "generator_prop_three"
				"model" "models/props_frontline/generator.mdl"
				"disableshadows" "1"
				"solid" "0"
				"origin" "-2711 -560 251"
                "StartDisabled" "1"
			}
			prop_dynamic
			{
				"targetname" "generator_prop_four"
				"model" "models/props_frontline/generator.mdl"
				"disableshadows" "1"
				"solid" "0"
				"origin" "-1574 987 -1"
                "StartDisabled" "1"
			}
			prop_dynamic
			{
				"targetname" "generator_prop_five"
				"model" "models/props_frontline/generator.mdl"
				"disableshadows" "1"
				"solid" "0"
				"origin" "-615 1107 -1"
				"angles" "0 90 0"
                "StartDisabled" "1"
			}
			prop_dynamic
			{
				"targetname" "generator_prop_six"
				"model" "models/props_frontline/generator.mdl"
				"disableshadows" "1"
				"solid" "0"
				"origin" "-940 1888 95"
				"angles" "0 -25 0"
                "StartDisabled" "1"
			}
            logic_relay
            {
                "targetname" "w3_subwaveone_complete_relay"
                "OnTrigger" "spawnbot_factory*,Disable"
                "OnTrigger" "spawnbot_scaffold,Enable"
                "OnTrigger" "spawnbot_balcony,Enable"
            }
            logic_relay
            {
                "targetname" "w3_subwavetwo_complete_relay"
                "OnTrigger" "spawnbot_balcony_drain_extra,Disable"
                "OnTrigger" "spawnbot_balcony_extra,Disable"
                "OnTrigger" "spawnbot_balcony_drain,Enable"
            }
            logic_relay
            {
                "targetname" "w3_subwavethree_complete_relay"
                "OnTrigger" "spawnbot_hatch,Disable"
                "OnTrigger" "spawnbot_garage,Disable"
            }
        }
		generator_template
		{
			prop_dynamic
			{
				"model" "models/props_frontline/generator.mdl"
				"disableshadows" "1"
				"solid" "0"
			}
		}
        Shapeshift_PrespawnDisguise
        {
            NoFixup 1 
            KeepAlive 1

            OnSpawnOutput
			{
				Target "apply_soldier_disguise_initial"
				Action "Trigger"
				Delay 0
			}

            //placeholder
            //OnSpawnOutput
			//{
			//	Target "disguise_stop"
			//	Action "Trigger"
			//	Delay 8
			//}

            logic_relay
            {
                "targetname" "apply_soldier_disguise_initial"

                "OnTrigger" "!activator,$WeaponStripSlot,0,0,-1" 
                "OnTrigger" "!activator,$GiveItem,Rocket Launcher,0.1,-1" 
				//"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.1,-1" 
                "OnTrigger" "!activator,SetCustomModel,models/bots/soldier_boss/bot_soldier_boss.mdl,0,-1" 

                "OnTrigger" "!self,Kill,,1,-1" 
            }

            logic_relay
            {
                "targetname" "disguise_stop"

                "OnTrigger" "!activator,$AddCond,4,0,-1"
                "OnTrigger" "!activator,$Suicide,,0.7,-1"

                "OnTrigger" "!self,Kill,,2,-1"

				"OnTrigger" "spawnbot_extra,Enable,,0.7,-1"
            }

            info_target
            {
                "targetname" "shapeshift_spawn_target"
                "origin" "0 0 0"
            }
        }

        Shapeshift_Spawn
        {
            OnSpawnOutput
			{
				Target "!activator"
				Action "$TeleportToEntity"
                Param "shapeshift_spawn_target"
				Delay 0
			}

            OnSpawnOutput
			{
				Target "!activator"
				Action "$PlaySound"
                Param "vo\mvm\norm\spy_mvm_specialcompleted07.mp3"
				Delay 0.1
			}

            OnSpawnOutput
			{
				Target "shapeshift_spawn_target"
				Action "Kill"
				Delay 1
			}
        }

        Shapeshift_Logic 
        {
			OnSpawnOutput
			{
				Target "shapeshift_start"
				Action "Trigger"
				Delay 3
			}

            OnParentKilledOutput
			{
				Target "!activator"
				Action "$SetProp$m_bUseBossHealthBar"
                Param "0"
				Delay 0
			}

							
		    logic_relay
            {
				"targetname" "shapeshift_start"
				"spawnflags" "2"

				"OnTrigger" "!activator,$WeaponStripSlot,0,0.51,-1" 
				"OnTrigger" "shapeshift_loop,Trigger,,0,-1"
			}
            logic_relay
            {
                "targetname" "shapeshift_global"
				"spawnflags" "2"

                "OnTrigger" "!activator,$AddCond,4,0,-1"
            }

			logic_relay 
			{
				"targetname" "shapeshift_loop"
				"spawnflags" "2"

                "OnTrigger" "shapeshift_global,Trigger,,0,-1"
				"OnTrigger" "soldier_shapeshift,Trigger,,0.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,5,-1"
				"OnTrigger" "demo_automic_shapeshift,Trigger,,5.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,10,-1"
				"OnTrigger" "heavy_shapeshift,Trigger,,10.5,-1"

				"OnTrigger" "!self,Trigger,,16,-1"
			}

            logic_relay 
            {
                "targetname" "scout_shapeshift"
				"spawnflags" "2"

                "OnTrigger" "shapeshift_global,Trigger,,0,-1"
                "OnTrigger" "!activator,$WeaponStripSlot,0,0,-1" 
				"OnTrigger" "!activator,$GiveItem,TF_WEAPON_SCATTERGUN,0.1,-1" 
				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 
				"OnTrigger" "!activator,SetCustomModel,models/bots/scout/bot_scout.mdl,0.11,-1" 

				"OnTrigger" "!activator,$AddCond,4,0.7,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.75,-1"
            }

			logic_relay 
            {
                "targetname" "soldier_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveItem,The U-clank-a,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Soldier,0,-1"

				"OnTrigger" "!activator,$AddCond,40,0.1,-1"
				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 
				
				"OnTrigger" "!activator,SetCustomModel,models/bots/soldier_boss/bot_soldier_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,soldier_sergeant_crits,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "demo_automic_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveCond,40,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Demo,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Full Metal Drill Hat,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/demo_boss/bot_demo_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,demo_bomber,0.4,-1"
				//"OnTrigger" "!activator,$SetProp$m_bUseBossHealthBar,0,3,-1"
				//"OnTrigger" "!activator,$SetProp$m_bUseBossHealthBar,1,0.45,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "heavy_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Heavy,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Prince Tavish's Crown,0,-1"
				"OnTrigger" "!activator,$RemoveItem,The Chargin' Targe,0,-1"
				"OnTrigger" "!activator,$RemoveItem,The Eyelander,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/heavy_boss/bot_heavy_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,heavy_deflector,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"

				"OnTrigger" "!activator,$RemoveItemAttribute,minigun spinup time increased|0,2,-1" 
            }
        }
        Yakuza_Title_Card_Shapeshift
		{
			OnSpawnOutput
			{
				Target "upper_text"
				Action "Display"
				Delay 0
			}

			OnSpawnOutput
			{
				Target "middle_text"
				Action "Display"
				Delay 0.2
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "upper_text"
				"message" "TWO-SIDED MENACE, EXPERIMENTAL UNIT"
				"x" "-1"
				"y" "0.4"
				"spawnflags" "1"
				"effect" "2"
				"channel" "2"
				"color" "255 255 255"
				"fxtime" "0.2"
				"fadeout" "1"
				//"fadein" "0"
				"holdtime" "5"
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "middle_text"
				"message" "SERGEANT SHAPESHIFT"
				"x" "-1"
				"y" "0.45"
				"channel" "0"
				"spawnflags" "1"
				"color" "255 255 255"
				"fadein" "0.2"
				"fadeout" "1"
				"holdtime" "4.8"
			}
		}

        Yakuza_Title_Card_Shapeshift_Supreme
		{
			OnSpawnOutput
			{
				Target "upper_text"
				Action "Display"
				Delay 0
			}

			OnSpawnOutput
			{
				Target "middle_text"
				Action "Display"
				Delay 0.2
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "upper_text"
				"message" "ROBOT OF MANY TALENTS, EXPERIMENTAL UNIT"
				"x" "-1"
				"y" "0.4"
				"spawnflags" "1"
				"effect" "2"
				"channel" "2"
				"color" "255 255 255"
				"fxtime" "0.2"
				"fadeout" "1"
				//"fadein" "0"
				"holdtime" "5"
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "middle_text"
				"message" "SERGEANT SHAPESHIFT SUPREME"
				"x" "-1"
				"y" "0.45"
				"channel" "0"
				"spawnflags" "1"
				"color" "255 255 255"
				"fadein" "0.2"
				"fadeout" "1"
				"holdtime" "4.8"
			}
		}
		Shapeshift_Supreme_Logic 
        {
			OnSpawnOutput
			{
				Target "shapeshift_start"
				Action "Trigger"
				Delay 3
			}

            OnParentKilledOutput
			{
				Target "!activator"
				Action "$SetProp$m_bUseBossHealthBar"
                Param "0"
				Delay 0
			}
			//OnSpawnOutput
			//{
			//	Target "!activator"
			//	Action "AddOutput"
			//	Param "targetname shapeshift"
			//}
			//OnParentKilledOutput
			//{
			//	Target "!activator"
			//	Action "AddOutput"
			//	Param "targetname "
			//}

			info_particle_system
			{
				"targetname" "spell_effect"
				"effect_name" "spell_cast_wheel_red"
				"flag_as_weather" "0"
				"start_active" "0"

				"OnUser1" "!self,Start,,0,-1"
				"OnUser1" "!self,Stop,,0.5,-1"
			}

			logic_relay 
			{
				"targetname" "necromancer_summon"

				"OnTrigger" "necromancer_summon_case,PickRandomShuffle"

				"OnTrigger" "spell_effect,FireUser1,,0,-1"
			}
			logic_case
			{
                "targetname" "necromancer_summon_case"
                "OnCase01" "summon_chief,Enable,,0,-1"
                "OnCase01" "summon_chief,Disable,,0.1,-1"
                "OnCase02" "summon_chief2,Enable,,0,-1"
                "OnCase02" "summon_chief2,Disable,,0.1,-1"
                "OnCase03" "summon_chief3,Enable,,0,-1"
                "OnCase03" "summon_chief3,Disable,,0.1,-1"
            }			
		    logic_relay
            {
				"targetname" "shapeshift_start"
				"spawnflags" "2"

				"OnTrigger" "!activator,$WeaponStripSlot,0,0.51,-1" 
				"OnTrigger" "shapeshift_loop,Trigger,,0,-1"
			}
            logic_relay
            {
                "targetname" "shapeshift_global"
				"spawnflags" "2"

                "OnTrigger" "!activator,$AddCond,4,0,-1"
            }

			logic_relay 
			{
				"targetname" "shapeshift_loop"
				"spawnflags" "2"

                "OnTrigger" "shapeshift_global,Trigger,,0,-1"
				"OnTrigger" "soldier_shapeshift,Trigger,,0.5,-1"//"soldier_shapeshift,Trigger,,0.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,5,-1"
				"OnTrigger" "demo_automic_shapeshift,Trigger,,5.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,10,-1"
				"OnTrigger" "heavy_shapeshift,Trigger,,10.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,15,-1"
				"OnTrigger" "medic_shapeshift,Trigger,,15.5,-1"

				"OnTrigger" "shapeshift_global,Trigger,,20,-1"
				"OnTrigger" "sniper_shapeshift,Trigger,,20.5,-1"

                "OnTrigger" "shapeshift_global,Trigger,,25,-1"
				"OnTrigger" "scout_shapeshift,Trigger,,25.5,-1"

				"OnTrigger" "!self,Trigger,,30,-1"
			}

            logic_relay 
            {
                "targetname" "scout_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveItem,Corona Australis,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Scout,0,-1"
                "OnTrigger" "!activator,$PlaySequence,layer_taunt_the_boston_breakdance,0.2,-1"

				"OnTrigger" "!activator,$AddCond,40,0.1,-1"
				"OnTrigger" "!activator,$WeaponSwitchSlot,2,0.11,-1" 
				
				"OnTrigger" "!activator,SetCustomModel,models/player/scout.mdl,0.11,-1" 
                //"OnTrigger" "!activator,SetCustomModel,models/bots/scout/bot_scout.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,scout_bat,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }
			logic_relay 
            {
                "targetname" "soldier_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveItem,Hero's Tail,0,-1"
                "OnTrigger" "!activator,$RemoveItem,The Eye-Catcher,0,-1"
                "OnTrigger" "!activator,$RemoveItem,Dead of Night,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Soldier,0,-1"

				"OnTrigger" "!activator,$AddCond,40,0.1,-1"
				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 
				
				"OnTrigger" "!activator,SetCustomModel,models/bots/soldier_boss/bot_soldier_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,soldier_sergeant_crits,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "demo_automic_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$RemoveCond,40,0,-1"

				"OnTrigger" "!activator,$ChangeAttributes,Demo,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Tyrant's Helm,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/demo_boss/bot_demo_boss.mdl,0.1,-1" 

				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,demo_giant,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "heavy_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Heavy,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Rimmed Raincatcher,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/heavy_boss/bot_heavy_boss.mdl,0.1,-1" 
				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,heavy_shotgun_burst_lite,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "medic_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Medic,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Security Shades,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/medic/bot_medic.mdl,0.1,-1" 
				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,medic_boost_giant,0.4,-1"

				//"OnTrigger" "!activator,$PlaySequence,secondrate_socery_medic,1,-1"

				"OnTrigger" "necromancer_summon,Trigger,,2,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }

			logic_relay 
            {
                "targetname" "sniper_shapeshift"
				"spawnflags" "2"

				"OnTrigger" "!activator,$ChangeAttributes,Sniper,0,-1"

                "OnTrigger" "!activator,$RemoveItem,Spine-Chilling Skull,0,-1"
				//"OnTrigger" "!activator,$RemoveItem,Zombie Medic,0,-1"

				"OnTrigger" "!activator,$WeaponSwitchSlot,0,0.11,-1" 

				"OnTrigger" "!activator,SetCustomModel,models/bots/sniper/bot_sniper.mdl,0.1,-1" 
				"OnTrigger" "!activator,$SetProp$m_iszClassIcon,sniper_bow_atomic,0.4,-1"

				"OnTrigger" "!activator,$AddCond,4,0.5,-1"
				"OnTrigger" "!activator,$RemoveCond,4,0.55,-1"
            }
        }
		Necromancer_Position 
        {
			NoFixup 1

			info_target 
			{
				"targetname" "necromancer_target"

				"Origin" "0 0 0"
			}
		}

		Necromancer_Summoned 
		{
			OnSpawnOutput
			{
				Target "!activator"
				Action "$TeleportToEntity"
				Param "necromancer_target"
				Delay 0
			}
		}
      	Explosive_Tip_Bot
		{
			KeepAlive 1

			OnSpawnOutput 
			{
				Target "tip_explosion"
				Action "$InheritOwner"
				Param "!activator"
				Delay 0.1
			}

			OnSpawnOutput 
			{
				Target "@c@!activator"
				Action "FireUser1"
				Delay 0
			}

			OnSpawnOutput 
			{
				Target "explosive_tip_relay"
				Action "FireUser1"
				Delay 0
			}

			OnSpawnOutput 
			{
				Target "explosive_tip_relay"
				Action "FireUser1"
				Delay 0
			}

			logic_relay
			{
				"targetname" "explosive_tip_relay"

				"OnUser1" "!self,Kill,,5,-1"
			}

			info_target
			{
				"targetname" "detonate_position"

				"OnUser1" "!self,Kill,,5,-1"
			}

			tf_point_weapon_mimic
			{
				"targetname" "tip_explosion"

				"spawnflags" "1"
				"angles" "0 0 0"
				"origin" "-1 0 -3"
				"teamnum" "2"
				"Crits" "0"
				"Damage" "75"
				"ModelScale" "1"
				"SpeedMax" "1000000"
				"SpeedMin" "1000000"
				"SplashRadius" "144"
				"SpreadAngle" "0"
				"WeaponType" "3"

				"OnUser1" "!self,FireOnce,,2,-1"
				"OnUser4" "!self,DetonateStickies,,0,-1"
			}
			
			logic_measure_movement 
			{
				"MeasureReference" "detonate_position"
				"MeasureTarget" "detonate_position"
				"MeasureType" "0"
				"Target" "tip_explosion"
				"TargetReference" "detonate_position"
				"TargetScale" "1"
			}

			info_particle_system
			{
				"targetname" "sticky_flicker"
				"effect_name" "stickybomb_pulse_red"
				"flag_as_weather" "0"
				"start_active" "0"
				
				"OnUser1" "!self,Start,2,1,-1"
				"OnUser1" "!self,Kill,2.7,3,-1"
			}
			logic_measure_movement 
			{
				"MeasureReference" "detonate_position"
				"MeasureTarget" "detonate_position"
				"MeasureType" "0"
				"Target" "sticky_flicker"
				"TargetReference" "detonate_position"
				"TargetScale" "1"
			}

			ambient_generic
			{
				"targetname" "sticky_sound"
				"message" "weapons/stickybomblauncher_det.wav"
				"radius" "4000"
				"health" "5"
				"spawnflags" "48"

				"OnUser1" "!self,PlaySound,,1,-1"
				"OnUser1" "!self,Kill,,3,-1"
			}

			logic_measure_movement 
			{
				"MeasureReference" "detonate_position"
				"MeasureTarget" "detonate_position"
				"MeasureType" "0"
				"Target" "sticky_sound"
				"TargetReference" "detonate_position"
				"TargetScale" "1"
			}

			filter_activator_tfteam 
			{
				"targetname" "filter_is_blu"
				"Negated" "0"
				"TeamNum" "3"

				"OnUser1" "!self,Kill,,2.1,-1"
			}	

			trigger_hurt //for some reason I can't explain using a trigger_once or trigger_multiple just blocks the projectile
			{
				"targetname" "attach_to_enemy"
				"origin" "0 0 0"
				"mins" "-3 -3 -3"
				"maxs" "3 3 3"
				"Damage" "0"
				"spawnflags" "1" 
				"filtername" "filter_is_blu"

				"OnStartTouch" "detonate_position,SetParent,!activator,0,-1"
				//"OnStartTouch" "player,$DisplayTextChat,attached,0.1,-1"
				"OnStartTouch" "!self,Disable,,0.1,-1"

				"OnUser1" "!self,Kill,,2.1,-1"
			}
			

			RemoveIfKilled "explosive_tip_relay"
		}
        Yakuza_Title_Card_HunterChopper
		{
			OnSpawnOutput
			{
				Target "upper_text"
				Action "Display"
				Delay 3
			}

			OnSpawnOutput
			{
				Target "middle_text"
				Action "Display"
				Delay 3.2
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "upper_text"
				"message" "AIRBORNE ASSAULT ARSENAL"
				"x" "-1"
				"y" "0.4"
				"spawnflags" "1"
				"effect" "2"
				"channel" "2"
				"color" "255 255 255"
				"fxtime" "0.2"
				"fadeout" "1"
				//"fadein" "0"
				"holdtime" "5"
			}

			game_text
			{
				"origin" "1984 1984 99999"
				"targetname" "middle_text"
				"message" "HELICOPTER"
				"x" "-1"
				"y" "0.45"
				"channel" "0"
				"spawnflags" "1"
				"color" "255 255 255"
				"fadein" "0.2"
				"fadeout" "1"
				"holdtime" "4.8"
			}
		}
        Helicopter_Base_Init
		{
			NoFixup 1

			OnSpawnOutput
			{
				Target "!activator"
				Action "AddOutput"
				Param "targetname helicopter_bot"
				Delay 0
			}

			OnParentKilledOutput
			{
				Target "!activator"
				Action "AddOutput"
				Param "targetname  "
				Delay 0
			}

			info_target
			{
				"targetname" "helicopterhitbox_position"
				"origin" "-100 0 430"
			} 


			info_target
			{
				"targetname" "helicoptershooter_position"
				"origin" "0 0 420"
			} 
		}

		Helicopter_Patterns
		{
			NoFixup 1
            
            OnSpawnOutput
			{
				Target "pattern_switch"
				Action "Trigger"
				Delay 0
			}

            logic_relay 
			{
				"targetname" "pattern_switch"
				"spawnflags" "2"

                //pattern 2 after 4 seconds
                "OnTrigger" "player,$DisplayTextChat,pattern 2,4,-1"
				"OnTrigger" "helicopter_bot_shoot,$ChangeAttributes,Pattern2,4,-1"

                //pattern 8 after 9 seconds
                "OnTrigger" "player,$DisplayTextChat,pattern 3,9,-1"
				"OnTrigger" "helicopter_bot_shoot,$ChangeAttributes,Pattern3,9,-1"

                //pattern 4 after 13 seconds
                "OnTrigger" "player,$DisplayTextChat,pattern 4,13,-1"
				"OnTrigger" "helicopter_bot_shoot,$ChangeAttributes,Pattern4,13,-1"

                //default pattern after 15 seconds, loop
                "OnTrigger" "player,$DisplayTextChat,reset,15,-1"
                "OnTrigger" "helicopter_bot_shoot,$ChangeAttributes,Default,15,-1"
                "OnTrigger" "pattern_switch,Trigger,,15.1,-1"
			}
		}

		Helicopter_Shooter_Init
		{
			OnSpawnOutput
			{
				Target "!activator"
				Action "AddOutput"
				Param "targetname helicopter_bot_shoot"
				Delay 0
			}

			OnSpawnOutput
			{
				Target "helicopter_relay"
				Action "FireUser1"
				Delay 0
			}

			OnSpawnOutput 
			{
				Target "stickies"
				Action "FireUser1"
				Delay 5
			}


			OnSpawnOutput 
			{
				Target "stickies"
				Action "SetOwner"
				Param "!activator"
				Delay 0
			}

			logic_relay 
			{
				"targetname" "helicopter_relay"
				"OnUser1" "!activator,$TeleportToEntity,helicoptershooter_position,0,-1"
				"OnUser1" "!self,FireUser1,,0.01,-1"
			}

			tf_point_weapon_mimic
			{
				"targetname" "stickies"

				"$preventshootparent" "1"

				"spawnflags" "1"
				"angles" "0 0 0"
				"origin" "0 0 0"
				"teamnum" "2"
				"Crits" "0"
				"Damage" "100"
				"ModelScale" "1"
				"ModelOverride" "models/weapons/w_models/w_stickybomb.mdl"
				"SpeedMax" "1000"
				"SpeedMin" "100"
				"SplashRadius" "144"
				"SpreadAngle" "30"
				"WeaponType" "3"

				"OnUser1" "!self,FireMultiple,15,0,-1"
				"OnUser1" "!self,DetonateStickies,,3,-1"
				"OnUser1" "!self,FireUser1,,4,-1"
			}


			//model
			prop_dynamic
			{
				"targetname" "helicopter_model"
				"model" "models/props_frontline/helicopter_windows.mdl"//"models/combine_helicopter.mdl"
				"origin" "0 0 -100"
				"angles" "0 0 0"
				"DefaultAnim" "fly_idle"
                "modelscale" "1.5"
                "skin" "0"
				"solid" "0"
			}

			//glow, doesn't work
			tf_glow
			{
                "GlowColor" "88 133 162"
                "Mode" "0"
                "target" "helicopter_model"
			}
		}

		Helicopter_Tank_Init
		{
			OnSpawnOutput
			{
				Target "helicopter_relay"
				Action "FireUser1"
				Delay 0
			}
			//no player collision resolve logic (thanks orin)
			OnSpawnOutput
			{
				Target "!activator"
				Action "Disable"
				Delay 1
			}
			// OnSpawnOutput
			// {
			// 	Target "helicopter_pattern2_detect"
			// 	Action "Trigger"
			// 	Delay 0
			// }

			OnParentKilledOutput
			{
				Target "helicopter_bot*"
				Action "$Suicide"
				Param "0"
				Delay 0
			}

			OnParentKilledOutput
			{
				Target "helicopter_bot*"
				Action "AddOutput"
				Param "targetname "
				Delay 0.1
			}

			logic_relay 
			{
				"targetname" "helicopter_relay"
				"OnUser1" "!activator,$TeleportToEntity,helicopterhitbox_position,0,-1"
				"OnUser1" "!self,FireUser1,,0.01,-1"
			}

			// logic_relay 
			// {
			// 	"targetname" "helicopter_pattern2_detect"
			// 	"spawnflags" "2"

			// 	"OnTrigger" "!activator,AddOutput,OnHealthBelow90Percent helicopter_pattern2_relay:Trigger:0:-1,0,-1"
			// }
		}
		PlayerResInput
		{
			NoFixup 1
			OnSpawnOutput
			{
				Target "playerResInWave"
				Action Test
			}
			logic_relay
			{
				"targetname" "set_norespawn_relay"
				"OnTrigger" "!activator,$AddPlayerAttribute,min respawn time|9999"
			}
			logic_relay
			{
				"targetname" "wipe_loopfix"
				"onTrigger" "player,$SetVar$hasRes,0,0,-1"
			}
			logic_branch
			{
				"startvalue" "0" // used to detect if wave is started or not
				"targetname" "playerResInWave"
				"onTrue" "player,$SetVar$inWave,1,0,-1"
				"onTrue" "playerResInWaveTest,$SetVar$inWave,1,0,-1"
				"onFalse" "player,$SetVar$inWave,0,0,-1"
				"onFalse" "playerResInWaveTest,$SetVar$inWave,0,0,-1"
			}
			math_counter
			{
				"targetname" "playerResInWaveTest"
			}
			math_counter
			{
				"startvalue" "0" // value to change


				"targetname" "playerResVal1"
				"onGetValue" "player,$SetVar$hasRes,,0,-1"
			}
			math_counter
			{
				"startvalue" "1" // value to change


				"targetname" "playerResVal2"
				"onGetValue" "player,$SetVar$hasRes,,0,-1"
			}
			math_counter
			{
				"startvalue" "2" // value to change


				"targetname" "playerResVal3"
				"onGetValue" "player,$SetVar$hasRes,,0,-1"
			}
			logic_relay
			{
				"targetname" "playerResConfirmForceRespawn"
				"OnTrigger" "!activator,$ForceRespawnDead,,0,-1"
			}
		}
        PlayerRes
		{
			keepalive 1
			OnParentKilledOutput
			{
				Target "playerResConfirm"
				Action InValue
				Param  "$$=''..?(int(!activator.hasRes) > 0, ?(int(playerResInWaveTest.inWave) < 1,string('99'),string('1')),?(int(playerResInWaveTest.inWave) < 1,string('99'),string('0')))"
			}
			OnSpawnOutput
			{
				Target "set_norespawn_relay"
				Action Trigger
			}
            logic_case
			{
                "targetname" "playerResConfirm"
                "case01" "1"
                "case02" "0"
				"case03" "99"
                "OnCase01" "!activator,$ForceRespawnDead,,2,-1"
				"OnCase01" "!activator,$AddCond,52 5,2.1,-1" //respawn uber, change 2nd number for duration
                "OnCase01" "!activator,$SetVar$hasRes,$$=(int(!activator.hasRes) - 1),2,-1"
				// formatting string for if you have lifes
                "OnCase01" "player,$DisplayTextChat,$$=''.. '{f5c542}' .. string(!activator.m_szNetname) .. string('{ffffff} has been revived, they have {f5c542}') .. string(!activator.hasRes) .. string('{ffffff} more lives left.'),2,-1"
				"OnCase01" "revivefx,PlaySound,,2.05,-1"
				"OnCase01" "revivefx,PlaySound,,2.05,-1"
				"OnCase01" "revivefx,kill,,3,-1"
				"OnCase01" "!self,kill,,3,-1"
				// formatting string for if no lifes
				"OnCase02" "player,$DisplayTextChat,$$=''.. '{f5c542}' .. string(!activator.m_szNetname) .. string('{ffffff} has {ff2b2b} no more lives {ffffff}, they will be able to respawn at wave end.'),0,-1"
				"OnCase02" "!self,kill,,3,-1"
				"OnCase02" "revivefx,kill,,3,-1"
				"OnCase02" "!activator,$AddPlayerAttribute,min respawn time|9999,0,-1"

				"OnCase03" "playerResConfirmForceRespawn,Trigger,,2,-1"
				"OnCase03" "!self,kill,,0,-1"
				"OnCase03" "revivefx,kill,,0,-1"
            }
			ambient_generic
			{
                "targetname" "revivefx"
                "origin" "0 0 0"
                "volstart" "10"
                "spawnflags" "17"
                "radius" "999999"
                "preset" "0"
                "pitchstart" "125"
                "pitch" "125"
                "message" "#mvm\mvm_revive.wav" //to change respawn sound (plays globally)
                "lfotype" "0"
                "lforate" "0"
                "lfomodvol" "0"
                "lfomodpitch" "0"
                "health" "7.5"
                "fadeoutsecs" "0"
                "fadeinsecs" "0"
                "cspinup" "0"
			}
        }
		PlayersLeftLogic
		{
            NoFixup 1
            math_counter
			{
                "targetname" "playersLeftAlive"
                "startvalue" "0"
                //"outValue" "playersLeftFormat,$SetKey$Case01,,0,-1"
                //"outValue" "playersLeftFormat,$Format,,0.2,-1"
                "outValue" "wipeCheck,SetValueCompare,,0,-1"
            }
            logic_compare
			{
                "targetname" "wipeCheck"
                "initialValue" "0"
                "CompareValue" "0"
                "OnEqualTo" "blualive_safety_timer,Enable,,0,-1"
                "OnNotEqualTo" "blualive_safety_timer,Disable,,0,-1"
            }
			logic_relay
			{
				"targetname" "wipe_relay"
				"startdisabled" "1"
				"OnTrigger" "wipe_fade,Fade"
				"OnTrigger" "wipe_loopfx,Trigger"
				"OnTrigger" "red_win,RoundWin"
			}
            //logic_case
            //{
            //    "targetname" "playersLeftFormat"
            //    "case16" "Players Alive: %" //formatting string
            //    "case01" "h" //Will be the number of players currently alive
            //    //"case02" "6" //Uncomment to give another param to show total team size, could be made dynamic but prob best left
            //    "ondefault" "playersLeftDisplay,$SetKey$Message,,0,-1"
            //    "ondefault" "playersLeftDisplay,Display,,0.2,-1"
            //}
            //game_text
			//{
            //    "targetname" "playersLeftDisplay"
            //    "channel" "3"
            //    "color" "255 255 255"
            //    "color2" "255 255 255"
            //    "effect" "0"
            //    "fadein" "0"
            //    "fadeout" "1"
            //    "fxtime" "0.25"
            //    "holdtime" "9999"
            //    "message" "FunnyHahaPlaceholderText"
            //    "spawnflags" "1"
            //    "x" "0.85"
            //    "y" "0.1"
            //}
			logic_timer
			{
				"targetname" "blualive_safety_timer"
				"startdisabled" "1"
				"refiretime" "5"
				"OnTimer" "wipe_relay,Trigger"
				"OnTimer" "!self,Disable"
			}
			env_fade
			{
				"targetname" "wipe_fade"
				"duration" "1"
				"holdtime" "10"
				"renderamt" "100"
				"rendercolor" "164 0 0"
				"spawnflags" "0"
			}
        }
        PlayerTracker
		{
            NoFixup 1
            OnSpawnOutput
			{
                Target "playersLeftAlive"
                Action "add"
                Param "1"
            }
            logic_relay
			{
                "$OnKilled" "playersLeftAlive,Subtract,1,0,0"
            }
        }
        CustomCanteensSetup
		{
            OnSpawnOutput
            {
                Target "@c@!activator"
                Action "$SetProp$m_usNumCharges"
                Param 0
                Delay 0
            }

            OnSpawnOutput
            {
                Target "!activator"
                Action "$SetVar$currentCustomCanteenCharges"
                Param 0
                Delay 0
            }

            OnSpawnOutput
            {
                Target "!activator"
                Action "$SetVar$lastUpdatedClass"
                Param "69"
                Delay 0
            }
        }

		CustomCanteens
		{
			OnSpawnOutput
			{
				Target "canteen_input"
				Action "FireUser1"
                Delay 0.1
			}

            OnSpawnOutput
            {
                Target "set_class_changed_value"
                Action "$SetKey$case01"
                Param "$$=!activator.m_iClass"
                Delay 0
            }

            OnSpawnOutput
            {
                Target "set_class_changed_value"
                Action "$Format"
                Delay 0.01
            }

            OnSpawnOutput
            {
                Target "class_changed_check"
                Action "TestActivator"
                Delay 0.02
            }

            logic_case
            {
                //can't target $value with setkey
                "targetname" "set_class_changed_value"
                "case16" "$value %"
                "case01" "def"

                "OnDefault" "class_changed_check,AddOutput,,0,-1"
            }

            $filter_variable
			{
                //check if player changed class since last canteen applied update
                //in which case reset their charges count
                "targetname" "class_changed_check"
				"$name" "lastUpdatedClass"
                
				"$value" "-1" //to be set later

				"$compare" "equal"
				"Negated" "1"

                "OnPass" "player,$SetVar$currentCustomCanteenCharges,0,0,-1"
                "OnPass" "player,$SetProp$m_usNumCharges,0,0,-1"
            }

            logic_branch
            {
                //bool for if player has vanilla canteen
                "targetname" "vanilla_canteens_bool"

                "InitialValue" "0"

                "OnTrue" "!activator,$SetVar$currentCustomCanteenCharges,0,-1"
            }

            logic_compare
            {
                //check if player owns any vanilla canteen incase a vanilla canteen is bought with a custom canteen equipped
                //in which case, remove all current current canteens charges
                "targetname" "vanilla_canteens_check"

                "CompareValue" "1988"

                "OnNotEqualTo" "vanilla_canteens_bool,SetValue,1,0,-1"
            }

            logic_compare
            {
                //check if m_usNumCharges is different from currentCustomCanteenCharges variable
                "targetname" "canteen_input_used_check"

                "CompareValue" "69420" //to be set later

                "OnLessThan" "canteen_owned_check,TestActivator,,0,-1"
            }

            logic_compare
            {
                "targetname" "sanitize_canteen_input"

                "CompareValue" "6900"
                
                //"OnLessThan" "player,$DisplayTextChat,,0,-1"
                "OnLessThan" "canteen_input_used_check,SetCompareValue,$$=!activator.currentCustomCanteenCharges,0,-1"
                "OnLessThan" "canteen_input_used_check,SetValueCompare,,0.01,-1"
            }

            logic_relay 
            {
                "targetname" "canteen_input"

                //since $getprop with @c@ work like an index loop doing the applied output on every child and default to a set value if the prop index doesn't exist 
                //I can hook it to a logic_compare and see if the input is different from the default value
                "OnUser1" "@c@!activator,$GetProp$m_usNumCharges,sanitize_canteen_input|SetValueCompare|6900,0,-1"
                "OnUser1" "vanilla_canteens_bool,SetValue,0,0,-1" //reset for this cycle

                //test for vanilla cans 
                "OnUser1" "!activator,$GetItemAttribute,9|critboost|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|ubercharge|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|refill_ammo|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|recall|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "!activator,$GetItemAttribute,9|building instant upgrade|vanilla_canteens_check|SetValueCompare|1988,0,-1"
                "OnUser1" "vanilla_canteens_bool,Test,,0.01,-1"

                "OnUser1" "!self,FireUser1,,0.2,-1"
            }

            logic_compare
            {
                //check if canteen count is at 0
                "targetname" "canteen_is_empty"

                "CompareValue" "0"

                "OnEqualTo" "on_canteen_empty,Trigger,,0,-1"

                "OnUser1" "!activator,$GetVar$currentCustomCanteenCharges,canteen_is_empty|SetValueCompare|-1,0,-1"
            }

            logic_relay
			{
                //triggered after a successful custom canteen use
				"targetname" "canteen_input_success"
				"spawnflags" "2"

                "OnTrigger" "!activator,$SetVar$currentCustomCanteenCharges,$$=!activator.currentCustomCanteenCharges - 1,0,-1"
                "OnTrigger" "@c@!activator,$SetProp$m_usNumCharges,$$=!activator.currentCustomCanteenCharges - 1,0,-1"
                "OnTrigger" "canteen_is_empty,FireUser1,,0.01,-1"
			}

            $filter_variable
			{
                //check if player has any remaining canteen charges
                "targetname" "canteen_owned_check"
				"$name" "currentCustomCanteenCharges"
				"$value" "0"
				"$compare" "greater than"
				"Negated" "0"

                "OnPass" "canteen_effect,TestActivator,,0,-1"
            }

            $filter_variable
			{
				"targetname" "canteen_effect" //speed boost canteen

                "$value" "1"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}SPEED BOOST {reset}Power Up Canteen!,0,-1"
                "OnPass" "!activator,$AddCond,32,0,-1"
                "OnPass" "!activator,$RemoveCond,32,5,-1"
			}

            filter_activator_tfteam 
			{
				"targetname" "filter_is_red"
				"Negated" "0"
				"TeamNum" "2"
			}

            $filter_sendprop
			{
                "targetname" "filter_is_not_giant"
				"$name" "m_bIsMiniBoss"
				"$value" "0"
				"$compare" "equal"
				"Negated" "0"
            }

            filter_multi 
            {
                "targetname" "filter_can_be_sapped"
                "Negated" "0"
                "FilterType" "0"
                "Filter01" "filter_is_red"
                "Filter02" "filter_is_not_giant"
            }


            trigger_multiple
            {
                "targetname" "reprogram_canteen_apply"
                "origin" "0 0 0"
                "mins" "-300.0 -300.0 -300.0"
                "maxs" "300.0 300.0 300.0"
                "spawnflags" "1" 
                "StartDisabled" "1"
                "filtername" "filter_can_be_sapped"

                "OnStartTouch" "!activator,$AddPlayerAttribute,receive friendly fire|1,0,-1"
                "OnStartTouch" "!activator,$RemoveCond,43,0,-1"
                "OnStartTouch" "!activator,$AddCond,50,0,-1"

                "OnStartTouch" "!activator,$RemovePlayerAttribute,receive friendly fire,8,-1"
                "OnStartTouch" "!activator,$AddCond,43,8,-1"
                "OnStartTouch" "!activator,$RemoveCond,50,8,-1"
                "OnStartTouch" "!activator,$Suicide,50,8,-1" //self-destruct bot after done reprogramming

                "OnUser1" "!self,Enable,,0,-1"
                "OnUser1" "!self,Disable,,0.01,-1"
            }

            info_particle_system
            {
                "targetname" "sapper_effect"
                "effect_name" "Explosion_ShockWave_01"
                "flag_as_weather" "0"
                "start_active" "0"
            }

			$filter_variable
			{
				"targetname" "canteen_effect" //reprogram canteen
				
                "$value" "2"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"


                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}REPROGRAM {reset}Power Up Canteen!,0,-1"
                "OnPass" "sapper_effect,Stop,,0,-1" 
                "OnPass" "sapper_effect,Start,,0.01,-1" 
                "OnPass" "reprogram_canteen_apply,FireUser1,,0,-1" 
			}

            $filter_variable
			{
				"targetname" "canteen_effect" //berserk canteen
				
                "$value" "3"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"


                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}BERSERK {reset}Power Up Canteen!,0,-1"

                //force minigun to stop reving/sniper unscope 
                "OnPass" "!activator,$AddItemAttribute,alt-fire disabled|1|0,0,-1"

                "OnPass" "!activator,$Addcond,41,0,-1"
				"OnPass" "!activator,$Addcond,46,0,-1"
                "OnPass" "!activator,$WeaponSwitchSlot,2,0.01,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: damage bonus|1.25,0,-1"
                //"OnPass" "!activator,$AddItemAttribute,fists have radial buff|1|2,0,-1"
                //"OnPass" "!activator,$AddPlayerAttribute,melee range multiplier|1.1,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,melee attack rate bonus|0.8,0,-1"

                "OnPass" "!activator,$WeaponSwitchSlot,2,1.5,-1" //for revved up miniguns

                "OnPass" "!activator,$RemoveItemAttribute,alt-fire disabled|0,5,-1"

				"OnPass" "!activator,$Removecond,46,5,-1"
            	"OnPass" "!activator,$RemovePlayerAttribute,CARD: damage bonus,5,-1"
                //"OnPass" "!activator,$RemoveItemAttribute,fists have radial buff|2,5,-1"
                //"OnPass" "!activator,$RemovePlayerAttribute,melee range multiplier,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,melee attack rate bonus,5,-1"
                "OnPass" "!activator,$Removecond,41,5,-1"
			}

            $filter_variable
			{
				"targetname" "canteen_effect" //adrenaline canteen
				
                "$value" "4"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"
                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}ADRENALINE {reset}Power Up Canteen!,0,-1"

                "OnPass" "!activator,$Addcond,46,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: damage bonus|1.5,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: move speed bonus|1.2,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,CARD: health regen|5,0,-1"
                "OnPass" "!activator,$Addcond,46,0,-1"

                "OnPass" "!activator,$Removecond,46,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,CARD: damage bonus,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,CARD: move speed bonus,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,CARD: health regen,5,-1"

                //fatigue
				"OnPass" "!activator,$Addcond,15,5,-1"
                "OnPass" "!activator,$AddPlayerAttribute,damage penalty|0.7,5,-1"
                "OnPass" "!activator,$AddPlayerAttribute,move speed penalty|0.8,5,-1"

				"OnPass" "!activator,$Removecond,15,10,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,damage penalty,10,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,move speed penalty,10,-1"
			}

            logic_relay 
            {
                //proxy relay to deapply stealth, deapplication is cancelled upon using a new stealth canteen to prevent overlap
                "targetname" "stealth_can_duration"
                "spawnflags" "2"

                "OnTrigger" "!activator,$Removecond,64,14.9,-1"
            }

            $filter_variable
			{
				"targetname" "canteen_effect" //stealth canteen
				
                "$value" "5"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}STEALTH {reset}Power Up Canteen!,0,-1"

                "OnPass" "stealth_can_duration,$CancelPending,,0,-1"
                "OnPass" "!activator,$Addcond,64,0,-1"

                "OnPass" "stealth_can_duration,Trigger,,0.1,-1"
			}

            trigger_multiple
            {
                "targetname" "piss_apply"
                "origin" "0 0 0"
                "mins" "-1000.0 -1000.0 -1000.0"
                "maxs" "1000.0 1000.0 1000.0"
                "spawnflags" "1" 
                "StartDisabled" "1"
                "filtername" "filter_is_red"

                "OnStartTouch" "!activator,$AddCond,24,0,-1"
                "OnStartTouch" "!activator,$RemoveCond,24,15,-1"

                "OnUser1" "!self,Enable,,0,-1"
                "OnUser1" "!self,Disable,,0.01,-1"
            }

            info_particle_system
            {
                "targetname" "piss_effect"
                "effect_name" "eyeboss_death"
                "flag_as_weather" "0"
                "start_active" "0"
            }

	        $filter_variable
			{
				"targetname" "canteen_effect" //piss canteen
				
                "$value" "6"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}PISSPLOSION {reset}Power Up Canteen!,0,-1"

                "OnPass" "piss_effect,Stop,,0,-1" 
                "OnPass" "piss_effect,Start,,0.01,-1" 
                "OnPass" "piss_apply,FireUser1,,0,-1" 
			}

            $filter_variable
			{
				"targetname" "canteen_effect" //knockback immunity canteen
				
                "$value" "69"

				"$name" "canteenIndex"
				"$compare" "equal"
				"Negated" "0"

                "OnPass" "canteen_input_success,Trigger,,0,-1"

                "OnPass" "player,$DisplayTextChat,{blue}{activator}{reset} has used their {9BBF4D}KNOCKBACK IMMUNITY {reset}Power Up Canteen!,0,-1"

                "OnPass" "!activator,$Addcond,20,0,-1"
                "OnPass" "!activator,$AddPlayerAttribute,damage force reduction|0.001,0,-1"

				"OnPass" "!activator,$Removecond,20,5,-1"
                "OnPass" "!activator,$RemovePlayerAttribute,damage force reduction,5,-1"

			}
		}

        CanteenPurchase 
        {
            NoFixup 1

            logic_relay 
            {
                "targetname" "canteen_count_update"
                "spawnflags" "2"

                "$OnUser5" "@c@!activator,$SetProp$m_usNumCharges,,0,-1"
                "$OnUser5" "!activator,$SetVar$currentCustomCanteenCharges,,0,-1"

                "$OnUser5" "!activator,$GetProp$m_iClass,!activator|$SetVar$lastUpdatedClass|69,0,-1"
            }

            logic_relay 
            {
                "targetname" "on_canteen_empty"
                "spawnflags" "2"

                "OnTrigger" "!activator,$RemoveItemAttribute,refill_ammo|9,0,-1"
                "OnTrigger" "!activator,$RemoveItemAttribute,special item description|9,0,-1"
                "OnTrigger" "!activator,$SetVar$canteenIndex,-1,0,-1"
            }
        }
		FreelanceMercenary_Logic
        {
            OnSpawnOutput 
            {
                Target "freelance_action_check"
                Action "Trigger"
                Delay 0
            }

            OnSpawnOutput 
            {
                Target "!activator"
                Action "$GetVar$PreFreelanceSwitchHealth"
                Param "apply_last_health|$SetKey$CompareValue|-1"
                Delay 0
            }

            OnSpawnOutput 
            {
                Target "apply_last_health"
                Action "Compare"
                Delay 0.06
            }

            //apply health from previous class if switched
            logic_compare
            {
                "targetname" "apply_last_health"

                "InitialValue" "-1"

                "OnNotEqualTo" "!activator,$SetKey$health,$$=!activator.PreFreelanceSwitchHealth,-1,-1"
                "OnNotEqualTo" "!activator,$SetVar$PreFreelanceSwitchHealth,,0,-1"
            }

            $filter_sendprop
			{
				"targetname" "using_action"
				"$name" "m_bUsingActionSlot"
				"$value" "0"
				"$compare" "equal"
				"Negated" "1"

                "OnPass" "!activator,$SetVar$PreFreelanceSwitchHealth,$$= !activator.m_iHealth ,-1,-1"
                "OnPass" "!activator,$SwitchClassInPlace,$$= test ( !activator.m_iClass + 1 <= 9 , !activator.m_iClass + 1, 1 ) ,0,-1"
			}

            logic_relay
            {
                "targetname" "freelance_action_check"
                "spawnflags" "2"

                "OnTrigger" "using_action,TestActivator,,0,-1"
                "OnTrigger" "!self,Trigger,,0.1,-1"
            }
        }
        Natascha_Spawn
        {
            OnSpawnOutput 
            {
                Target "filter_rage_activated"
                Action "FireUser1"
                Delay 0
            }

            OnParentKilledOutput 
            {
                Target "!activator"
                Action "$ResetClientProp$m_bRageDraining"
                Delay 0.1
            }

            OnParentKilledOutput 
            {
                Target "!activator"
                Action "$ResetClientProp$m_flRageMeter"
                Delay 0.1
            }

            //check when rage was activated by player
            $filter_sendprop
            {
                "targetname" "filter_rage_activated"
                "$name" "m_bRageDraining"
                "$value" "1"
                "$compare" "equal"
                "Negated" "0"

				"OnPass" "rage_activated,Trigger,,0,-1"
				//"OnPass" "player,$DisplayTextChat,activated,0,-1"

                "OnUser1" "!self,TestActivator,,0,-1"
                "OnUser1" "!self,FireUser1,,0.1,-1"
            }

            logic_relay 
            {
                "targetname" "rage_activated"
                "spawnflags" "2"

                "OnTrigger" "!activator,$SetClientProp$m_bRageDraining,1,0,-1"
                "OnTrigger" "!activator,$SetProp$m_bRageDraining,0,0,-1"

                "OnTrigger" "!activator,$AddCond,11,0,-1"

                "OnTrigger" "rage_meter,SetValueNoFire,$$=!activator.m_flRageMeter,0,-1"
                "OnTrigger" "rage_meter_drain,FireUser1,,0.01,-1"
            }

            logic_relay 
            {
                "targetname" "rage_meter_drain"
                "spawnflags" "2"

                "OnUser1" "rage_meter,FireUser1,,0,-1"
                "OnUser1" "!self,FireUser1,,0.1,-1" //interval
            }

            math_counter
			{
				"targetname" "rage_meter"
				"startvalue" "0"
				"min" "0"
				"max" "100" 

				"OnHitMin" "rage_meter_drain,$CancelPending,,0,0"

                "OnHitMin" "!activator,$RemoveCond,11,0,-1"
				"OnHitMin" "!activator,$SetClientProp$m_bRageDraining,0,0,-1"
				"OnHitMin" "!activator,$ResetClientProp$m_flRageMeter,,0.03,-1"
				"OnHitMin" "!activator,$SetProp$m_flRageMeter,0,0,-1"

				//"OnHitMin" "player,$DisplayTextChat,rage meter ended,0,-1"

				"OnGetValue" "rage_meter,$SetVar$tempRageHolder,,0,-1"
				"OnGetValue" "!activator,$SetClientProp$m_flRageMeter,$$=rage_meter.tempRageHolder,0.01,-1"

				"OnUser1" "!self,Subtract,1,0,-1" //drain per interval
				"OnUser1" "!self,GetValue,,0.01,-1"
			}
        }

        Building_Level2_Spawn
        {
            OnSpawnOutput
            {
                Target constructed_check_loop
                Action Trigger 
                Delay 0.1
            }

            $filter_sendprop
            {
                "targetname" "filter_constructed"
                "$name" "m_flPercentageConstructed"
                "$value" "1"
                "$compare" "greater than or equal"
                "Negated" "0"

                "OnPass" "apply_level2,Trigger,,0,-1"
            }

            //if building was built in setup or player used building canteen, cancel
            $filter_sendprop
            {
                "targetname" "filter_is_already_constructed"
                "$name" "m_iHighestUpgradeLevel"
                "$value" "2"
                "$compare" "greater than or equal"
                "Negated" "0"

                "OnPass" "constructed_check_loop,Disable,,0,-1"
            }

            logic_relay 
            {
                "targetname" "constructed_check_loop"
                "spawnflags" "2"

                "OnTrigger" "filter_constructed,TestActivator,,0,-1"
                "OnTrigger" "filter_is_already_constructed,TestActivator,,0,-1"

                "OnTrigger" "!self,Trigger,,0.1,-1"
            }

            logic_relay 
            {
                "targetname" "apply_level2"
                "spawnflags" "2"

                "OnTrigger" "!activator,$SetProp$m_iHighestUpgradeLevel,2,0,-1"

                "OnTrigger" "constructed_check_loop,Disable,,0,-1"
            }
        }
		Thunderdome_Spawn
        {
            OnSpawnOutput
            {
                Target "!activator"
                Action "$AddItemAttribute"
                Param "CARD: damage bonus|1.25|1"
                Delay 0
            }

            OnSpawnOutput
            {
                Target "!activator"
                Action "$AddItemAttribute"
                Param "CARD: damage bonus|1.25|2"
                Delay 0
            }

            OnParentKilledOutput
            {
                Target "!activator"
                Action "$RemoveItemAttribute"
                Param "CARD: damage bonus|1"
                Delay 0
            }

            OnParentKilledOutput
            {
                Target "!activator"
                Action "$RemoveItemAttribute"
                Param "CARD: damage bonus|2"
                Delay 0
            }

            // OnSpawnOutput
            // {
            //     Target "@e@m_hMyWeapons@!activator"
            //     Action "$SetProp$m_iClip1"
            //     Param "0"
            //     Delay 0
            // }

            //very weird hack to prevent switching to weapon
            // OnSpawnOutput
            // {
            //     Target "@e@m_hMyWeapons@!activator"
            //     Action "$SetProp$m_bFlipViewModel"
            //     Param "0"
            //     Delay 0.01
            // }

            OnSpawnOutput
            {
                Target "!activator"
                Action "$WeaponSwitchSlot"
                Param "1"
                Delay 0
            }

            OnSpawnOutput
            {
                Target "shield_hitbox"
                Action "$SetOwner"
                Param "!activator"
            }

            OnSpawnOutput
            {
                Target "shield_hitbox2"
                Action "$SetOwner"
                Param "!activator"
            }

            OnSpawnOutput
            {
                Target "projectile_shield"
                Action "$SetModel"
                Param "models/props_mvm/mvm_comically_small_player_shield.mdl"
            }

            OnSpawnOutput
            {
                Target "rotate"
                Action "Start"
            }

            OnSpawnOutput
            {
                Target "rotate2"
                Action "Start"
            }

            OnSpawnOutput
            {
                Target "rotate"
                Action "SetParent"
                Param ""
            }

            OnSpawnOutput
            {
                Target "rotate2"
                Action "SetParent"
                Param ""
            }

            OnSpawnOutput
            {
                Target "rotate_position"
                Action "Trigger"
            }

            filter_activator_tfteam 
			{
				"targetname" "filter_is_blue"
				"Negated" "0"
				"TeamNum" "3"
			}

            logic_relay
            {
                "targetname" "rotate_position"
                "spawnflags" "2"

                "OnTrigger" "rotate,$TeleportToEntity,!activator,0,-1"
                "OnTrigger" "rotate2,$TeleportToEntity,!activator,0,-1"

                "OnTrigger" "!self,Trigger,,0.01,-1"
            }

            trigger_hurt
            {
                "parentname" "rotate"
                "origin" "100 0 1"
                "mins" "-12 -53 -51.5"
                "maxs" "12 53 51.5"

                "targetname" "shield_hitbox"
                "spawnflags" "1"


                "filtername" "filter_is_red"

                "Damage" "60" //damage is half of this
                "damagetype" "512"
            }

			entity_medigun_shield
			{
                "parentname" "rotate"
                "targetname" "projectile_shield"
				"origin" "100 0 0"
				"spawnflags" "1"
				"teamnum" "3"
                "skin" "1"
			}

            func_rotating
            {
                "targetname" "rotate"
                "origin" "0 0 0"

                "mins" "-0.1 -0.1 -0.1"
                "maxs" "0.1 0.1 0.1"

                "dmg" "0"
                "fanfriction" "100" 
                "maxspeed" "60"
                "spawnflags" "64"
                "volume" "0"
            }

            //2nd shield
            trigger_hurt
            {
                "parentname" "rotate2"
                "mins" "-12 -53 -51.5"
                "maxs" "12 53 51.5"
                "origin" "-100 0 1"
                // "angles" "180 0 0"

                "targetname" "shield_hitbox2"
                "spawnflags" "1"

                "filtername" "filter_is_red"

                "Damage" "60" //damage is half of this
                "damagetype" "512"
            }

			entity_medigun_shield
			{
                "parentname" "rotate2"
                "targetname" "projectile_shield"
				"origin" "-100 0 0"
                "angles" "-180 0 -180"
				"spawnflags" "1"
				"teamnum" "3"
                "skin" "1"
			}

            func_rotating
            {
                "targetname" "rotate2"
                "origin" "0 0 0"

                "mins" "-0.1 -0.1 -0.1"
                "maxs" "0.1 0.1 0.1"

                "dmg" "0"
                "fanfriction" "100" 
                "maxspeed" "60"
                "spawnflags" "64"
                "volume" "0"
            }
        }
        BabyFace_Spawn 
        {
            OnSpawnOutput
			{
				Target "bbfb_relay"
				Action "Trigger"
			}

			logic_relay 
			{
				"targetname" "bbfb_relay"
				"spawnflags" "2"

				
				"OnTrigger" "filter_has_maxcharge,TestActivator,,0,-1"
				"OnTrigger" "!self,Trigger,,0.2,-1"
			}

            $filter_sendprop
            {
                "targetname" "filter_has_maxcharge"
                "$name" "m_flHypeMeter"
                "$value" "99"
                "$compare" "greater than or equal"
                "Negated" "0"

				"OnPass" "!activator,$AddItemAttribute,add cond when active|46|0,0,-1"
				"OnPass" "!activator,$AddItemAttribute,reload time increased hidden|0.7|0,0,-1"
				"OnPass" "!activator,$AddItemAttribute,fire rate bonus HIDDEN|0.8|0,0,-1"

				"OnFail" "!activator,$RemoveItemAttribute,add cond when active|0,0,-1"
                "OnFail" "!activator,$RemoveItemAttribute,reload time increased hidden|0,0,-1"
				"OnFail" "!activator,$RemoveItemAttribute,fire rate bonus HIDDEN|0,0,-1"
            }
        }

        DirectHit_Spawn 
        {
            //ensure rocket is at 1 on spawn
            OnSpawnOutput 
            {
                Target "!activator"
                Action "$Regenerate"
                Delay 0
            }
        }

        DirectHit_Rework_Global 
        {
            NoFixup 1

            //apply cooldown period where you can't reload rocket on hit very briefly
            //to avoid reloading multiple times in 1 tick through splash damage
            $filter_variable
            {
                "targetname" "_direct_hit_not_on_cooldown"
                "$name" "NoDirectHitReload"
                "$value" "1"
                "$compare" "equal"

                "Negated" "1"

                "OnPass" "@e@m_hMyWeapons@!activator,$SetProp$m_iClip1,$$=@e@m_hMyWeapons@!activator.m_iClip1 + 1,0,-1"
                "OnPass" "!activator,$SetVar$NoDirectHitReload,1,-1,-1"
                "OnPass" "!activator,$SetVar$NoDirectHitReload,,0,-1"
            }

            logic_relay 
            {
                "targetname" "direct_hit_on_hit"
                "spawnflags" "2"

                "OnTrigger" "_direct_hit_not_on_cooldown,TestActivator,,0,-1"//"@e@m_hMyWeapons@!activator,$SetProp$m_iClip1,$$=@e@m_hMyWeapons@!activator.m_iClip1 + 1,0,-1"
            }
        }

        Vitasaw_Rework_Spawn 
        {
			OnSpawnOutput
			{
				Target "vita_relay"
				Action "Trigger"
			}

			logic_relay 
			{
				"targetname" "vita_relay"
				"spawnflags" "2"

				
				"OnTrigger" "filter_has_enough_organs,TestActivator,,0,-1"
				"OnTrigger" "!self,Trigger,,0.2,-1"
			}

            $filter_sendprop
            {
                "targetname" "filter_has_enough_organs"
                "$name" "m_iDecapitations"
                "$value" "3"
                "$compare" "greater than or equal"
                "Negated" "0"

				"OnPass" "!activator,$AddItemAttribute,allow friendly fire|1|2,0,-1"

				"OnFail" "!activator,$RemoveItemAttribute,allow friendly fire|2,0,-1"
            }
        }

        Vitsaw_Rework_Global 
        {
            NoFixup 1

            logic_relay 
            {
                "targetname" "_vita_duration"
                "spawnflags" "2"

                "OnTrigger" "!activator,$RemoveCond,16,5,-1"
                "OnTrigger" "!activator,$RemoveCond,29,5,-1"
                "OnTrigger" "!activator,$RemoveCond,26,5,-1"
            }

            filter_activator_tfteam
            {
                "targetname" "vitasaw_team_check"

                "TeamNum" "2"//red

                "OnPass" "vitasaw_caller,$SetProp$m_iDecapitations,$$=vitasaw_caller.m_iDecapitations - 3,0.01,-1"
                "OnPass" "vitasaw_caller,AddOutput,targetname  ,0.011,-1"

                "OnPass" "!activator,$AddCond,16,0,-1"
                "OnPass" "!activator,$AddCond,29,0,-1"
                "OnPass" "!activator,$AddCond,26,0,-1"

                "OnPass" "!activator,$CancelPending,,0,-1"
                "OnPass" "!activator,$RemoveOutput,OnUser4,0,-1"

                "OnPass" "!activator,AddOutput,OnUser4 !self:$RemoveCond:16:5:-1,0.01,-1" 
                "OnPass" "!activator,AddOutput,OnUser4 !self:$RemoveCond:29:5:-1,0.01,-1" 
                "OnPass" "!activator,AddOutput,OnUser4 !self:$RemoveCond:26:5:-1,0.01,-1" 
                "OnPass" "!activator,AddOutput,OnUser4 !self:$RemoveOutput:OnUser4:5.1:-1,0.01,-1" 

                "OnPass" "!activator,FireUser4,,0.02,-1" 
            }
        }
    }

    SpawnTemplate CanteenPurchase

	PlayerItemEquipSpawnTemplate 
	{
		Name CustomCanteens
        ItemName "Default Power Up Canteen (MvM)"
		Origin "0 0 0" 
	}
	PlayerItemEquipSpawnTemplate 
	{
		Name CustomCanteens
        ItemName "Power Up Canteen (MvM)"
		Origin "0 0 0" 
	}
	PlayerItemEquipSpawnTemplate 
	{
		Name CustomCanteens
        ItemName "Battery Canteens"
		Origin "0 0 0" 
	}

    PlayerSpawnOnceTemplate
	{
		Name CustomCanteensSetup
		Origin "0 0 0"
	}

	//todo: handle wave restore 

	ExtendedUpgrades
	{
		//canteens
		speed_can
		{
			Name "Speed Boost Canteen" 

			//random attribute, preferably one that doesn't do anything nor show up on the player, basically just meant to index
			Attribute "mvm completed challenges bitmask" 
			Cap 5
			Increment 1 
			Cost 25

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}
            
            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain a speed boost for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,1,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain a speed boost for 5 seconds|9,0"
                Output "!activator,$SetVar$canteenIndex,1,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore 
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain a speed boost for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,1,0"
            }
		}

        re_can
		{
			Name "Reprogram Canteen" 

			Attribute "limited quantity item" 
			Cap 10
			Increment 1 
			Cost 100

            Description "Reprogram non-giant enemies in a radius"

			UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Reprogram non-giant enemies in a radius|9,0"

                Output "!activator,$SetVar$canteenIndex,2,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Reprogram non-giant enemies in a radius|9,0"

                Output "!activator,$SetVar$canteenIndex,2,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore 
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Reprogram non-giant enemies in a radius|9,0"

                Output "!activator,$SetVar$canteenIndex,2,0"
            }
		}

        ber_can
		{
			Name "Berserk Canteen" 

			Attribute "throwable healing" 
			Cap 3
			Increment 1 
			Cost 25

            Description "Locked to melee for 5 seconds, greatly increased melee power"

			UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Lock to melee but increase melee power|9,0"

                Output "!activator,$SetVar$canteenIndex,3,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Lock to melee but increase melee power|9,0"

                Output "!activator,$SetVar$canteenIndex,3,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Lock to melee but increase melee power|9,0"

                Output "!activator,$SetVar$canteenIndex,3,0"
            }
		}

        add_can
		{
			Name "Adrenaline Canteen" 

			Attribute "throwable damage" 
			Cap 3
			Increment 1 
			Cost 75

            Description "Gain various buffs for 5 seconds, become weakened for a duration afterward"

			UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain various buffs for 5 seconds and become fatigue briefly after duration|9,0"

                Output "!activator,$SetVar$canteenIndex,4,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain various buffs for 5 seconds and become fatigue briefly after duration|9,0"

                Output "!activator,$SetVar$canteenIndex,4,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Gain various buffs for 5 seconds and become fatigue briefly after duration|9,0"

                Output "!activator,$SetVar$canteenIndex,4,0"
            }
		}

        cloak_can
		{
			Name "Stealth Canteen" 

			Attribute "throwable particle trail only" 
			Cap 3
			Increment 1 
			Cost 50

            Description "Cloak for up to 15 seconds, cloak is cancelled when attacking"

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade knock_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Cloak for up to 15 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,5,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Cloak for up to 15 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,5,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Cloak for up to 15 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,5,0"
            }
		}

        piss_can
		{
			Name "Pissplosion Canteen" 

			Attribute "decoded by itemdefindex" 
			Cap 3
			Increment 1 
			Cost 25

            Description "Apply Jarate to enemies within a large radius"

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade knock_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Apply Jarate to enemies within a large radius|9,0"

                Output "!activator,$SetVar$canteenIndex,6,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Apply Jarate to enemies within a large radius|9,0"

                Output "!activator,$SetVar$canteenIndex,6,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Apply Jarate to enemies within a large radius|9,0"

                Output "!activator,$SetVar$canteenIndex,6,0"
            }
		}

        knock_can
		{
			Name "Knockback Immunity Canteen" 

			Attribute "elevate quality" 
			Cap 3
			Increment 1 
			Cost 25

            Description "fuck the last subwave"

            UIGroup 2

            AllowedWeapons
            {
                Classname "tf_powerup_bottle"
            }

            DisallowedUpgrade {Upgrade re_can}
            DisallowedUpgrade {Upgrade speed_can}
            DisallowedUpgrade {Upgrade ber_can}
            DisallowedUpgrade {Upgrade add_can}
            DisallowedUpgrade {Upgrade cloak_can}
            DisallowedUpgrade {Upgrade piss_can}

            OnUpgrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Knockback resistance for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,69,0"
            }

            OnApply
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Knockback resistance for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,69,0"
            }

            OnDowngrade
            {
                Output "canteen_count_update,$FireUser5,"
                Output "on_canteen_empty,Trigger,,0"
            }

            OnRestore
            {
                Output "canteen_count_update,$FireUser5,"
                Output "!activator,$AddItemAttribute,special item description|Consumable: Knockback resistance for 5 seconds|9,0"

                Output "!activator,$SetVar$canteenIndex,69,0"
            }
		}
	}

	ExtraSpawnPoint  
	{
		Name "red"
		TeamNum 3
		X "2408.000000" 
		Y "-96.000000" 
		Z "267.031311"
	}

    SpawnTemplate DirectHit_Rework_Global
    SpawnTemplate Vitsaw_Rework_Global

    CustomWeapon 
	{
		"Thunderdome"
        {
            OriginalItemName "Upgradeable TF_WEAPON_MINIGUN" 

            "hidden primary max ammo bonus" 0.0001
            "cannot upgrade" 1
            "special item description" "Create 2 small projectile shields that orbit around you and damage enemies"
            "special item description 2" "Increased damage for secondary and melee"
            "special item description 3" "No primary weapon"
        }
		"Rider On The Storm"
		{
			OriginalItemName "Activated Campaign 3 Pass" 
            "increased air control" 3
			"dmg from ranged reduced" 0.9
            "damage force increase" 2
            "cancel falling damage" 1
            "custom item model" "models/player/items/all_class/spacechem_pin.mdl"
		}

        "Freelance Mercenary" 
		{
			OriginalItemName "Halloween Spellbook" 
            "special item description" "Hold the Action key to switch between classes on the fly"
		}
	}

    ExtraLoadoutItems 
	{
		Scout 
		{
			Action {Item "Rider On The Storm" Cost 10}
		}
		Heavyweapons
		{
			Primary {Item "Thunderdome"}
		}

		Spy 
		{
			Action {Item "Rider On The Storm" Cost 10}
		}

        Action {Item "Freelance Mercenary" Cost 300}
	}

    PlayerItemEquipSpawnTemplate 
	{
		Name FreelanceMercenary_Logic
		ItemName "Freelance Mercenary"
	}

    PlayerItemEquipSpawnTemplate 
	{
		Name BabyFace_Spawn
		ItemName "Baby Face's Blaster"
	}
	
	PlayerItemEquipSpawnTemplate 
	{
		Name Thunderdome_Spawn
		ItemName "Thunderdome"
	}
    ItemAttributes 
	{
		ItemName "Baby Face's Blaster"

        "special item description" "Initial Scout: Gain increase to reload and fire rate while at full boost"
	}
    
    PlayerItemEquipSpawnTemplate 
	{
		Name DirectHit_Spawn
		ItemName "The Direct Hit"
	}

    ItemAttributes 
	{
		ItemName "The Direct Hit"
		"fire input on hit" "direct_hit_on_hit^Trigger^"
        "clip size penalty" 0.25

        "special item description" "On Hit: Instantly reload one rocket"
	}

    PlayerItemEquipSpawnTemplate 
	{
		Name Natascha_Spawn
		ItemName "Natascha"
	}

    ItemAttributes 
	{
		ItemName "Natascha"
		"increase buff duration HIDDEN" 50
        //"generate rage on damage" 3

        "special item description" "Replaces 'Knockback Rage' with Power Rage. grant crit while active (PLACEHOLDER EFFECT)"
	}

    ItemAttributes 
	{
        ClassName TF_WEAPON_PDA_ENGINEER_BUILD
		"special item description" "Buildings start at level 2 after construction"
	}


    BuildingSpawnTemplate
	{
		Name Building_Level2_Spawn
		BuildingType "Sentry" 
	}

    BuildingSpawnTemplate
	{
		Name Building_Level2_Spawn
		BuildingType "Dispenser" 
	}
    BuildingSpawnTemplate
	{
		Name Building_Level2_Spawn
		BuildingType "Teleporter Entry" 
	}
    BuildingSpawnTemplate
	{
		Name Building_Level2_Spawn
		BuildingType "Teleporter Exit" 
	}

    PlayerItemEquipSpawnTemplate 
	{
		Name Vitasaw_Rework_Spawn
		ItemName "The Vita-Saw"
	}

    ItemAttributes 
	{
		ItemName "The Vita-Saw"

        "fire input on hit" "popscript^$vitasawOnHit^vitasaw_team_check"
		
        "damage penalty" 0.09
        "max health additive penalty" 0

		"special item description" "On Hit Teammate: Exchange 3 organs to give target every banner effects for 5 seconds"
	}

	SpawnTemplate "general_logic"
	Wave // Wave #1
    {
        SpawnTemplate "wave1_logic"
		InitWaveOutput
		{
			Target wave1_init_relay
			Action Trigger
		}
        StartWaveOutput
        {
            Target wave_start_relay
            Action Trigger
        }
        DoneOutput
        {
            Target wave_finished_relay
            Action Trigger
        }
        WaveSpawn
        {
            Name "Bomb Fella"
            Where spawnbot
            TotalCount 1
            MaxActive 1
            SpawnCount 1
            WaitBeforeStarting 0.1
            WaitBetweenSpawns 0
            DoneOutput
            {
                Target wave1_loss_relay
                Action Trigger
            }
			RandomChoice{RandomChoice{
            TFBot
            {

				Template T_TFBot_Giant_Soldier_Extended_Battalion_Fake
			    Name "Bomb Fella"
                Tag bomb_fella
                EventChangeAttributes
			    {
			    	Default
			    	{
			    		InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-7035 1375 196"
			    			Delay 1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_1" //Entity name to use
				        	Action "Enable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        Message 
                        {
                            Name "{blue}Warning: Threat detected! Cannot proceed until threat levels decrease." 
                            Delay 10
                            Repeats 1
                        }
			    	}
                    SubwaveOne_Complete
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_1" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
			    		InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "trigger_that_does_nothing2"
                            //Target "-5485.430176 1419.615723 467.03131"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}Threat sufficiently neutralized. Proceeding..." 
                            Delay 0
                            Repeats 1
                        }
			    	}
			    	GateOne_Capped
			    	{
                        InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			//Target "trigger_that_does_nothing2"
                            Target "-5485.430176 1419.615723 467.03131"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}Bomb Fella {FFFFFF}has used their {9BBF4D}SELF HEAL {FFFFFF}Power Up Canteen!" 
                            Delay 0
                            Repeats 1
                        }
                        AddCond [$SIGSEGV] //Adds conditions to bots
				        {
				        	Name "TF_COND_MVM_BOT_STUN_RADIOWAVE"
				        	Delay 0.5
				        	Duration 21.5
                        }
                        FireInput [$SIGSEGV] 
				        {
				        	Target "canteen_relay" //Entity name to use
				        	Action "Trigger" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        ChangeAttributes [$SIGSEGV]  //Periodically changes bot attributes, defined in EventChangeAttributes
			            {
			            	Delay 22 //Time before the first bot attribute change (Default: 10)
			            	Cooldown 1 //Time between each bot attribute change (Default: 10)
			            	Repeats 1 //How many times should bot change attributes in total (Default: 0 - Infinite)
			            	Name "SubwaveTwo" // Name of the bot attributes listed in EventChangeAttributes
			            }
                        Message 
                        {
                            Name "{blue}Gate captured! Initializing reboot sequence..." 
                            Delay 0
                            Repeats 1
                        }
			    	}
			    	SubwaveTwo
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_2" //Entity name to use
				        	Action "Enable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-4465 -490 193"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}Warning: Threat detected! Cannot proceed until threat levels decrease." 
                            Delay 5
                            Repeats 1
                        }
			    	}
                    SubwaveTwo_Complete
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_2" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
			    		InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "trigger_that_does_nothing"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}Threat sufficiently neutralized. Proceeding..." 
                            Delay 0
                            Repeats 1
                        }
			    	}
                    GateTwo_Capped
                    {
                        Message 
                        {
                            Name "{blue}Bomb Fella {FFFFFF}has used their {9BBF4D}SELF HEAL {FFFFFF}Power Up Canteen!" 
                            Delay 0
                            Repeats 1
                        }
                        AddCond [$SIGSEGV] //Adds conditions to bots
				        {
				        	Name "TF_COND_MVM_BOT_STUN_RADIOWAVE"
				        	Delay 0.5
				        	Duration 21
                        }
                        FireInput [$SIGSEGV] 
				        {
				        	Target "canteen_relay" //Entity name to use
				        	Action "Trigger" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        ChangeAttributes [$SIGSEGV]  //Periodically changes bot attributes, defined in EventChangeAttributes
			            {
			            	Delay 22 //Time before the first bot attribute change (Default: 10)
			            	Cooldown 1 //Time between each bot attribute change (Default: 10)
			            	Repeats 1 //How many times should bot change attributes in total (Default: 0 - Infinite)
			            	Name "SubwaveThree" // Name of the bot attributes listed in EventChangeAttributes
			            }
                        Message 
                        {
                            Name "{blue}Gate captured! Initializing reboot sequence..." 
                            Delay 0
                            Repeats 1
                        }
                    }
                    SubwaveThree
                    {
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_3" //Entity name to use
				        	Action "Enable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-1233 549 68"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			    		}
                        Message 
                        {
                            Name "{blue}Warning: Threat detected! Cannot proceed until threat levels decrease." 
                            Delay 5
                            Repeats 1
                        }
                    }
                    SubwaveThree_Complete
			    	{
                        FireInput [$SIGSEGV] 
				        {
				        	Target "bombfella_hologram_3" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        FireInput [$SIGSEGV] 
				        {
				        	Target "wave1_loss_relay" //Entity name to use
				        	Action "Disable" //Input to fire
				        	Delay 0 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
                        Message 
                        {
                            Name "{blue}Threat sufficiently neutralized. Proceeding..." 
                            Delay 0
                            Repeats 1
                        }
						InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			    		{
			    			Target "-1128 1684 164"
			    			Delay 0.1 // Time before the first task starts (Default: 10)
			    			Repeats 1 // How many times should bot do the task in total (Default: 0 - Infinite)
			    			Cooldown 1 //Time between each task (Default: 10)
			    			Duration 0 // How long should the ai be interrupted
                            WaitUntilDone 1
							OnDoneChangeAttributes "Shapeshift"
			    		}
			    	}
					Shapeshift
					{
						FireInput [$SIGSEGV] 
				        {
				        	Target "disguise_stop" //Entity name to use
				        	Action "Trigger" //Input to fire
				        	Delay 2 //Delay before firing the input
				        	Cooldown 1 //Cooldown between firing the input
				        	Repeats 1 //How many times should the input be fired
				        }
					}
			    }
            }
			}}
        }
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_one"
			Where "spawnbot_factory_two"
            TotalCount 32
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 1.5
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Heavyweapons_Shotgun
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
							"voice pitch scale" 0
                        }
                        SpawnTemplate "points_common_one"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_one"
			Where "spawnbot_factory_two"
            TotalCount 36
			MaxActive 6
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Scout_Melee
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_one"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_one"
            TotalCount 2
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 5
			WaitBetweenSpawns 20
            TFBot
            {
                Template T_TFBot_Giant_Pyro_Flare_Spammer
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                SpawnTemplate "points_gdetonator"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwaveone"
			Where "spawnbot_factory_two"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 25
			WaitBetweenSpawns 20
			TFBot
			{
			    Template T_TFBot_Giant_Pyro_Flare_Spammer
			    Action Mobber  
			    BehaviorModifiers Mobber
			    Attributes IgnoreFlag
			    Attributes DisableDodge
			    UseMeleeThreatPrioritization 1  
			    AddCond { Name "TF_COND_REPROGRAMMED" }
			    CharacterAttributes
			    {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
			        "crit mod disabled" 0
					"force distribute currency on death" 1
			    }
			    SpawnTemplate "points_gdetonator"
			}
		}
        WaveSpawn 
        {
			Name "w1_gateone"
			Where "spawnbot_scaffold"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 1.5
            TFBot
            {
                Class Heavyweapons
			    Name "Giant Steel Gauntlet"
			    ClassIcon heavy_steelfist
			    Skill Expert
			    Health 5000
			    Item "Fists of Steel"
			    StripItemSlot 0
			    StripItemSlot 1
			    WeaponRestrictions MeleeOnly
			    Attributes MiniBoss
			    Attributes DisableDodge
			    ItemAttributes
			    {
			    	ItemName "Fists of Steel"
			    	"fire rate bonus" 0.6
			    	"damage bonus" 1.2
			    }
			    CharacterAttributes
			    {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
			    	"move speed bonus"	0.5
			    	"override footstep sound set" 2
					"voice pitch scale" 0
			    }
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
				{
					//Target "trigger_that_does_nothing2"
                            Target "-5485.430176 1419.615723 467.03131"
					Delay 1 // Time before the first task starts (Default: 10)
					Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
					Cooldown 5 //Time between each task (Default: 10)
					Duration 300 // How long should the ai be interrupted
                    WaitUntilDone 1
				}
                SpawnTemplate "points_gsteelfist"
            }
		}
        WaveSpawn 
        {
			Name "w1_gateone"
			Where "spawnbot_scaffold"
			Where "spawnbot_balcony"
            TotalCount 24
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 2
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Scout_Scattergun_SlowFire
                        Name "Scout"
                        Action Mobber
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_gateone"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gateone"
			Where "spawnbot_scaffold"
			Where "spawnbot_balcony"
            TotalCount 20
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 2
			WaitBetweenSpawns 2
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Class Soldier
                        Skill Hard
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_gateone"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavetwo"
			Where "spawnbot_balcony_drain_extra"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Template T_TFBot_Giant_Soldier_Spammer
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                SpawnTemplate "points_gsoldier"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavetwo"
			Where "spawnbot_balcony_extra"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Template T_TFBot_Giant_Soldier_Spammer
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                SpawnTemplate "points_gsoldier"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavetwo"
			Where "spawnbot_balcony_drain_extra"
			Where "spawnbot_balcony_extra"
            TotalCount 24
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 2
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Heavyweapons_Heavyweight_Champ_Fast
                        Action Mobber
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
							"voice pitch scale" 0
                        }
                        SpawnTemplate "points_common_two"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gatetwo"
			Where "spawnbot_balcony_drain"
            TotalCount 40
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 10
			WaitBetweenSpawns 2.5
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Class Demoman
                        Skill Expert
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                        SpawnTemplate "points_common_gatetwo"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gatetwo"
			Where "spawnbot_balcony_drain"
            TotalCount 10
			MaxActive 4
			SpawnCount 1
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 6
			WaitBetweenSpawns 8
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Heavyweapons_Fist
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
							"voice pitch scale" 0
                        }
                        SpawnTemplate "points_steelfist"
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_gatetwo"
			Where "spawnbot_balcony_drain"
            TotalCount 2
			MaxActive 2
			SpawnCount 2
			TotalCurrency 50
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            TFBot
            {
                Template T_TFBot_Giant_Pyro
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
                InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
				{
					Target "trigger_that_does_nothing"
					Delay 1 // Time before the first task starts (Default: 10)
					Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
					Cooldown 5 //Time between each task (Default: 10)
					Duration 300 // How long should the ai be interrupted
                    WaitUntilDone 1
				}
                SpawnTemplate "points_gpyro"
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavethree_support"
			Where "spawnbot_hatch"
            Where "spawnbot_garage"
            TotalCount 100
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 1
			WaitBetweenSpawns 4
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Soldier_RocketShotgun
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w1_subwavethree_support"
			Where "spawnbot_hatch"
            Where "spawnbot_garage"
            TotalCount 100
			MaxActive 8
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 5
			WaitBetweenSpawns 4
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Class Pyro
                        Skill Normal
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        WeaponRestrictions PrimaryOnly
                        UseMeleeThreatPrioritization 1  
                        ItemAttributes
                        {
                            ItemName "TF_WEAPON_FLAMETHROWER"
                            "airblast disabled" 1
                        }
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        
                        CharacterAttributes
                        {
							"damage force reduction" 0.1
							"airblast vulnerability multiplier" 0.1
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                    }
                }
            }
		}
        WaveSpawn
        {
			Name "w1_subwavethree"
			Where "spawnbot_hatch"
            TotalCount 2
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            TFBot
			{
				Template T_TFBot_Giant_Demo_Burst
                AddCond { Name "TF_COND_REPROGRAMMED" }
                
                CharacterAttributes
                {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
			}
		}
        WaveSpawn
        {
			Name "w1_subwavethree"
			Where "spawnbot_garage"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            TFBot
			{
				Template T_TFBot_Giant_Demo_Burst
                AddCond { Name "TF_COND_REPROGRAMMED" }
                
                CharacterAttributes
                {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
			}
		}
		WaveSpawn
		{
			WaitForAllDead "w1_subwavethree"
			DoneOutput
			{
				Target w1_subwavethree_complete_relay
				Action Trigger
			}
		}
        WaveSpawn
        {
			Name "w1_endboss"
			Where "spawnbot_extra"
            TotalCount 1
			MaxActive 1
			SpawnCount 1
			TotalCurrency 400
			WaitBeforeStarting 1
			WaitBetweenSpawns 1
            DoneOutput
            {
                Target wave1_endsequence_relay
                Action Trigger
            }
            TFBot
			{
				Template T_TFBot_Sergeant_Shapeshift
				CharacterAttributes
                {
					"force distribute currency on death" 1
                }
			}
		}
		WaveSpawn
		{
			Where spawnbot
			TotalCount 0
			WaitBeforeStarting 9999
            RandomChoice
            {
                RandomChoice
                {
			        TFBot { Class Scout ClassIcon hellmet_blank }
                }
            }
		}
    }
	PlayerSpawnTemplate "PlayerRes"
	PlayerSpawnTemplate "PlayerTracker"
	SpawnTemplate "PlayersLeftLogic"
    Wave //Wave #2
    {
    	SpawnTemplate "wave2_logic"
		SpawnTemplate "PlayerResInput"
		PlayerAttributes  
    	{
    	    "min respawn time" 9999
    	}
		InitWaveOutput
		{
			Target wave2_init_relay
			Action Trigger
		}
        StartWaveOutput
		{
			Target wave_start_boss_relay
			Action Trigger
		}
		DoneOutput
		{
			Target wave_finished_relay
			Action Trigger
		}
		WaveSpawn
		{
            FirstSpawnOutput
			{
                Target playerResInWave //REQUIRED | Used to tell self res logic that wave is active/ turn it off again at the end of a wave
                Action ToggleTest
            }
        }
        WaveSpawn
		{
            FirstSpawnOutput
			{
                Target playerResVal3 //set res count to one of 3 set
                Action GetValue
            }
        }
        WaveSpawn
		{
            FirstSpawnOutput
			{
                Target boss_resupply
                Action Disable
            }
        }
        WaveSpawn
		{                          
            Name "shapeshift"


			Where spawnbot_boss
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 800

			DoneOutput
			{
				Target "bots_win"
				Action "RoundWin"
			}

            TFBot
            {
                Template T_TFBot_Sergeant_Shapeshift_Supreme
            }
        }
		WaveSpawn
		{                          
			Where summon_chief
			TotalCount 4
			MaxActive 4
			SpawnCount 4
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support 1

			RandomChoice 
			{
				RandomChoice 
				{
					TFBot
					{
						SpawnTemplate "Necromancer_Summoned"
						Template T_TFBot_Scout_Shortstop
						Health 350
                		Action Mobber  
                		BehaviorModifiers Mobber
                		Attributes IgnoreFlag
                		Attributes DisableDodge
						CharacterAttributes
						{
							"cancel falling damage" 1
                    		"crit mod disabled" 0
						}
                		AddCond { Name "TF_COND_REPROGRAMMED" }
					}
				}
			}
        }
		WaveSpawn
		{                          
			Where summon_chief2
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support 1

			RandomChoice 
			{
				RandomChoice 
				{
					TFBot
					{
						SpawnTemplate "Necromancer_Summoned"
						Template T_TFBot_Giant_Pyro_Flare_Spammer
                		Action Mobber  
                		BehaviorModifiers Mobber
                		Attributes IgnoreFlag
                		Attributes DisableDodge
                		AddCond { Name "TF_COND_REPROGRAMMED" }
						CharacterAttributes
						{
							"damage force reduction" 0.1
							"airblast vulnerability multiplier" 0.1
							"cancel falling damage" 1
                    		"crit mod disabled" 0
						}
					}
				}
			}
        }
		WaveSpawn
		{                          
			Where summon_chief3
			TotalCount 3
			MaxActive 3
			SpawnCount 3
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support 1

			RandomChoice 
			{
				RandomChoice 
				{
					TFBot
					{
						SpawnTemplate "Necromancer_Summoned"
						Class Spy
						Name "Upgraded Munitions Spy"
						Skill Expert
						Health 650
						Scale 1.35
                		Action Mobber  
                		BehaviorModifiers Mobber
                		Attributes IgnoreFlag
                		Attributes DisableDodge
						AimTrackingInterval 0.05
						ItemAttributes
						{
							ItemName "TF_WEAPON_REVOLVER"
							"hand scale" 1.5
							"override projectile type" 2
							"fire rate penalty" 2
							"faster reload rate" 1.4
							"custom projectile model" "models/weapons/w_models/w_rocketbullet.mdl"
							"projectile trail particle" "rockettrail_airstrike_line"
							"no self blast dmg" 2
							"centerfire projectile" 1
							"projectile no deflect" 1
						}
						CharacterAttributes
						{
							"move speed bonus"	0.85
							"cannot disguise" 1
							"voice pitch scale" 0.8
							"damage force reduction" 0.4
							"airblast vulnerability multiplier"	0.75
                    		"crit mod disabled" 0
						}
                		AddCond { Name "TF_COND_REPROGRAMMED" }
					}
				}
			}
        }
		WaveSpawn 
        {
			Name "midphase1"
			Where "spawnbot_arena_1"
			Where "spawnbot_arena_2"
			Where "spawnbot_arena_3"
            TotalCount 2
			MaxActive 2
			SpawnCount 1
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Class Scout
				Name "Armored Scout"
				ClassIcon scout_stun_giant_armored
				Skill Expert
				Health 3000
				WeaponRestrictions PrimaryOnly
				Attributes MiniBoss
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                AddCond { Name "TF_COND_REPROGRAMMED" }
				CharacterAttributes
				{
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
					"override footstep sound set" 5
					"move speed penalty" 0.75
					"cancel falling damage" 1
                	"crit mod disabled" 0
				}
            }
		}
		WaveSpawn 
        {
			Name "midphase1"
			Where "spawnbot_arena_1"
			Where "spawnbot_arena_2"
			Where "spawnbot_arena_3"
            TotalCount 4
			MaxActive 4
			SpawnCount 1
            Support limited
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Template T_TFBot_Heavyweapons_Fist
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
					"voice pitch scale" 0
                }
            }
		}
		WaveSpawn 
        {
			Name "midphase1"
			Where "spawnbot_arena_1"
			Where "spawnbot_arena_2"
			Where "spawnbot_arena_3"
            TotalCount 10
			MaxActive 10
			SpawnCount 2
            Support limited
			TotalCurrency 100
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
            TFBot
            {
                Class Demoman
                Skill Expert
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                UseMeleeThreatPrioritization 1  
                AddCond { Name "TF_COND_REPROGRAMMED" }
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
            }
		}
		WaveSpawn
		{
			Name ""
			WaitForAllDead "midphase1"
			DoneOutput
			{
				Target "bip"
				Action Trigger
			}
		}
		WaveSpawn 
        {
			Name "midphase2"
			Where "spawnbot_arena_1"
			Where "spawnbot_arena_2"
			Where "spawnbot_arena_3"
			WaitForAllDead "midphase1"
            TotalCount 2
			MaxActive 2
			SpawnCount 1
			TotalCurrency 100
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
			Support Limited
			TFBot
			{
			    Template T_TFBot_Giant_Soldier_RocketShotgun
			    Action Mobber  
			    BehaviorModifiers Mobber
			    Attributes IgnoreFlag
			    Attributes DisableDodge
			    UseMeleeThreatPrioritization 1  
			    AddCond { Name "TF_COND_REPROGRAMMED" }
			    CharacterAttributes
			    {
					"damage force reduction" 0.1
					"airblast vulnerability multiplier" 0.1
			        "crit mod disabled" 0
					"force distribute currency on death" 1
			    }
			}
                
		}
		WaveSpawn 
        {
			Name "midphase2"
			Where "spawnbot_arena_1"
			Where "spawnbot_arena_2"
			Where "spawnbot_arena_3"
			WaitForAllDead "midphase1"
            TotalCount 4
			MaxActive 4
			SpawnCount 1
			TotalCurrency 50
			WaitBeforeStarting 0
			WaitBetweenSpawns 0
			Support Limited
			TFBot
			{
			    Template T_TFBot_Sniper_Huntsman_Spammer
			    Action Mobber  
			    BehaviorModifiers Mobber
			    Attributes IgnoreFlag
			    Attributes DisableDodge
			    UseMeleeThreatPrioritization 1  
			    AddCond { Name "TF_COND_REPROGRAMMED" }
			    CharacterAttributes
			    {
					"damage force reduction" 0.6
					"airblast vulnerability multiplier" 0.6
			        "crit mod disabled" 0
					"force distribute currency on death" 1
			    }
			}
		}
		WaveSpawn
		{
			Name "midphase2"
			Where "spawnbot_arena_1"
			Where "spawnbot_arena_2"
			Where "spawnbot_arena_3"
			WaitForAllDead "midphase1"
			TotalCount 8
			MaxActive 8
			SpawnCount 2
			WaitBeforeStarting 5
			WaitBetweenSpawns 0
		
			TotalCurrency 50
			Support Limited
		
			TFBot
            {
                Class Pyro
                Skill Normal
                Action Mobber  
                BehaviorModifiers Mobber
                Attributes IgnoreFlag
                Attributes DisableDodge
                WeaponRestrictions PrimaryOnly
                UseMeleeThreatPrioritization 1  
                ItemAttributes
                {
                    ItemName "TF_WEAPON_FLAMETHROWER"
                    "airblast disabled" 1
                }
                AddCond { Name "TF_COND_REPROGRAMMED" }
                
                CharacterAttributes
                {
                    "crit mod disabled" 0
					"force distribute currency on death" 1
                }
            }
		}
		WaveSpawn
		{
			Name ""
			WaitForAllDead "midphase2"
			DoneOutput
			{
				Target "bip"
				Action Trigger
			}
		}
		WaveSpawn
		{
			Where spawnbot
			TotalCount 1
			WaitBeforeStarting 9999
            RandomChoice
            {
                RandomChoice
                {
			        TFBot { Class Scout ClassIcon hellmet_blank }
                }
            }
		}
    }
    Mission
	{
		Objective Spy
		Where spawnbot_factory_one
        Where spawnbot_factory_two
        Where spawnbot_balcony
        Where spawnbot_balcony_extra
        Where spawnbot_balcony_drain
        Where spawnbot_balcony_drain_extra
        Where spawnbot_hatch
		BeginAtWave	3
		RunForThisManyWaves 1
		CooldownTime 60
		InitialCooldown 45
		DesiredCount 2
		
		TFBot
		{
			Class Spy
			Skill Expert
			AddCond {Name "TF_COND_REPROGRAMMED" }
		}
	}
	Wave // Wave #3
	{
        SpawnTemplate "wave3_logic"
		StartWaveOutput
		{
			Target wave_start_relay
			Action Trigger
		}
		DoneOutput
		{
			Target wave_finished_relay
			Action Trigger
		}
        InitWaveOutput
        {
            Target wave3_init_relay
            Action Trigger
        }
		WaveSpawn // Tank # HP
		{
			Name "generator_one"
			WaitForAllDead ""
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			Tank
			{
        		SpawnTemplate "generator_template"
				Name "generator_one"
				StartingPathTrackNode "generator_one_path_1"
				Health 5000
				Speed 0
				Skin 0
                Scale 0.4
				Model "models/empty.mdl"
        		PingSound "misc/null.wav"
        		EngineLoopSound "misc/null.wav"
        		Gravity 0
        		DisableSmokestack 1
        		DisableTracks 1
        		DisableChildModels 1
        		TeamNum 2
		
				OnKilledOutput 
				{
					Target generator_one_killed_relay
					Action Trigger
				}
			}
		}
		WaveSpawn // Tank # HP
		{
			Name "generator_twothree"
			WaitForAllDead "generator_one"
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			Tank
			{
        		SpawnTemplate "generator_template"
				Name "generator_two"
				StartingPathTrackNode "generator_two_path_1"
				Health 5000
				Speed 0
				Skin 0
                Scale 0.4
				Model "models/empty.mdl"
        		PingSound "misc/null.wav"
        		EngineLoopSound "misc/null.wav"
        		Gravity 0  
        		DisableSmokestack 1
        		DisableTracks 1  
        		DisableChildModels 1  
        		TeamNum 2
			}
		}
		WaveSpawn // Tank # HP
		{
			Name "generator_twothree"
			WaitForAllDead "generator_one"
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			Tank
			{
        		SpawnTemplate "generator_template"
				Name "generator_three"
				StartingPathTrackNode "generator_three_path_1"
				Health 5000
				Speed 0
				Skin 0
                Scale 0.4
				Model "models/empty.mdl"
        		PingSound "misc/null.wav"
        		EngineLoopSound "misc/null.wav"
        		Gravity 0  
        		DisableSmokestack 1
        		DisableTracks 1  
        		DisableChildModels 1  
        		TeamNum 2
			}
		}
		WaveSpawn // Dummy
		{
			WaitForAllDead "generator_twothree"
		
			DoneOutput
			{
				Target "generator_twothree_relay" 
				Action Trigger
			}
		}
		WaveSpawn // Tank # HP
		{
			Name "generator_fourfivesix"
			WaitForAllDead "generator_twothree"
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			Tank
			{
        		SpawnTemplate "generator_template"
				Name "generator_four"
				StartingPathTrackNode "generator_four_path_1"
				Health 5000
				Speed 0
				Skin 0
                Scale 0.4
				Model "models/empty.mdl"
        		PingSound "misc/null.wav"
        		EngineLoopSound "misc/null.wav"
        		Gravity 0  
        		DisableSmokestack 1
        		DisableTracks 1  
        		DisableChildModels 1  
        		TeamNum 2
			}
		}
		WaveSpawn // Tank # HP
		{
			Name "generator_fourfivesix"
			WaitForAllDead "generator_twothree"
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			Tank
			{
        		SpawnTemplate "generator_template"
				Name "generator_five"
				StartingPathTrackNode "generator_five_path_1"
				Health 5000
				Speed 0
				Skin 0
                Scale 0.4
				Model "models/empty.mdl"
        		PingSound "misc/null.wav"
        		EngineLoopSound "misc/null.wav"
        		Gravity 0  
        		DisableSmokestack 1
        		DisableTracks 1  
        		DisableChildModels 1  
        		TeamNum 2
			}
		}
		WaveSpawn // Tank # HP
		{
			Name "generator_fourfivesix"
			WaitForAllDead "generator_twothree"
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			Tank
			{
        		SpawnTemplate "generator_template"
				Name "generator_six"
				StartingPathTrackNode "generator_six_path_1"
				Health 5000
				Speed 0
				Skin 0
                Scale 0.4
				Model "models/empty.mdl"
        		PingSound "misc/null.wav"
        		EngineLoopSound "misc/null.wav"
        		Gravity 0  
        		DisableSmokestack 1
        		DisableTracks 1  
        		DisableChildModels 1  
        		TeamNum 2
			}
		}
		WaveSpawn // Dummy
		{
			WaitForAllDead "generator_fourfivesix"
		
			DoneOutput
			{
				Target "generator_fourfivesix_killed_relay" 
				Action Trigger
			}
		}
        WaveSpawn
        {
            Name ""
            Where spawnbot_barrier_1
            TotalCount 9999
            MaxActive 3
            SpawnCount 1
            WaitBeforeStarting 0
            WaitBetweenSpawns 5
            Support 1
        
            TFBot
            { 
                Template T_TFBot_Scout_Melee
                Action FetchFlag
                Attributes IgnoreFlag
                EventChangeAttributes
                {
                    Default
                    {

                    }
                    CaptureGateOne
                    {
                        InterruptAction [$SIGSEGV] // Stop current bot ai and force the bot to move to a location
			            {
			            	Target "trigger_that_does_nothing2"
                            //Target "-5485.430176 1419.615723 467.03131"
			            	Delay 0.1 // Time before the first task starts (Default: 10)
			            	Repeats 0 // How many times should bot do the task in total (Default: 0 - Infinite)
			            	Cooldown 1 //Time between each task (Default: 10)
			            	Duration 300 // How long should the ai be interrupted
                            WaitUntilDone 1
			            }
                    }
                }
            }
        }
        WaveSpawn 
        {
			Name "w3_subwaveone_support"
			Where "spawnbot_factory_one"
			Where "spawnbot_factory_two"
            TotalCount 24
			MaxActive 8
			SpawnCount 2
            Support limited
			TotalCurrency 75
			WaitBeforeStarting 0
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Soldier_Extended_Buff_Banner
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w3_subwaveone_support"
			Where "spawnbot_factory_one"
			Where "spawnbot_factory_two"
            TotalCount 9
			MaxActive 3
			SpawnCount 1
            Support limited
			TotalCurrency 75
			WaitBeforeStarting 10
			WaitBetweenSpawns 1
            RandomChoice
            {
                RandomChoice
                {
                    TFBot
                    {
                        Template T_TFBot_Soldier_Extended_Battalion
                        Action Mobber  
                        BehaviorModifiers Mobber
                        Attributes IgnoreFlag
                        Attributes DisableDodge
                        UseMeleeThreatPrioritization 1  
                        AddCond { Name "TF_COND_REPROGRAMMED" }
                        CharacterAttributes
                        {
                            "crit mod disabled" 0
							"force distribute currency on death" 1
                        }
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w3_subwaveone"
			Where "spawnbot_factory_one"
            TotalCount 3
			MaxActive 3
			SpawnCount 3
			TotalCurrency 150
			WaitBeforeStarting 0
			WaitBetweenSpawns 20
            Squad
            {
                TFBot
                {
			        Class Demoman
			    	ClassIcon demoknight_giant
			    	Name "Giant Demoknight"
			    	Skill Expert
			    	Health 3300
			    	Item "Prince Tavish's Crown"
			    	Item "The Eyelander"
			    	Item "Ali Baba's Wee Booties"
			    	WeaponRestrictions MeleeOnly
			    	Attributes MiniBoss
                    Action Mobber
                    BehaviorModifiers Mobber
                    Attributes IgnoreFlag
                    Attributes DisableDodge
                    UseMeleeThreatPrioritization 1  
                    AddCond { Name "TF_COND_REPROGRAMMED" }
			    	ItemAttributes
			    	{
			    		ItemName "The Eyelander"
			    		"critboost on kill" 3
			    	}
                    CharacterAttributes
                    {
                        "crit mod disabled" 0
			    		"force distribute currency on death" 1
			    		"move speed bonus" 0.1
			    		"damage force reduction" 0.1
			    		"airblast vulnerability multiplier" 0.5
			    		"override footstep sound set" 4
                    }
                }
                TFBot
                {
                    Template T_TFBot_Medic_QuickFix
                    Attributes IgnoreFlag
                    Attributes DisableDodge
                    AddCond { Name "TF_COND_REPROGRAMMED" }
                    CharacterAttributes
                    {
                        "crit mod disabled" 0
			    		"force distribute currency on death" 1
                    }
                }
                TFBot
                {
                    Template T_TFBot_Medic_QuickFix
                    Attributes IgnoreFlag
                    Attributes DisableDodge
                    AddCond { Name "TF_COND_REPROGRAMMED" }
                    CharacterAttributes
                    {
                        "crit mod disabled" 0
			    		"force distribute currency on death" 1
                    }
                }
            }
		}
        WaveSpawn 
        {
			Name "w3_subwaveone"
			Where "spawnbot_factory_two"
            TotalCount 3
			MaxActive 3
			SpawnCount 3
			TotalCurrency 75
			WaitBeforeStarting 5
			WaitBetweenSpawns 20
			Squad
            {
                TFBot
                {
			        Class Demoman
			    	ClassIcon demoknight_giant
			    	Name "Giant Demoknight"
			    	Skill Expert
			    	Health 3300
			    	Item "Prince Tavish's Crown"
			    	Item "The Eyelander"
			    	Item "Ali Baba's Wee Booties"
			    	WeaponRestrictions MeleeOnly
			    	Attributes MiniBoss
                    Action Mobber
                    BehaviorModifiers Mobber
                    Attributes IgnoreFlag
                    Attributes DisableDodge
                    UseMeleeThreatPrioritization 1  
                    AddCond { Name "TF_COND_REPROGRAMMED" }
			    	ItemAttributes
			    	{
			    		ItemName "The Eyelander"
			    		"critboost on kill" 3
			    	}
                    CharacterAttributes
                    {
                        "crit mod disabled" 0
			    		"force distribute currency on death" 1
			    		"move speed bonus" 0.1
			    		"damage force reduction" 0.1
			    		"airblast vulnerability multiplier" 0.5
			    		"override footstep sound set" 4
                    }
                }
                TFBot
                {
                    Template T_TFBot_Medic_QuickFix
                    Attributes IgnoreFlag
                    Attributes DisableDodge
                    AddCond { Name "TF_COND_REPROGRAMMED" }
                    CharacterAttributes
                    {
                        "crit mod disabled" 0
			    		"force distribute currency on death" 1
                    }
                }
                TFBot
                {
                    Template T_TFBot_Medic_QuickFix
                    Attributes IgnoreFlag
                    Attributes DisableDodge
                    AddCond { Name "TF_COND_REPROGRAMMED" }
                    CharacterAttributes
                    {
                        "crit mod disabled" 0
			    		"force distribute currency on death" 1
                    }
                }
            }
		}
        WaveSpawn // Dummy
        {
            WaitForAllDead "w3_subwaveone"
        
            DoneOutput
            {
                Target w3_subwaveone_complete_relay
                Action Trigger
            }
        }
        WaveSpawn 
		{
			Where spawnbot_heli
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0
            WaitForAllDead "w3_subwaveone"

			Tank
			{
				SpawnTemplate "Helicopter_Tank_Init"

				Health 25000
				Speed 0 
				Scale 1.1
				DisableSmokestack 1  
				MaxTurnRate 0
				Model "models/empty.mdl" 
				ReplaceModelCollisions 1
				StartSound "misc/null.wav"
				PingSound "misc/null.wav"
				EngineLoopSound "misc/null.wav"
				Gravity 0  
				TeamNum 2
				DisableTracks 1  
				DisableChildModels 1  
				Name "tankboss"
				//StartingPathTrackNode "Helicopter_1"

				OnKilledOutput
				{
					Target boss_dead_relay
					Action Trigger
				}

				OnBombDroppedOutput
				{
					Target boss_deploy_relay
					Action Trigger
				}
			}
		}

		WaveSpawn
		{                                
			Where spawnbot_heli
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support Limited
            WaitForAllDead "w3_subwaveone"

			RandomChoice
			{
				RandomChoice
				{
					TFBot 
					{
						SpawnTemplate "Helicopter_Base_Init"
						Template T_TFBot_Helicopter_Base 
						AddCond { Name "TF_COND_REPROGRAMMED" }
						
						InterruptAction
						{
							Target "-4080.4 -666.5 424.4"
							Delay 0.1
							Repeats 1
						}
						
					}
				}
			}
		}

		WaveSpawn
		{                                
			Where spawnbot_heli
			TotalCount 1
			MaxActive 1
			SpawnCount 1
			WaitBetweenSpawns 0
			WaitBeforeStarting 0
			TotalCurrency 0

			Support Limited
            WaitForAllDead "w3_subwaveone"

			RandomChoice
			{
				RandomChoice
				{
					TFBot 
					{
						SpawnTemplate "Helicopter_Shooter_Init" 
						Template T_TFBot_Helicopter_Shoot
						AddCond { Name "TF_COND_REPROGRAMMED" }
					}
				}
			}
		}
	}
}
